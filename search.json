[{"title":"2016ã€æ‰è§‰è¿œå»ï¼Œä¾¿èµ·æ€€å¿µ","url":"https://yangzhiw.github.io/2016/12/31/2016è¿™ä¸€å¹´çš„å›é¡¾/","content":"<p>   ä¸€å¹´çš„å¼€å§‹ï¼Œæ€»æ˜¯ä¼´ç€å–œåº†çš„è‰²å½©ã€‚1æœˆä»½ï¼Œå¾€å¾€å¾ˆå¤šå…¬å¸éƒ½è¦å¼€å§‹å‡†å¤‡å¹´ä¼šäº†ã€‚ä½œä¸ºå…¬å¸æœ€å¹´è½»çš„<br> å›¢é˜Ÿï¼Œä¹Ÿå¿˜è®°äº†æ˜¯å“ªä¸ªå®¶ä¼™æƒ³çš„ï¼Œè®©æˆ‘ä»¬å¹´ä¼šä¸Šå”±bigbangçš„loserğŸ˜­ã€‚æˆ‘å’Œå¦å¤–4ä¸ªå°ä¼™ä¼´ä¸å¹¸å°±è¢«é€‰ä¸Šäº†ï¼Œæ‹¼äº†ï¼Œå°±ç®—æ˜¯ä¸ºäº†æˆ‘ä»¬è¿™ä¸ªå›¢é˜Ÿï¼Œä¾ç¨€çš„è®°å¾—çš„é‚£ä¸€æ™šï¼Œæˆ‘ä»¬ç©çš„å¾ˆå—¨ã€‚è™½ç„¶è¿˜æ˜¯åœ¨å®ä¹ é˜¶æ®µï¼Œå¯æ˜¯æˆ‘å·²è§‰å¾—æˆ‘æ—©å·²èå…¥è¿›è¿™ä¸ªå›¢é˜Ÿäº†ï¼Œå’Œä»–ä»¬æˆä¸ºäº†å¥½æœ‹å‹ã€‚ä»å¤§ä¸‰æš‘æœŸå®ä¹ å¼€å§‹ï¼Œæˆ‘å°±å·²ç»çŸ¥é“æˆ‘æ²¡æœ‰å¯’å‡å’Œæš‘å‡äº†ï¼Œè¿™ä¸€å¹´çš„æ˜¥èŠ‚ï¼Œè™½ç„¶åœ¨å®¶é‡Œå‘†çš„æ—¶é—´ä¹Ÿä¸é•¿ã€‚å¯¹æˆ‘æ¥è¯´æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºæˆ‘è‡ªå·±å¯ä»¥èµšé’±äº†ï¼Œæ‹¿ç€è¿™äº›é’±ç»™çˆ¶æ¯ä¹°äº†äº›ä¸œè¥¿ï¼Œå¯ä»¥å¤–å©†åŒ…çº¢åŒ…äº†å°±åƒå½“åˆå¥¹ç»™æˆ‘ä»¬ä¸€æ ·ã€‚</p>\n<p>   åŒ†åŒ†èŒ«èŒ«çš„å›åˆ°äº†å…¬å¸ï¼Œé‡æ–°å¼€å§‹äº†å·¥ä½œã€‚å…ƒå®µèŠ‚ï¼Œå’Œå‡ ä¸ªå¤§å­¦ä¸€èµ·è¿‡çš„ï¼Œåœ¨ä¸€ä¸ªåŸå¸‚ï¼Œæœ‰äº›åŒå­¦è¿˜<br>æ˜¯ä¸é”™çš„ï¼Œè‡³å°‘å¹³æ—¶æˆ‘ä»¬å¯ä»¥ç›¸äº’å‘å‘ç‰¢éªšã€‚æ„Ÿè§‰åˆ°äº†3æœˆä»½ï¼Œå·¥ä½œæ‰æ…¢æ…¢è¿›å…¥æ­£è½¨ï¼Œè¿™ä¸ªæ—¶å€™çš„æˆ‘ä¹Ÿå¼€å§‹æ€è€ƒäº†æ¯•ä¸šä¹‹åçš„å»å‘äº†ï¼Œæ€è€ƒç€æ˜¯ç»§ç»­ç•™åœ¨å®ä¹ çš„å…¬å¸è¿˜æ˜¯å»é‡æ–°æ‰¾ä¸€å®¶ï¼Œæœ€ç»ˆè€ƒè™‘çš„ç»“æœæ˜¯ç•™åœ¨è¿™ä¸ªå…¬å¸ï¼Œå› ä¸ºè¿™é‡Œæœ‰å¾ˆå¤šæˆ‘ç†Ÿæ‚‰çš„äººå’Œäº‹ã€‚3æœˆæœ«ï¼Œäº†è§£åˆ°å›¢é˜Ÿä¸­æœ‰äº›å®ä¹ ç”Ÿè¦èµ°äº†ï¼Œæœ‰è¦å»è¯»ç ”æ·±é€ çš„ï¼Œæœ‰<br>è¦æ¢å…¬å¸çš„ï¼Œåœ¨é€åˆ«èšé¤çš„é‚£ä¸€æ™šï¼Œæˆ‘ä»¬å¾ˆå¤šéƒ½å–å¤šäº†ã€‚æˆ–è®¸æˆ‘ä»¬éƒ½çŸ¥é“æœ‰ç›¸èšå°±æœ‰ç¦»å¼€ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è¿™æ‰æ˜¯åˆšåˆšå¼€å§‹è€Œå·²ã€‚</p>\n<p>   æ­å·çš„4æœˆå¤©æ˜¯å¾ˆèˆ’æœçš„ï¼Œå¬è¯´ä¸€ä¸ªé«˜ä¸­çš„åŒæ¡ŒåŒå­¦æ¥åˆ°äº†æµ™å¤§è¯»ç ”ï¼Œæˆ‘å½“åˆæ€ä¹ˆæ²¡çœ‹å‡ºæ¥ä½ è¿˜æœ‰è¿™ä¸ª<br>æ½œåŠ›ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨æ­å·è¥¿æ¹–æ—è¾¹çš„å±±ä¸Šè¸é’ï¼Œè®°å¾—å¥¹è¯´è¿‡ï¼Œè¿˜æ˜¯è€åŒå­¦åœ¨ä¸€èµ·å®åœ¨å•Šã€‚æ˜¯å•Šï¼Œé«˜ä¸­æ—¶çš„é‚£äº›åŒå­¦ä»¬ï¼Œæˆ‘è¿˜è®°çš„å’Œä½ ä»¬ä¸€èµ·å¥‹æ–—å’Œç©è€çš„æ—¶å…‰ã€‚äº”æœˆåˆï¼Œæˆ‘ä»¬å›¢é˜Ÿè‡ªé©¾æ¸¸å»äº†å®‰å‰çš„å¤©è’åªäº†ï¼Œè™½ç„¶é‚£ä¸ªå‘¨æœ«å¤©æ°”ä¸æ˜¯å¾ˆå¥½ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯ç©çš„å¾ˆå¼€å¿ƒçš„ã€‚å›æ¥çš„è·¯ä¸Šï¼Œæˆ‘ä»¬åœ¨è½¦ä¸ŠæŠŠåå¤‡ç®±çš„å‡ ç“¶é…’åœ¨è·¯ä¸Šå…¨å¹æ‰äº†ï¼Œä¸€ç§å®¿é†‰çš„æ„Ÿè§‰ã€‚</p>\n<p>   æƒ³åˆ°é©¬ä¸Šè¦å›åˆ°å­¦æ ¡ï¼Œå†…å¿ƒè¿˜æ˜¯å¾ˆæ¿€åŠ¨è¿‡çš„ï¼Œå¯èƒ½éƒ½çŸ¥é“å¤§å­¦å››å¹´å°±å‰©ä¸‹è¿™1ä¸ªå¤šæœˆæ—¶é—´äº†ï¼ŒåŒå­¦å®¿èˆ<br>ä¹‹é—´èµ°åŠ¨æ›´åŠ çš„é¢‘ç¹äº†ã€‚æ—¶é—´æµé€çš„æ€»æ˜¯å¿«çš„ï¼Œåšæ¯•è®¾ã€å†™è®ºæ–‡ã€ç­”è¾©ã€æ‹æ¯•ä¸šç…§ã€æ¯•ä¸šé…’ä¼šã€‚é©¬ä¸Šå°±è¦æ¯•ä¸šäº†ï¼Œè°åˆèƒ½æƒ³åˆ°ç­”è¾©é‚£å¤©èµ°å‡ºæ•™å®¤åï¼Œç›´åˆ°ç°åœ¨æˆ‘éƒ½æ²¡æœ‰å†è¿›å»è¿‡å¤§å­¦æ•™å®¤ã€‚æ˜¯å•Šï¼Œè¦å†è§äº†ï¼Œæˆ‘çš„å°ä¼™ä¼´ä»¬ã€‚<br>   6æœˆ25å·ï¼Œä»å—æ˜Œæ¥åˆ°æ­å·ï¼Œå…¶å®å†…å¿ƒè¿˜æ˜¯å¾ˆæ¿€åŠ¨çš„ï¼Œå› ä¸ºæˆ‘çŸ¥é“æˆ‘å†ä¹Ÿä¸æ˜¯å®ä¹ ç”Ÿäº†ï¼Œæˆ‘é©¬ä¸Šè¦è½¬ä¸º<br>å…¬å¸çš„æ­£å¼å‘˜å·¥äº†ã€‚å¯æ˜¯ä»¤æˆ‘æƒ³ä¸åˆ°çš„æ˜¯å¾ˆå¤šäº‹æƒ…éƒ½åœ¨æ”¹å˜ï¼Œé¢†å¯¼ä¹Ÿä¸å†æ˜¯ä¹‹å‰çš„é¢†å¯¼ï¼Œè¯´å¥½çš„ä¸€èµ·æˆé•¿å‘¢ã€‚æ¥ä¸‹æ¥å…¬å¸å·¥ä½œç¯å¢ƒå°±å˜å¾—æœ‰äº›è¯¡å¼‚äº†ï¼Œå½“æ—¶ä¹Ÿæ²¡æƒ³å¤ªå¤šï¼Œæ›´æ·±å±‚æ¬¡çš„ä¸œè¥¿æˆ‘ä¹Ÿæƒ³ä¸åˆ°ï¼Œåªæ˜¯æ„Ÿè§‰ï¼Œè¿™ç§å·¥ä½œçŠ¶æ€è¿˜ä¸å¦‚ä¹‹å‰å®ä¹ çš„é‚£ä¸ªå›¢é˜Ÿï¼Œå½“å·¥ä½œå¤±å»æ¿€æƒ…ï¼Œç¦»ç¦»å¼€ä¹Ÿå°±ä¸è¿œäº†ã€‚å¥½åœ¨ï¼Œæˆ‘å¹¶æ²¡æœ‰å› ä¸ºè¿™æ ·çš„çŠ¶æ€è€Œé¢“åºŸï¼Œè¿™æ®µæ—¶é—´ï¼Œæœ¬äººå¼€äº†åšå®¢ï¼Œå¼€å§‹å†™å†™åšå®¢ï¼Œå­¦ä¹ æ–°æŠ€æœ¯ä»¥å……å®è‡ªå·±ï¼Œè¿™æ®µæ—¶é—´çš„çŸ¥è¯†ç§¯ç´¯ï¼Œä¹Ÿå¯¹æˆ‘åé¢æ‰¾æ–°çš„å·¥ä½œæœ‰äº†å¸®åŠ©ã€‚æ¥ä¸‹æ¥æ­å·æ…¢æ…¢å¼€å§‹æˆä¸ºä¸–ç•Œä¸Šæœ€å®‰å…¨æœ€å¹²å‡€çš„åŸå¸‚äº†ï¼Œå› ä¸ºå—å…¨ä¸–ç•Œå…³æ³¨çš„G20è¦åœ¨æ­å·ä¸¾è¡Œäº†ï¼Œæ­å·çœŸçš„å¾ˆä¸é”™ï¼Œæˆ‘å–œæ¬¢è¿™åº§åŸã€‚</p>\n<p>   ç¦»å¼€ï¼Œ9æœˆ20å·ï¼Œå› æŸäº›åŸå› ï¼Œä»å…¬å¸ç¦»å¼€ã€‚æ¥ä¸‹æ¥ï¼Œå¾ˆå¤šçš„æ•£ä¼™é¥­ï¼Œè¿™è®©æˆ‘æƒ³èµ·äº†æ¯•ä¸šæ—¶çš„åœºæ™¯ï¼Œæ²¡<br>æœ‰ä¸æ•£çš„å®´å¸­ï¼Œè°å’Œé¥¿ç€è‚šå­å»å‘å–Šï¼Œå¼€å§‹å‡†å¤‡å†™ç®€å†å»è¿æ¥æ–°çš„å·¥ä½œäº†ã€‚é¢äº†6å®¶ä¼ä¸šï¼Œæˆ‘æœ€ç»ˆè¿˜æ˜¯é€‰æ‹©äº†æ„Ÿè§‰æœ€æœ‰å‘å±•å‰æ™¯çš„Cå…¬å¸ï¼Œå‡†å¤‡å›½åº†åè¿æ¥æ–°çš„ç¯å¢ƒã€‚</p>\n<p>   æ·±åˆ»ä½“ä¼šæ¥åˆ°ä¸€å®¶æ–°çš„ä¼ä¸šï¼Œéƒ½è¦ç»™æ—¶é—´å»é€‚åº”çš„ã€‚10æœˆåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯å»é€‚åº”å…¬å¸ç¯å¢ƒçš„è¿‡ç¨‹äº†ï¼›å…¬<br>å¸å‘å±•è¿…é€Ÿï¼Œé¡¹ç›®æ—¶é—´å®‰æ’ç´§ï¼Œè€Œè¿™ç»™æˆ‘å¸¦æ¥çš„å½±å“å°±æ˜¯ç»å¸¸åŠ ç­äº†ã€‚å¯èƒ½æ˜¯ä¸ºäº†ç¼“è§£å‹åŠ›ï¼Œ11æœˆä»½å…¬å¸å®‰æ’ä¸€æ¬¡å›¢å»ºï¼Œæ˜¯å»å®‰å‰ï¼Œé¡¿æ—¶æœ‰ç§ç†Ÿæ‚‰çš„æ„Ÿè§‰ã€‚<br>   ä¸€å¹´è¿‡çš„çœŸçš„å¾ˆå¿«å•Šï¼Œçªç„¶å°±åˆ°äº†ä¸€å¹´çš„æœ€åä¸€ä¸ªæœˆäº†ï¼Œè¿™ä¸ªæœˆçœŸæ˜¯å·¥ä½œä»¥æ¥å¿™ç¢Œçš„ä¸€ä¸ªæœˆå•Šï¼Œå°±è¿<br>ä»Šå¤©è¿™ä¸€å¹´çš„æœ€åä¸€å¤©ï¼Œéƒ½åœ¨å…¬å¸åŠ ç­ï¼ˆğŸ˜‚ï¼Œå…¶å®å¿ƒæ ¹æœ¬ä¸åœ¨çŠ¶æ€ï¼‰ã€‚å€¼å¾—åº†å¹¸çš„æ˜¯è¿™ä¸ªæœˆä¹Ÿæ˜¯è¿™ä¸€å¹´æœ€è®©æˆ‘å€¼å¾—æ€€å¿µçš„ï¼Œå› ä¸ºæˆ‘é‡åˆ°äº†ä¸€ä¸ªè®©æˆ‘å¿ƒåŠ¨çš„å¥³å­©ï¼Œæ˜¯çš„ï¼Œé‚£æ˜¯å¿ƒåŠ¨çš„æ„Ÿè§‰ã€‚</p>\n"},{"title":"Javaè®¾è®¡æ¨¡å¼","url":"https://yangzhiw.github.io/2016/12/31/Javaè®¾è®¡æ¨¡å¼/","content":""},{"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","url":"https://yangzhiw.github.io/2016/11/25/åˆ†å¸ƒå¼ç³»ç»Ÿ/","content":"<h1 id=\"é«˜ååï¼Œé«˜å¹¶å‘ï¼Œåº•å»¶è¿Ÿ\"><a href=\"#é«˜ååï¼Œé«˜å¹¶å‘ï¼Œåº•å»¶è¿Ÿ\" class=\"headerlink\" title=\"é«˜ååï¼Œé«˜å¹¶å‘ï¼Œåº•å»¶è¿Ÿ\"></a>é«˜ååï¼Œé«˜å¹¶å‘ï¼Œåº•å»¶è¿Ÿ</h1><h1 id=\"åˆ†å¸ƒå¼ç³»ç»Ÿæé«˜æ‰¿è½½é‡çš„åŸºæœ¬æ‰‹æ®µ\"><a href=\"#åˆ†å¸ƒå¼ç³»ç»Ÿæé«˜æ‰¿è½½é‡çš„åŸºæœ¬æ‰‹æ®µ\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼ç³»ç»Ÿæé«˜æ‰¿è½½é‡çš„åŸºæœ¬æ‰‹æ®µ\"></a>åˆ†å¸ƒå¼ç³»ç»Ÿæé«˜æ‰¿è½½é‡çš„åŸºæœ¬æ‰‹æ®µ</h1><pre><code>## åˆ†å±‚æ¨¡å‹ï¼ˆè·¯ç”±ï¼Œä»£ç†ï¼‰\n\n    å…¸å‹çš„çš„å°±æ˜¯ä¸‰å±‚ç»“æ„ï¼šæ¥å…¥ï¼Œé€»è¾‘ï¼Œå­˜å‚¨\n\n## å¹¶å‘æ¨¡å‹ï¼ˆå¤šçº¿ç¨‹ï¼Œå¼‚æ­¥ï¼‰\n    å¤šçº¿ç¨‹\n    å¼‚æ­¥å›è°ƒåŸºäºéé˜»å¡çš„I/Oæ“ä½œï¼ˆç½‘ç»œå’Œæ–‡ä»¶ï¼‰\n\n## ç¼“å†²æŠ€æœ¯\n## å­˜å‚¨æŠ€æœ¯ï¼ˆNoSQLï¼‰\n</code></pre><h1 id=\"åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¯ç®¡ç†æ€§ä¸Šé€ æˆçš„é—®é¢˜\"><a href=\"#åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¯ç®¡ç†æ€§ä¸Šé€ æˆçš„é—®é¢˜\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¯ç®¡ç†æ€§ä¸Šé€ æˆçš„é—®é¢˜\"></a>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¯ç®¡ç†æ€§ä¸Šé€ æˆçš„é—®é¢˜</h1><pre><code>## ç¡¬ä»¶æ•…éšœç‡\n\n## èµ„æºåˆ©ç”¨ç‡ä¼˜åŒ–\n\n## è½¯ä»¶æœåŠ¡å†…å®¹æ›´æ–°\n\n ## æ•°æ®ç»Ÿè®¡å’Œå†³ç­–\n</code></pre><h1 id=\"è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿå¯ç®¡ç†æ€§çš„åŸºæœ¬æ‰‹æ®µ\"><a href=\"#è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿå¯ç®¡ç†æ€§çš„åŸºæœ¬æ‰‹æ®µ\" class=\"headerlink\" title=\"è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿå¯ç®¡ç†æ€§çš„åŸºæœ¬æ‰‹æ®µ\"></a>è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿå¯ç®¡ç†æ€§çš„åŸºæœ¬æ‰‹æ®µ</h1><pre><code>## ç›®å½•æœåŠ¡ï¼ˆZooKeeperï¼‰\n\n## æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼ˆActiveMQã€ZeroMQã€Jgroupsï¼‰\n\n## äº‹åŠ¡ç³»ç»Ÿ\n\n## è‡ªåŠ¨éƒ¨ç½²å·¥å…·ï¼ˆDockerï¼‰\n\n## æ—¥å¿—æœåŠ¡ï¼ˆlog4jï¼‰\n</code></pre><h1 id=\"åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¼€å‘æ•ˆç‡ä¸Šé€ æˆçš„é—®é¢˜å’Œè§£å†³æ€è·¯\"><a href=\"#åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¼€å‘æ•ˆç‡ä¸Šé€ æˆçš„é—®é¢˜å’Œè§£å†³æ€è·¯\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¼€å‘æ•ˆç‡ä¸Šé€ æˆçš„é—®é¢˜å’Œè§£å†³æ€è·¯\"></a>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¼€å‘æ•ˆç‡ä¸Šé€ æˆçš„é—®é¢˜å’Œè§£å†³æ€è·¯</h1>"},{"title":"spring-kafaké›†æˆå­¦ä¹ ","url":"https://yangzhiw.github.io/2016/10/24/spring-kafaké›†æˆå­¦ä¹ /","content":""},{"title":"Spring MVCæ‹¦æˆªå™¨","url":"https://yangzhiw.github.io/2016/09/18/Spring-MVCæ‹¦æˆªå™¨/","content":"<h1 id=\"ä½¿ç”¨åœºæ™¯\"><a href=\"#ä½¿ç”¨åœºæ™¯\" class=\"headerlink\" title=\"ä½¿ç”¨åœºæ™¯\"></a>ä½¿ç”¨åœºæ™¯</h1><p>è®°å½•webè¯·æ±‚çš„ç›¸å…³æ—¥å¿—ï¼Œå¯ä»¥åšä¿¡æ¯ç›‘æ§ï¼Œç»Ÿè®¡ï¼Œåˆ†æ<br>æ£€æŸ¥webçš„è®¿é—®æƒé™ï¼Œä¾‹å¦‚å‘ç°ç”¨æˆ·æ²¡æœ‰ç™»å½•åï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚<br>æ‰“å¼€å…³é—­æ•°æ®åº“è¿æ¥â€“é¢„å¤„ç†æ‰“å¼€ï¼Œåå¤„ç†å…³é—­ï¼Œå¯ä»¥é¿å…æ‰€æœ‰çš„ä¸šåŠ¡æ–¹æ³•ä¸­éƒ½ç¼–å†™ç›¸ä¼¼çš„ç±»ã€‚</p>\n<h1 id=\"Spring-MVCçš„è¯·æ±‚æµç¨‹\"><a href=\"#Spring-MVCçš„è¯·æ±‚æµç¨‹\" class=\"headerlink\" title=\"Spring MVCçš„è¯·æ±‚æµç¨‹\"></a>Spring MVCçš„è¯·æ±‚æµç¨‹</h1><img src=\"/2016/09/18/Spring-MVCæ‹¦æˆªå™¨/spring-mvc1.jpg\" alt=\"Spring-MVCè¯·æ±‚æµç¨‹\" title=\"Spring-MVCè¯·æ±‚æµç¨‹\">\n<h1 id=\"HandlerInterceptoræ¥å£\"><a href=\"#HandlerInterceptoræ¥å£\" class=\"headerlink\" title=\"HandlerInterceptoræ¥å£\"></a>HandlerInterceptoræ¥å£</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">public interface HandlerInterceptor &#123;</div><div class=\"line\">    boolean preHandle(HttpServletRequest request, </div><div class=\"line\">                      HttpServletResponse response, </div><div class=\"line\">                      Object handler) throws Exception;</div><div class=\"line\"></div><div class=\"line\">    void postHandle(HttpServletRequest request, </div><div class=\"line\">                    HttpServletResponse response, </div><div class=\"line\">                    Object handler, ModelAndView modelAndView) throws Exception;</div><div class=\"line\"></div><div class=\"line\">    void afterCompletion(HttpServletRequest request, </div><div class=\"line\">                         HttpServletResponse response, </div><div class=\"line\">                         Object handler, Exception ex) throws Exception;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>1.preHandle()ï¼šé¢„å¤„ç†å›è°ƒæ–¹æ³•ï¼Œè‹¥æ–¹æ³•è¿”å›å€¼ä¸ºtrueï¼Œè¯·æ±‚ç»§ç»­ï¼ˆè°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–å¤„ç†å™¨æ–¹æ³•ï¼‰ï¼›è‹¥æ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼Œè¯·æ±‚å¤„ç†æµç¨‹ä¸­æ–­ï¼Œä¸ä¼šç»§ç»­è°ƒç”¨å…¶ä»–çš„æ‹¦æˆªå™¨æˆ–å¤„ç†å™¨æ–¹æ³•ï¼Œæ­¤æ—¶éœ€è¦é€šè¿‡responseäº§ç”Ÿå“åº”ï¼›<br>2.postHandle()ï¼šåå¤„ç†å›è°ƒæ–¹æ³•ï¼Œå®ç°å¤„ç†å™¨çš„åå¤„ç†ï¼ˆä½†åœ¨æ¸²æŸ“è§†å›¾ä¹‹å‰ï¼‰ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡modelAndViewå¯¹æ¨¡å‹æ•°æ®è¿›è¡Œå¤„ç†æˆ–å¯¹è§†å›¾è¿›è¡Œå¤„ç†<br>3.afterCompletion()ï¼šæ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæ¯•å›è°ƒæ–¹æ³•ï¼Œå³åœ¨è§†å›¾æ¸²æŸ“å®Œæ¯•æ—¶è°ƒç”¨</p>\n<h1 id=\"å®ä¾‹ï¼šç”¨æˆ·ç™»å½•æ£€æŸ¥\"><a href=\"#å®ä¾‹ï¼šç”¨æˆ·ç™»å½•æ£€æŸ¥\" class=\"headerlink\" title=\"å®ä¾‹ï¼šç”¨æˆ·ç™»å½•æ£€æŸ¥\"></a>å®ä¾‹ï¼šç”¨æˆ·ç™»å½•æ£€æŸ¥</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">public class LoginInterceptor extends HandlerInterceptorAdapter &#123;</div><div class=\"line\"></div><div class=\"line\">    @Override</div><div class=\"line\">    public boolean preHandle(HttpServletRequest request,</div><div class=\"line\">                             HttpServletResponse response,</div><div class=\"line\">                             Object handler) throws Exception &#123;</div><div class=\"line\">        if (request.getSession().getAttribute(Constants.USER_SESSION_ATTR) != <span class=\"literal\">null</span>) &#123;</div><div class=\"line\">            return <span class=\"literal\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        response.sendRedirect(<span class=\"string\">\"/\"</span>);</div><div class=\"line\">        return <span class=\"literal\">false</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h1 id=\"é…ç½®Interceptor\"><a href=\"#é…ç½®Interceptor\" class=\"headerlink\" title=\"é…ç½®Interceptor\"></a>é…ç½®Interceptor</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">@Configuration</div><div class=\"line\">public class WebMvcConfig extends WebMvcConfigurerAdapter &#123;</div><div class=\"line\"></div><div class=\"line\">    @Override</div><div class=\"line\">    public void addInterceptors(InterceptorRegistry registry) &#123;</div><div class=\"line\">        registry.addInterceptor(new LoginInterceptor())</div><div class=\"line\">                .addPathPatterns(<span class=\"string\">\"/**\"</span>)</div><div class=\"line\">                .excludePathPatterns(<span class=\"string\">\"/account/*\"</span>).excludePathPatterns(<span class=\"string\">\"/\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n"},{"title":"codis é…ç½®","url":"https://yangzhiw.github.io/2016/09/18/codis é…ç½®/","content":"<p>@Configuration<br>public class CodisConfiguration {<br>    @Value(â€œ${codis.zookeeper.clients}â€)<br>    private String zkClients;<br>    @Value(â€œ${codis.zookeeper.proxyDir}â€)<br>    private String zkDir;<br>    @Value(â€œ${codis.poolConfig.maxIdle}â€)<br>    private int maxIdle;<br>    @Value(â€œ${codis.poolConfig.maxTotal}â€)<br>    private int maxTotal;</p>\n<pre><code>@Bean\npublic JedisResourcePool jedisResourcePool() {\n    JedisPoolConfig poolConfig = new JedisPoolConfig();\n    poolConfig.setMaxIdle(maxIdle);\n    poolConfig.setMaxTotal(maxTotal);\n    poolConfig.setTestOnBorrow(true);\n    return RoundRobinJedisPool.create().curatorClient(zkClients, 30000).zkProxyDir(zkDir)\n            .poolConfig(poolConfig).build();\n}\n</code></pre><p>}</p>\n"},{"title":"äºŒå‰æ ‘çš„éå†","url":"https://yangzhiw.github.io/2016/09/18/äºŒå‰æ ‘çš„éå†/","content":"<h1 id=\"ä¸­åºéå†\"><a href=\"#ä¸­åºéå†\" class=\"headerlink\" title=\"ä¸­åºéå†\"></a>ä¸­åºéå†</h1><p>ä»æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç€å…¶å·¦å­©å­åŸŸå‘ä¸‹ç§»åŠ¨ï¼Œç›´åˆ°æŸä¸€èŠ‚ç‚¹å†æ— å·¦èŠ‚ç‚¹ï¼Œè®¿é—®è¿™ä¸ªæœ€å·¦è¾¹çš„èŠ‚ç‚¹ï¼Œæ¥ä¸‹æ¥å†ä»æ­¤èŠ‚ç‚¹çš„å³å­©å­<br>å¼€å§‹è¿›è¡Œä¸­åºéå†ï¼Œå½“å³å­æ ‘éå†å®Œäº†ä»¥åï¼Œé€€å›åˆ°ä¸Šä¸€å±‚çš„æœªè®¿é—®èŠ‚ç‚¹ç»§ç»­äºŒå‰æ ‘éå†ï¼Œç›´åˆ°ä¹¦ä¸­æ‰€æœ‰èŠ‚ç‚¹è¢«è®¿é—®åˆ°ä¸ºæ­¢ã€‚</p>\n<h1 id=\"å…ˆåºéå†\"><a href=\"#å…ˆåºéå†\" class=\"headerlink\" title=\"å…ˆåºéå†\"></a>å…ˆåºéå†</h1><p>å¯¹èŠ‚ç‚¹çš„è®¿é—®æ—¶åœ¨å…¶å·¦ã€å³å­æ ‘ä¹‹å‰è¿›è¡Œçš„ã€‚éå†æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„ï¼Œé‡åˆ°æ¯ä¸ªèŠ‚ç‚¹æ—¶ï¼Œéå†è¿‡ç¨‹ä¸ºï¼š<br>è®¿é—®æ ¹èŠ‚ç‚¹<br>å…ˆåºéå†å…¶å·¦å­æ ‘<br>å…ˆåºéå†å…¶å³å­æ ‘</p>\n"},{"title":"ä½¿ç”¨Herokuå…è´¹éƒ¨ç½²Javaåº”ç”¨","url":"https://yangzhiw.github.io/2016/08/29/ä½¿ç”¨herokuå…è´¹éƒ¨ç½²Javaåº”ç”¨/","content":"<h1 id=\"ç®€ä»‹\"><a href=\"#ç®€ä»‹\" class=\"headerlink\" title=\"ç®€ä»‹\"></a>ç®€ä»‹</h1><p>Herokuæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„äº‘å¹³å°å³æœåŠ¡ã€‚</p>\n<h1 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h1><p>1.æ³¨å†ŒHerkuè´¦å·<br>2.åœ¨æœ¬åœ°å®‰è£…Java8<br>3.åœ¨æœ¬åœ°å®‰è£…Maven3</p>\n<h1 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h1><p>å®‰è£…æœ¬åœ°å®¢æˆ·ç«¯ Heroku-cliï¼Œ<a href=\"https://devcenter.heroku.com/articles/heroku-command-line\" target=\"_blank\" rel=\"external\">å®‰è£…Heroku-cli</a></p>\n<p>ç„¶åæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ç™»å½•å¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt;heroku login</div><div class=\"line\">Enter your Heroku credentials.</div><div class=\"line\"><span class=\"attr\">Email:</span> email@example.com</div><div class=\"line\"><span class=\"attr\">Password:</span></div></pre></td></tr></table></figure></p>\n<h1 id=\"éƒ¨ç½²åº”ç”¨\"><a href=\"#éƒ¨ç½²åº”ç”¨\" class=\"headerlink\" title=\"éƒ¨ç½²åº”ç”¨\"></a>éƒ¨ç½²åº”ç”¨</h1><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å®˜ç½‘ç»™çš„åº”ç”¨<br>é¦–å…ˆå…‹éš†git clone <a href=\"https://github.com/heroku/java-getting-started.git\" target=\"_blank\" rel=\"external\">https://github.com/heroku/java-getting-started.git</a><br>cdåˆ°é¡¹ç›®ç›®å½•: cd java-getting-started<br>åˆ›å»ºåº”ç”¨åˆ°Herokuä¸Šå¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt; heroku create</div><div class=\"line\">Creating shielded-caverns<span class=\"bullet\">-88393.</span>.. done, stack is cedar<span class=\"bullet\">-14</span></div><div class=\"line\"><span class=\"attr\">http:</span>//shielded-caverns<span class=\"bullet\">-88393.</span>herokuapp.com/ | https://git.heroku.com/shielded-caverns<span class=\"bullet\">-88393.</span>git</div></pre></td></tr></table></figure></p>\n<p>shielded-caverns-88393 è¿™æ˜¯ä¸€ä¸ªéšæœºçš„æ•°ï¼Œå¯ä»¥åˆ°kerokuçš„åº”ç”¨åˆ—è¡¨æ‰¾åˆ°è¿™ä¸ªåº”ç”¨ï¼Œç„¶åå»ä¿®æ”¹ã€‚</p>\n<h2 id=\"éƒ¨ç½²åº”ç”¨ä»£ç \"><a href=\"#éƒ¨ç½²åº”ç”¨ä»£ç \" class=\"headerlink\" title=\"éƒ¨ç½²åº”ç”¨ä»£ç \"></a>éƒ¨ç½²åº”ç”¨ä»£ç </h2><blockquote>\n<p>git push heroku master</p>\n</blockquote>\n<h2 id=\"è®¿é—®\"><a href=\"#è®¿é—®\" class=\"headerlink\" title=\"è®¿é—®\"></a>è®¿é—®</h2><blockquote>\n<p>heroku open</p>\n</blockquote>\n<h1 id=\"æŸ¥çœ‹æ—¥å¿—\"><a href=\"#æŸ¥çœ‹æ—¥å¿—\" class=\"headerlink\" title=\"æŸ¥çœ‹æ—¥å¿—\"></a>æŸ¥çœ‹æ—¥å¿—</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">D:</span>\\resource\\java-getting-started&gt;heroku logs --tail</div><div class=\"line\"><span class=\"number\">2016</span><span class=\"bullet\">-08</span><span class=\"bullet\">-29</span>T02:<span class=\"number\">37</span>:<span class=\"number\">19.738508</span>+<span class=\"number\">00</span>:<span class=\"number\">00</span> heroku[api]: Release v2 created by yang993505@gmail.com</div><div class=\"line\"><span class=\"number\">2016</span><span class=\"bullet\">-08</span><span class=\"bullet\">-29</span>T02:<span class=\"number\">37</span>:<span class=\"number\">19.738508</span>+<span class=\"number\">00</span>:<span class=\"number\">00</span> heroku[api]: Enable Logplex by yang993505@gmail.com</div><div class=\"line\"><span class=\"number\">2016</span><span class=\"bullet\">-08</span><span class=\"bullet\">-29</span>T02:<span class=\"number\">37</span>:<span class=\"number\">45.907720</span>+<span class=\"number\">00</span>:<span class=\"number\">00</span> heroku[router]: at=info code=H81 desc=<span class=\"string\">\"Blank app\"</span> method=GET path=<span class=\"string\">\"/\"</span> h</div><div class=\"line\">erns<span class=\"bullet\">-88393.</span>herokuapp.com request_id=<span class=\"number\">9872849</span>a-d62c<span class=\"bullet\">-4053</span>-b744-b067e1270c3b fwd=<span class=\"string\">\"45.55.27.82\"</span> dyno= connect</div><div class=\"line\">s=<span class=\"number\">502</span> bytes=</div></pre></td></tr></table></figure>\n<h1 id=\"å®šä¹‰Procfile\"><a href=\"#å®šä¹‰Procfile\" class=\"headerlink\" title=\"å®šä¹‰Procfile\"></a>å®šä¹‰Procfile</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">web:</span> java -jar target/helloworld.jar</div></pre></td></tr></table></figure>\n<h1 id=\"æœ¬åœ°è¿è¡Œ\"><a href=\"#æœ¬åœ°è¿è¡Œ\" class=\"headerlink\" title=\"æœ¬åœ°è¿è¡Œ\"></a>æœ¬åœ°è¿è¡Œ</h1><h2 id=\"å®‰è£…ä¾èµ–\"><a href=\"#å®‰è£…ä¾èµ–\" class=\"headerlink\" title=\"å®‰è£…ä¾èµ–\"></a>å®‰è£…ä¾èµ–</h2><p>mvn clean install</p>\n<h2 id=\"è¿è¡Œ\"><a href=\"#è¿è¡Œ\" class=\"headerlink\" title=\"è¿è¡Œ\"></a>è¿è¡Œ</h2><p>heroku local web<br>æ‰“å¼€æµè§ˆå™¨è¾“å…¥localhost:5000å³å¯è®¿é—®</p>\n<h1 id=\"å…¶ä»–æœåŠ¡æä¾›\"><a href=\"#å…¶ä»–æœåŠ¡æä¾›\" class=\"headerlink\" title=\"å…¶ä»–æœåŠ¡æä¾›\"></a>å…¶ä»–æœåŠ¡æä¾›</h1><p>é»˜è®¤æƒ…å†µä¸‹,Herokuèƒ½å¤Ÿæ˜¾ç¤º1500è¡Œæ—¥å¿—ã€‚ç„¶è€Œ,å®ƒæä¾›å®Œæ•´çš„æ—¥å¿—æµä½œä¸ºæœåŠ¡â€”â€”å’Œå‡ ä¸ªæ’ä»¶æä¾›å•†æ‰€å†™çš„æ—¥å¿—æœåŠ¡,<br>æä¾›è¯¸å¦‚æ—¥å¿—æŒä¹…æ€§ã€æœç´¢å’Œç”µå­é‚®ä»¶å’ŒçŸ­ä¿¡æé†’ã€‚</p>\n<p>ä¸‹é¢,æˆ‘ä»¬å°†æä¾›ä¸€ä¸ªæ—¥å¿—æ’ä»¶,Papertrailã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">D:</span>\\resource\\java-getting-started&gt;heroku addons:create papertrail</div><div class=\"line\">Creating papertrail on shielded-caverns<span class=\"bullet\">-88393.</span>.. !</div><div class=\"line\"> !    Please verify your account to install this add-on plan (please enter a credit card) For more information, see</div><div class=\"line\"> !    https://devcenter.heroku.com/categories/billing Verify now at https://heroku.com/verify</div></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œæç¤ºè¦åœ¨herokuè¾“å…¥ä¸€ä¸ªé“¶è¡Œå¡çš„ä¿¡æ¯ã€‚å…ˆä¸åšè¿™ä¸ªæ¼”ç¤ºäº†</p>\n<p>ä½¿ç”¨heroku addonså¯ä»¥æŸ¥çœ‹å·²ç»è£…å¥½çš„æ’ä»¶æœåŠ¡ã€‚</p>\n<h1 id=\"herokuç»ˆç«¯\"><a href=\"#herokuç»ˆç«¯\" class=\"headerlink\" title=\"herokuç»ˆç«¯\"></a>herokuç»ˆç«¯</h1><p>heroku run bash</p>\n<h1 id=\"è®¾ç½®å˜é‡\"><a href=\"#è®¾ç½®å˜é‡\" class=\"headerlink\" title=\"è®¾ç½®å˜é‡\"></a>è®¾ç½®å˜é‡</h1><p>heroku config:set ENERGY=â€20 GeVâ€<br>æŸ¥çœ‹å˜é‡<br>heroku config</p>\n<h1 id=\"ä½¿ç”¨æ•°æ®åº“\"><a href=\"#ä½¿ç”¨æ•°æ®åº“\" class=\"headerlink\" title=\"ä½¿ç”¨æ•°æ®åº“\"></a>ä½¿ç”¨æ•°æ®åº“</h1><p>æ•°æ®åº“çš„ä½¿ç”¨ä¹Ÿæ˜¯éœ€è¦å®‰è£…æœåŠ¡çš„ï¼Œè¯¦æƒ…è§<br><a href=\"https://elements.heroku.com/addons#data-stores,&quot;&quot;\" target=\"_blank\" rel=\"external\">å®‰è£…æ•°æ®åº“æ’ä»¶</a></p>\n"},{"title":"Spring Boot ä¸­çš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†","url":"https://yangzhiw.github.io/2016/08/28/Spring-Boot-ä¸­çš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†/","content":"<p>Spring Bootä¸­é»˜è®¤å¸¦äº†errorçš„æ˜ å°„ï¼Œä½†æ˜¯è¿™ä¸ªé”™è¯¯é¡µé¢æ˜¾ç¤ºç»™ç”¨æˆ·å¹¶ä¸æ˜¯å¾ˆå‹å¥½ã€‚</p>\n<h1 id=\"ç»Ÿä¸€å¼‚å¸¸å¤„ç†\"><a href=\"#ç»Ÿä¸€å¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"ç»Ÿä¸€å¼‚å¸¸å¤„ç†\"></a>ç»Ÿä¸€å¼‚å¸¸å¤„ç†</h1><h2 id=\"é€šè¿‡ä½¿ç”¨-ControllerAdviceå®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„ç±»ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªControllerä¸­é€ä¸ªå®šä¹‰ã€‚\"><a href=\"#é€šè¿‡ä½¿ç”¨-ControllerAdviceå®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„ç±»ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªControllerä¸­é€ä¸ªå®šä¹‰ã€‚\" class=\"headerlink\" title=\"é€šè¿‡ä½¿ç”¨@ControllerAdviceå®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„ç±»ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªControllerä¸­é€ä¸ªå®šä¹‰ã€‚\"></a>é€šè¿‡ä½¿ç”¨@ControllerAdviceå®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„ç±»ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªControllerä¸­é€ä¸ªå®šä¹‰ã€‚</h2><p>@ExceptionHandlerç”¨æ¥å®šä¹‰å‡½æ•°é’ˆå¯¹çš„å‡½æ•°ç±»å‹ï¼Œæœ€åå°†Exceptionå¯¹è±¡å’Œè¯·æ±‚URLæ˜ å°„åˆ°URLä¸­ã€‚</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">@ControllerAdvice</div><div class=\"line\">class ExceptionTranslator &#123;</div><div class=\"line\"></div><div class=\"line\">    public static final String DEFAULT_ERROR_VIEW = <span class=\"string\">\"error\"</span>;</div><div class=\"line\"></div><div class=\"line\">    @ExceptionHandler(value = Exception.class)</div><div class=\"line\">    public ModelAndView defaultErrorHandler(HttpServletRequest req, Exception e) throws Exception &#123;</div><div class=\"line\">        ModelAndView mav = new ModelAndView();</div><div class=\"line\">        mav.addObject(<span class=\"string\">\"exception\"</span>, e);</div><div class=\"line\">        mav.addObject(<span class=\"string\">\"url\"</span>, req.getRequestURL());</div><div class=\"line\">        mav.setViewName(DEFAULT_ERROR_VIEW);</div><div class=\"line\">        return mav;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"å®ç°error-htmlé¡µé¢å±•ç¤º\"><a href=\"#å®ç°error-htmlé¡µé¢å±•ç¤º\" class=\"headerlink\" title=\"å®ç°error.htmlé¡µé¢å±•ç¤º\"></a>å®ç°error.htmlé¡µé¢å±•ç¤º</h2><p>åœ¨templatesç›®å½•ä¸‹åˆ›å»ºerror.htmlã€‚<br>ä¾‹å¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!DOCTYPE html<span class=\"string\">&gt;  </span></div><div class=\"line\">&lt;html&gt;  </div><div class=\"line\">&lt;head lang=\"en\"&gt;  </div><div class=\"line\">    &lt;meta charset=\"UTF-8\" /&gt;</div><div class=\"line\">    &lt;title&gt;ç»Ÿä¸€å¼‚å¸¸å¤„ç†&lt;/title&gt;</div><div class=\"line\">&lt;/head&gt;  </div><div class=\"line\">&lt;body&gt;  </div><div class=\"line\">    &lt;h1&gt;Error Handler&lt;/h1&gt;</div><div class=\"line\">    &lt;div th:text=\"$&#123;url&#125;\"&gt;&lt;/div&gt;</div><div class=\"line\">    &lt;div th:text=\"$&#123;exception.message&#125;\"&gt;&lt;/div&gt;</div><div class=\"line\">&lt;/body&gt;  </div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure></p>\n<h1 id=\"è¿”å›ä½¿ç”¨Jsonæ ¼å¼\"><a href=\"#è¿”å›ä½¿ç”¨Jsonæ ¼å¼\" class=\"headerlink\" title=\"è¿”å›ä½¿ç”¨Jsonæ ¼å¼\"></a>è¿”å›ä½¿ç”¨Jsonæ ¼å¼</h1><p>åªéœ€åœ¨@ExceptionHandlerä¹‹ååŠ å…¥@ResponseBodyï¼Œå°±èƒ½è®©å¤„ç†å‡½æ•°returnçš„å†…å®¹è½¬æ¢ä¸ºJSONæ ¼å¼</p>\n<h2 id=\"åˆ›å»ºä¸€ä¸ªJSONè¿”å›å¯¹è±¡ï¼Œå¦‚ï¼š\"><a href=\"#åˆ›å»ºä¸€ä¸ªJSONè¿”å›å¯¹è±¡ï¼Œå¦‚ï¼š\" class=\"headerlink\" title=\"åˆ›å»ºä¸€ä¸ªJSONè¿”å›å¯¹è±¡ï¼Œå¦‚ï¼š\"></a>åˆ›å»ºä¸€ä¸ªJSONè¿”å›å¯¹è±¡ï¼Œå¦‚ï¼š</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">public class ErrorDTO implements Serializable &#123;</div><div class=\"line\"></div><div class=\"line\">    private static final long serialVersionUID = <span class=\"number\">1</span>L;</div><div class=\"line\"></div><div class=\"line\">    private final String message;</div><div class=\"line\">    private final String description;</div><div class=\"line\"></div><div class=\"line\">    private List&lt;FieldErrorDTO&gt; fieldErrors;</div><div class=\"line\"></div><div class=\"line\">    //getterå’Œsetterçœç•¥</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"å¯ä»¥ä¸ºæŒ‡å®šçš„Exceptionæ·»åŠ å¼‚å¸¸å¤„ç†\"><a href=\"#å¯ä»¥ä¸ºæŒ‡å®šçš„Exceptionæ·»åŠ å¼‚å¸¸å¤„ç†\" class=\"headerlink\" title=\"å¯ä»¥ä¸ºæŒ‡å®šçš„Exceptionæ·»åŠ å¼‚å¸¸å¤„ç†\"></a>å¯ä»¥ä¸ºæŒ‡å®šçš„Exceptionæ·»åŠ å¼‚å¸¸å¤„ç†</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">@ExceptionHandler(ConcurrencyFailureException.class)</div><div class=\"line\">  @ResponseStatus(HttpStatus.CONFLICT)</div><div class=\"line\">  @ResponseBody</div><div class=\"line\">  public ErrorDTO processConcurencyError(ConcurrencyFailureException ex) &#123;</div><div class=\"line\">      return new ErrorDTO(ErrorConstants.ERR_CONCURRENCY_FAILURE);</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure>\n<p>ErrorConstants.ERR_CONCURRENCY_FAILURE æ˜¯å®šä¹‰çš„ä¸€ä¸ªå¼‚å¸¸ä¿¡æ¯ã€‚</p>\n"},{"title":"Spring CloudæœåŠ¡ç½‘å…³","url":"https://yangzhiw.github.io/2016/08/25/Spring-CloudæœåŠ¡ç½‘å…³/","content":"<p>å¸¸ç”¨çš„å¾®æœåŠ¡æ¶æ„<br><img src=\"/2016/08/25/Spring-CloudæœåŠ¡ç½‘å…³/zuul.jpg\" alt=\"å¾®æœåŠ¡æ¶æ„\" title=\"å¾®æœåŠ¡æ¶æ„\"></p>\n<blockquote>\n<p>ç§ç§æ¶æ„çš„ä¸è¶³å°±æ˜¯ç¼ºå°‘æƒé™æ§åˆ¶ï¼Œ ç°åœ¨æˆ‘ä»¬éœ€è¦å¢åŠ çš„å°±æ˜¯æœåŠ¡ç½‘å…³äº†ï¼Œ<br>æœåŠ¡ç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­ä¸€ä¸ªä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚é€šè¿‡æœåŠ¡ç½‘å…³ç»Ÿä¸€å‘å¤–ç³»ç»Ÿæä¾›REST APIçš„è¿‡ç¨‹ä¸­ï¼Œé™¤äº†å…·å¤‡æœåŠ¡è·¯ç”±ã€<br>å‡è¡¡è´Ÿè½½åŠŸèƒ½ä¹‹å¤–ï¼Œå®ƒè¿˜å…·å¤‡äº†æƒé™æ§åˆ¶ç­‰åŠŸèƒ½ã€‚Spring Cloud Netflixä¸­çš„Zuulå°±æ‹…ä»»äº†è¿™æ ·çš„ä¸€ä¸ªè§’è‰²ï¼Œ<br>ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›äº†å‰é—¨ä¿æŠ¤çš„ä½œç”¨ï¼ŒåŒæ—¶å°†æƒé™æ§åˆ¶è¿™äº›è¾ƒé‡çš„éä¸šåŠ¡é€»è¾‘å†…å®¹è¿ç§»åˆ°æœåŠ¡è·¯ç”±å±‚é¢ï¼Œ<br>ä½¿å¾—æœåŠ¡é›†ç¾¤ä¸»ä½“èƒ½å¤Ÿå…·å¤‡æ›´é«˜çš„å¯å¤ç”¨æ€§å’Œå¯æµ‹è¯•æ€§ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å®ä¾‹ä¾‹å­æ¥ä½¿ç”¨ä¸€ä¸‹Zuulæ¥ä½œä¸ºæœåŠ¡çš„è·¯æœ‰åŠŸèƒ½</p>\n<h1 id=\"å‡†å¤‡å·¥ä½œ\"><a href=\"#å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"å‡†å¤‡å·¥ä½œ\"></a>å‡†å¤‡å·¥ä½œ</h1><p>åœ¨ä½¿ç”¨Zuulä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒã€ä»¥åŠä¸¤ä¸ªç®€å•çš„æœåŠ¡ï¼Œæ¯”å¦‚ï¼šæˆ‘æ„å»ºäº†ä¸€ä¸ªsimple-serviceï¼Œ<br>ä¸€ä¸ªsimple-service1ã€‚ç„¶åå¯åŠ¨eureka-serverå’Œè¿™ä¸¤ä¸ªæœåŠ¡ã€‚<br>é€šè¿‡è®¿é—®eureka-serverï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°simple-serviceå’Œsimple-service1å·²ç»æ³¨å†Œåˆ°äº†æœåŠ¡ä¸­å¿ƒã€‚</p>\n<h1 id=\"å¼€å§‹ä½¿ç”¨Zuul\"><a href=\"#å¼€å§‹ä½¿ç”¨Zuul\" class=\"headerlink\" title=\"å¼€å§‹ä½¿ç”¨Zuul\"></a>å¼€å§‹ä½¿ç”¨Zuul</h1><p>å¼•å…¥ä¾èµ–spring-cloud-starter-zuulã€spring-cloud-starter-eurekaï¼Œå¦‚æœä¸æ˜¯é€šè¿‡æŒ‡å®šserviceIdçš„æ–¹å¼ï¼Œeurekaä¾èµ–ä¸éœ€è¦ï¼Œ<br>ä½†æ˜¯ä¸ºäº†å¯¹æœåŠ¡é›†ç¾¤ç»†èŠ‚çš„é€æ˜æ€§ï¼Œè¿˜æ˜¯ç”¨serviceIdæ¥é¿å…ç›´æ¥å¼•ç”¨urlçš„æ–¹å¼å§ã€‚</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency<span class=\"string\">&gt;  </span></div><div class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-zuul&lt;/artifactId&gt;</div><div class=\"line\">&lt;/dependency&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;dependency&gt;  </div><div class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</div><div class=\"line\">&lt;/dependency&gt;  </div><div class=\"line\"></div><div class=\"line\">&lt;dependencyManagement&gt;</div><div class=\"line\">\t\t&lt;dependencies&gt;</div><div class=\"line\">\t\t\t&lt;dependency&gt;</div><div class=\"line\">\t\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">\t\t\t\t&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">\t\t\t\t&lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">\t\t\t\t&lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">\t\t\t\t&lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">\t\t\t&lt;/dependency&gt;</div><div class=\"line\">\t\t&lt;/dependencies&gt;</div><div class=\"line\">&lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure>\n<p>åº”ç”¨ä¸»ç±»ä½¿ç”¨@EnableZuulProxyæ³¨è§£å¼€å¯Zuul<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">@EnableZuulProxy</div><div class=\"line\">@SpringCloudApplication</div><div class=\"line\">public class ApiGatewayApplication &#123;</div><div class=\"line\"></div><div class=\"line\">\tpublic static void main(String[] args) &#123;</div><div class=\"line\">\t\tSpringApplication.run(ApiGatewayApplication.class, args);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>@SpringCloudApplicationæ³¨è§£ï¼Œé€šè¿‡æºç æˆ‘ä»¬çœ‹åˆ°ï¼Œ<br>å®ƒæ•´åˆäº†@SpringBootApplicationã€@EnableDiscoveryClientã€@EnableCircuitBreaker</p>\n<p>application.propertiesä¸­é…ç½®Zuulåº”ç”¨çš„åŸºç¡€ä¿¡æ¯ï¼Œå¦‚ï¼šåº”ç”¨åã€æœåŠ¡ç«¯å£ç­‰ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">spring.application.name=api-gateway  </div><div class=\"line\">server.port=<span class=\"number\">5555</span> </div><div class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:<span class=\"number\">11111</span>/eureka/</div></pre></td></tr></table></figure></p>\n<p>åœ¨Zuulä¸­æä¾›äº†ä¸¤ç§æ˜ å°„æ–¹å¼ï¼š</p>\n<h2 id=\"é€šè¿‡urlç›´æ¥æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹é…ç½®ï¼š\"><a href=\"#é€šè¿‡urlç›´æ¥æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹é…ç½®ï¼š\" class=\"headerlink\" title=\"é€šè¿‡urlç›´æ¥æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹é…ç½®ï¼š\"></a>é€šè¿‡urlç›´æ¥æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹é…ç½®ï¼š</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># routes to url</span></div><div class=\"line\">zuul.routes.api-a-url.path=/api-a-url/**  </div><div class=\"line\">zuul.routes.api-a-url.url=http://localhost:<span class=\"number\">2222</span>/</div></pre></td></tr></table></figure>\n<p>è¯¥é…ç½®ï¼Œå®šä¹‰äº†ï¼Œæ‰€æœ‰åˆ°Zuulçš„ä¸­è§„åˆ™ä¸ºï¼š/api-a-url/**çš„è®¿é—®éƒ½æ˜ å°„åˆ°<a href=\"http://localhost:2222/ä¸Šï¼Œ\" target=\"_blank\" rel=\"external\">http://localhost:2222/ä¸Šï¼Œ</a><br>ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬è®¿é—®<a href=\"http://localhost:5555/api-a-url/add?a=1&amp;b=2çš„æ—¶å€™ï¼ŒZuulä¼šå°†è¯¥è¯·æ±‚è·¯ç”±åˆ°ï¼š\" target=\"_blank\" rel=\"external\">http://localhost:5555/api-a-url/add?a=1&amp;b=2çš„æ—¶å€™ï¼ŒZuulä¼šå°†è¯¥è¯·æ±‚è·¯ç”±åˆ°ï¼š</a><br><a href=\"http://localhost:2222/add?a=1&amp;b=2ä¸Šã€‚\" target=\"_blank\" rel=\"external\">http://localhost:2222/add?a=1&amp;b=2ä¸Šã€‚</a></p>\n<h2 id=\"é€šè¿‡serviceIdçš„æ˜ å°„\"><a href=\"#é€šè¿‡serviceIdçš„æ˜ å°„\" class=\"headerlink\" title=\"é€šè¿‡serviceIdçš„æ˜ å°„\"></a>é€šè¿‡serviceIdçš„æ˜ å°„</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">zuul.routes.api-a.path=/api-a/**  </div><div class=\"line\">zuul.routes.api-a.serviceId=service-A</div><div class=\"line\"></div><div class=\"line\">zuul.routes.api-b.path=/api-b/**  </div><div class=\"line\">zuul.routes.api-b.serviceId=service-B</div></pre></td></tr></table></figure>\n<p>é€šè¿‡æµè§ˆå™¨å°±å¯ä»¥è®¿é—®äº†ã€‚å¦‚<a href=\"http://localhost:5555/api-b\" target=\"_blank\" rel=\"external\">http://localhost:5555/api-b</a></p>\n<h1 id=\"æœåŠ¡è¿‡æ»¤\"><a href=\"#æœåŠ¡è¿‡æ»¤\" class=\"headerlink\" title=\"æœåŠ¡è¿‡æ»¤\"></a>æœåŠ¡è¿‡æ»¤</h1><p>åœ¨å®Œæˆäº†æœåŠ¡è·¯ç”±ä¹‹åï¼Œæˆ‘ä»¬å¯¹å¤–å¼€æ”¾æœåŠ¡è¿˜éœ€è¦ä¸€äº›å®‰å…¨æªæ–½æ¥ä¿æŠ¤å®¢æˆ·ç«¯åªèƒ½è®¿é—®å®ƒåº”è¯¥è®¿é—®åˆ°çš„èµ„æºã€‚<br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨Zuulçš„è¿‡æ»¤å™¨æ¥å®ç°æˆ‘ä»¬å¯¹å¤–æœåŠ¡çš„å®‰å…¨æ§åˆ¶ã€‚<br>åœ¨æœåŠ¡ç½‘å…³ä¸­å®šä¹‰è¿‡æ»¤å™¨åªéœ€è¦ç»§æ‰¿ZuulFilteræŠ½è±¡ç±»å®ç°å…¶å®šä¹‰çš„å››ä¸ªæŠ½è±¡å‡½æ•°å°±å¯å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªä¸è¿‡æ»¤ã€‚</p>\n<p>è‡ªå®šä¹‰è¿‡æ»¤å™¨çš„å®ç°ï¼Œéœ€è¦ç»§æ‰¿ZuulFilterï¼Œéœ€è¦é‡å†™å®ç°ä¸‹é¢å››ä¸ªæ–¹æ³•ï¼š<br>filterTypeï¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ä»£è¡¨è¿‡æ»¤å™¨çš„ç±»å‹ï¼Œåœ¨zuulä¸­å®šä¹‰äº†å››ç§ä¸åŒç”Ÿå‘½å‘¨æœŸçš„è¿‡æ»¤å™¨ç±»å‹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š<br>    preï¼šå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±ä¹‹å‰è°ƒç”¨<br>    routingï¼šåœ¨è·¯ç”±è¯·æ±‚æ—¶å€™è¢«è°ƒç”¨<br>    postï¼šåœ¨routingå’Œerrorè¿‡æ»¤å™¨ä¹‹åè¢«è°ƒç”¨<br>    errorï¼šå¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯æ—¶è¢«è°ƒç”¨<br>filterOrderï¼šé€šè¿‡intå€¼æ¥å®šä¹‰è¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåº<br>shouldFilterï¼šè¿”å›ä¸€ä¸ªbooleanç±»å‹æ¥åˆ¤æ–­è¯¥è¿‡æ»¤å™¨æ˜¯å¦è¦æ‰§è¡Œï¼Œæ‰€ä»¥é€šè¿‡æ­¤å‡½æ•°å¯å®ç°è¿‡æ»¤å™¨çš„å¼€å…³ï¼Œé»˜è®¤falseï¼Œä¸æ‰§è¡Œ<br>runï¼šè¿‡æ»¤å™¨çš„å…·ä½“é€»è¾‘</p>\n<p>ç„¶ååœ¨ä¸»ç±»ä¸­æ³¨å…¥è¯¥ç±»<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">@Bean</div><div class=\"line\">public FilterTest filterTest() &#123;</div><div class=\"line\">\treturn new FilterTest();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>æœ€ååœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href=\"http://localhost:5555/api-b/add?a=1&amp;b=2å°±ä¸å¯ä»¥è®¿é—®ï¼Œ\" target=\"_blank\" rel=\"external\">http://localhost:5555/api-b/add?a=1&amp;b=2å°±ä¸å¯ä»¥è®¿é—®ï¼Œ</a><br>è€Œ<a href=\"http://localhost:5555/api-b/add?a=1&amp;b=2&amp;c=då¯ä»¥è®¿é—®äº†\" target=\"_blank\" rel=\"external\">http://localhost:5555/api-b/add?a=1&amp;b=2&amp;c=då¯ä»¥è®¿é—®äº†</a></p>\n<p>æ ¹æ®ä¹‹å‰å¯¹filterTypeç”Ÿå‘½å‘¨æœŸä»‹ç»ï¼Œå¯ä»¥å‚è€ƒä¸‹å›¾å»ç†è§£ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„éœ€è¦åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸä¸­å»å®ç°ä¸åŒç±»å‹çš„è¿‡æ»¤å™¨ã€‚<br><img src=\"/2016/08/25/Spring-CloudæœåŠ¡ç½‘å…³/zuul1.jpg\" alt=\"filterTypeç”Ÿå‘½å‘¨æœŸ\" title=\"filterTypeç”Ÿå‘½å‘¨æœŸ\"></p>\n<p>æ€»ç»“ï¼š<br>æœåŠ¡ç½‘å…³çš„ä¼˜ç‚¹ï¼š<br>ä¸ä»…ä»…å®ç°äº†è·¯ç”±åŠŸèƒ½æ¥å±è”½è¯¸å¤šæœåŠ¡ç»†èŠ‚ï¼Œæ›´å®ç°äº†æœåŠ¡çº§åˆ«ã€å‡è¡¡è´Ÿè½½çš„è·¯ç”±ã€‚<br>å®ç°äº†æ¥å£æƒé™æ ¡éªŒä¸å¾®æœåŠ¡ä¸šåŠ¡é€»è¾‘çš„è§£è€¦ã€‚é€šè¿‡æœåŠ¡ç½‘å…³ä¸­çš„è¿‡æ»¤å™¨ï¼Œåœ¨å„ç”Ÿå‘½å‘¨æœŸä¸­å»æ ¡éªŒè¯·æ±‚çš„å†…å®¹ï¼Œ<br>å°†åŸæœ¬åœ¨å¯¹å¤–æœåŠ¡å±‚åšçš„æ ¡éªŒå‰ç§»ï¼Œä¿è¯äº†å¾®æœåŠ¡çš„æ— çŠ¶æ€æ€§ï¼ŒåŒæ—¶é™ä½äº†å¾®æœåŠ¡çš„æµ‹è¯•éš¾åº¦ï¼Œ<br>è®©æœåŠ¡æœ¬èº«æ›´é›†ä¸­å…³æ³¨ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ã€‚<br>å®ç°äº†æ–­è·¯å™¨ï¼Œä¸ä¼šå› ä¸ºå…·ä½“å¾®æœåŠ¡çš„æ•…éšœè€Œå¯¼è‡´æœåŠ¡ç½‘å…³çš„é˜»å¡ï¼Œä¾ç„¶å¯ä»¥å¯¹å¤–æœåŠ¡ã€‚</p>\n"},{"title":"Spring Cloudåˆ†å¸ƒå¼é…ç½®","url":"https://yangzhiw.github.io/2016/08/24/Spring-Cloudåˆ†å¸ƒå¼é…ç½®/","content":"<p>Spring Cloud Configä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æä¾›äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤–éƒ¨åŒ–é…ç½®æ”¯æŒã€‚<br>é…ç½®æœåŠ¡å™¨ä¸ºå„åº”ç”¨çš„æ‰€æœ‰ç¯å¢ƒæä¾›äº†ä¸€ä¸ªä¸­å¿ƒåŒ–çš„å¤–éƒ¨é…ç½®ã€‚å®ƒå®ç°äº†å¯¹æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹Spring Environment<br>å’ŒPropertySourceæŠ½è±¡çš„æ˜ å°„ï¼Œæ‰€ä»¥å®ƒé™¤äº†é€‚ç”¨äºSpringæ„å»ºçš„åº”ç”¨ç¨‹åºï¼Œä¹Ÿå¯ä»¥åœ¨ä»»ä½•å…¶ä»–è¯­è¨€è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚<br>ä½œä¸ºä¸€ä¸ªåº”ç”¨å¯ä»¥é€šè¿‡éƒ¨ç½²ç®¡é“æ¥è¿›è¡Œæµ‹è¯•æˆ–è€…æŠ•å…¥ç”Ÿäº§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«ä¸ºè¿™äº›ç¯å¢ƒåˆ›å»ºé…ç½®ï¼Œ<br>å¹¶ä¸”åœ¨éœ€è¦è¿ç§»ç¯å¢ƒçš„æ—¶å€™è·å–å¯¹åº”ç¯å¢ƒçš„é…ç½®æ¥è¿è¡Œã€‚<br>é…ç½®æœåŠ¡å™¨é»˜è®¤é‡‡ç”¨gitæ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œè¿™æ ·å°±æœ‰åŠ©äºå¯¹ç¯å¢ƒé…ç½®è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡gitå®¢æˆ·ç«¯å·¥å…·æ¥æ–¹ä¾¿çš„<br>ç®¡ç†å’Œè®¿é—®é…ç½®å†…å®¹ã€‚å½“ç„¶ä»–ä¹Ÿæä¾›æœ¬åœ°åŒ–æ–‡ä»¶ç³»ç»Ÿçš„å­˜å‚¨æ–¹å¼ï¼Œä¸‹é¢ä»è¿™ä¸¤æ–¹é¢ä»‹ç»å¦‚ä½•ä½¿ç”¨åˆ†å¸ƒå¼é…ç½®æ¥å­˜å‚¨å¾®æœåŠ¡<br>åº”ç”¨å¤šç¯å¢ƒçš„é…ç½®å†…å®¹ã€‚</p>\n<h1 id=\"æ„å»ºConfig-Server\"><a href=\"#æ„å»ºConfig-Server\" class=\"headerlink\" title=\"æ„å»ºConfig Server\"></a>æ„å»ºConfig Server</h1><p>åœºæ™¯Spring Bootåˆå§‹é¡¹ç›®ï¼Œç„¶ååœ¨pom.xmlä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency<span class=\"string\">&gt;</span></div><div class=\"line\">         &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">         &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;</div><div class=\"line\">     &lt;/dependency&gt;</div><div class=\"line\">     &lt;dependencyManagement&gt;</div><div class=\"line\">     \t&lt;dependencies&gt;</div><div class=\"line\">         \t&lt;dependency&gt;</div><div class=\"line\">              &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">              &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">              &lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">              &lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">              &lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">         \t&lt;/dependency&gt;</div><div class=\"line\">    \t \t&lt;/dependencies&gt;</div><div class=\"line\">    &lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure></p>\n<p>åœ¨Spring Bootä¸»ç±»ä¸­æ·»åŠ @EnableConfigServeræ³¨è§£ï¼Œå¼€å¯config-serveråŠŸèƒ½<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">@EnableConfigServer</div><div class=\"line\">@SpringBootApplication</div><div class=\"line\">public class Application &#123;</div><div class=\"line\"></div><div class=\"line\">    public static void main(String[] args) &#123;</div><div class=\"line\">        new SpringApplicationBuilder(Application.class).web(<span class=\"literal\">true</span>).run(args);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>åœ¨application.propertiesä¸­é…ç½®æœåŠ¡ä¿¡æ¯ä»¥åŠgitä¿¡æ¯ï¼Œå¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">spring.application.name=config-server</div><div class=\"line\">server.port=<span class=\"number\">7001</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># gitç®¡ç†é…ç½®</span></div><div class=\"line\">spring.cloud.config.server.git.uri=https://github.com/yangzhiw/Simple-Spring-Cloud</div><div class=\"line\">spring.cloud.config.server.git.searchPaths=config-repo</div><div class=\"line\">spring.cloud.config.server.git.username=username</div><div class=\"line\">spring.cloud.config.server.git.password=password</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># å¼€å¯æœ¬åœ°é…ç½®</span></div><div class=\"line\"><span class=\"comment\"># spring.profiles.active=native</span></div></pre></td></tr></table></figure></p>\n<p>spring.cloud.config.server.git.uriï¼šé…ç½®gitä»“åº“ä½ç½®<br>spring.cloud.config.server.git.searchPathsï¼šé…ç½®ä»“åº“è·¯å¾„ä¸‹çš„ç›¸å¯¹æœç´¢ä½ç½®ï¼Œå¯ä»¥é…ç½®å¤šä¸ª<br>spring.cloud.config.server.git.usernameï¼šè®¿é—®gitä»“åº“çš„ç”¨æˆ·å<br>spring.cloud.config.server.git.passwordï¼šè®¿é—®gitä»“åº“çš„ç”¨æˆ·å¯†ç </p>\n<p>Spring Cloud Configä¹Ÿæä¾›æœ¬åœ°å­˜å‚¨é…ç½®çš„æ–¹å¼ã€‚æˆ‘ä»¬åªéœ€è¦è®¾ç½®å±æ€§spring.profiles.active=nativeï¼Œ<br>Config Serverä¼šé»˜è®¤ä»åº”ç”¨çš„src/main/resourceç›®å½•ä¸‹æ£€ç´¢é…ç½®æ–‡ä»¶ã€‚ä¹Ÿå¯ä»¥é€šè¿‡<br>spring.cloud.config.server.native.searchLocations=file:D:/properties/å±æ€§æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚<br>è™½ç„¶Spring Cloud Configæä¾›äº†è¿™æ ·çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸ºäº†æ”¯æŒæ›´å¥½çš„ç®¡ç†å†…å®¹å’Œç‰ˆæœ¬æ§åˆ¶çš„åŠŸèƒ½ï¼Œ<br>è¿˜æ˜¯æ¨èä½¿ç”¨gitçš„æ–¹å¼</p>\n<h1 id=\"æœåŠ¡ç«¯éªŒè¯\"><a href=\"#æœåŠ¡ç«¯éªŒè¯\" class=\"headerlink\" title=\"æœåŠ¡ç«¯éªŒè¯\"></a>æœåŠ¡ç«¯éªŒè¯</h1><p>åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªconfig-repoæ–‡ä»¶å¤¹ï¼Œé…ç½®äº†å››ä¸ªé…ç½®æ–‡ä»¶<br>é…ç½®æ–‡ä»¶åˆ†åˆ«ä¸ºï¼š<br>juzi.properties<br>juzi-dev.properties<br>juzi-test.properties<br>juzi-prod.properties<br>å¯ä»¥åœ¨å››ä¸ªé…ç½®æ–‡ä»¶ä¸­è®¾ç½®å±æ€§</p>\n<h2 id=\"URLä¸é…ç½®æ–‡ä»¶çš„æ˜ å°„å…³ç³»å¦‚ä¸‹ï¼š\"><a href=\"#URLä¸é…ç½®æ–‡ä»¶çš„æ˜ å°„å…³ç³»å¦‚ä¸‹ï¼š\" class=\"headerlink\" title=\"URLä¸é…ç½®æ–‡ä»¶çš„æ˜ å°„å…³ç³»å¦‚ä¸‹ï¼š\"></a>URLä¸é…ç½®æ–‡ä»¶çš„æ˜ å°„å…³ç³»å¦‚ä¸‹ï¼š</h2><p>/{application}/{profile}[/{label}]<br>/{application}-{profile}.yml<br>/{label}/{application}-{profile}.yml<br>/{application}-{profile}.properties<br>/{label}/{application}-{profile}.properties<br>ä¸Šé¢çš„urlä¼šæ˜ å°„{application}-{profile}.propertieså¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œ{label}å¯¹åº”gitä¸Šä¸åŒçš„åˆ†æ”¯ï¼Œé»˜è®¤ä¸ºmasterã€‚<br>ç„¶åæˆ‘ä»¬å°±å¯è®¿é—®æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶äº†ã€‚å¦‚ï¼š<a href=\"http://localhost:7001/juzi/prod/\" target=\"_blank\" rel=\"external\">http://localhost:7001/juzi/prod/</a><br>è¿™ä¾¿æ˜¯è®¿é—®ç”Ÿæˆç¯å¢ƒçš„é…ç½®æ–‡ä»¶ã€‚</p>\n<h1 id=\"æœåŠ¡ç«¯é…ç½®æ˜ å°„\"><a href=\"#æœåŠ¡ç«¯é…ç½®æ˜ å°„\" class=\"headerlink\" title=\"æœåŠ¡ç«¯é…ç½®æ˜ å°„\"></a>æœåŠ¡ç«¯é…ç½®æ˜ å°„</h1><p>åœ¨å®Œæˆå¹¶éªŒè¯äº†é…ç½®æœåŠ¡ä¸­å¿ƒä¹‹åï¼Œä¸‹é¢çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•åœ¨å¾®æœåŠ¡åº”ç”¨ä¸­è·å–é…ç½®ä¿¡æ¯ã€‚</p>\n<p>åˆ›å»ºä¸€ä¸ªSpring Bootåº”ç”¨ï¼Œåœ¨pom.xmlä¸­å¼•å…¥spring-cloud-starter-configä¾èµ–ï¼Œå®Œæ•´ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"> </div><div class=\"line\">&lt;dependency<span class=\"string\">&gt;</span></div><div class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;</div><div class=\"line\">&lt;/dependency&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;dependencyManagement&gt;</div><div class=\"line\">    &lt;dependencies&gt;</div><div class=\"line\">        &lt;dependency&gt;</div><div class=\"line\">            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">            &lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">            &lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">            &lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">        &lt;/dependency&gt;</div><div class=\"line\">    &lt;/dependencies&gt;</div><div class=\"line\">&lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure></p>\n<p>åˆ›å»ºbootstrap.propertiesé…ç½®ï¼Œæ¥æŒ‡å®šconfig serverï¼Œä¾‹å¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">spring.application.name=didispace  </div><div class=\"line\">spring.cloud.config.profile=dev  </div><div class=\"line\">spring.cloud.config.label=master  </div><div class=\"line\">spring.cloud.config.uri=http://localhost:<span class=\"number\">7001</span>/</div><div class=\"line\"></div><div class=\"line\">server.port=<span class=\"number\">7002</span></div></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œéœ€è¦æ ¼å¤–æ³¨æ„ï¼šä¸Šé¢è¿™äº›å±æ€§å¿…é¡»é…ç½®åœ¨bootstrap.propertiesä¸­ï¼Œconfigéƒ¨åˆ†å†…å®¹æ‰èƒ½è¢«æ­£ç¡®åŠ è½½ã€‚<br>å› ä¸ºconfigçš„ç›¸å…³é…ç½®ä¼šå…ˆäºapplication.propertiesï¼Œ<br>è€Œbootstrap.propertiesçš„åŠ è½½ä¹Ÿæ˜¯å…ˆäºapplication.propertiesã€‚</p>\n<p> è¿™é‡Œéœ€è¦æ ¼å¤–æ³¨æ„ï¼šä¸Šé¢è¿™äº›å±æ€§å¿…é¡»é…ç½®åœ¨bootstrap.propertiesä¸­ï¼Œconfigéƒ¨åˆ†å†…å®¹æ‰èƒ½è¢«æ­£ç¡®åŠ è½½ã€‚<br> å› ä¸ºconfigçš„ç›¸å…³é…ç½®ä¼šå…ˆäºapplication.propertiesï¼Œ<br> è€Œbootstrap.propertiesçš„åŠ è½½ä¹Ÿæ˜¯å…ˆäºapplication.propertiesã€‚<br> <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"> @RefreshScope</div><div class=\"line\">@RestController</div><div class=\"line\">class TestController &#123;</div><div class=\"line\"></div><div class=\"line\">    @Value(<span class=\"string\">\"$&#123;from&#125;\"</span>)</div><div class=\"line\">    private String from;</div><div class=\"line\"></div><div class=\"line\">    @RequestMapping(<span class=\"string\">\"/from\"</span>)</div><div class=\"line\">    public String from() &#123;</div><div class=\"line\"></div><div class=\"line\">        return this.from;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>é€šè¿‡@Value(â€œ${from}â€)ç»‘å®šé…ç½®æœåŠ¡ä¸­é…ç½®çš„fromå±æ€§ã€‚</p>\n<p>å¯åŠ¨è¯¥åº”ç”¨ï¼Œå¹¶è®¿é—®ï¼š<a href=\"http://localhost:7002/from\" target=\"_blank\" rel=\"external\">http://localhost:7002/from</a> ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é…ç½®å†…å®¹è¾“å‡ºå¯¹åº”ç¯å¢ƒçš„fromå†…å®¹äº†ã€‚</p>\n"},{"title":"Spring Cloudè·¯æ–­å™¨","url":"https://yangzhiw.github.io/2016/08/24/Spring-Cloudè·¯æ–­å™¨/","content":"<h1 id=\"ä»€ä¹ˆæ˜¯æ–­è·¯å™¨\"><a href=\"#ä»€ä¹ˆæ˜¯æ–­è·¯å™¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ–­è·¯å™¨\"></a>ä»€ä¹ˆæ˜¯æ–­è·¯å™¨</h1><p>æ–­è·¯å™¨æ¨¡å¼æºäºMartin Fowlerçš„Circuit Breakerä¸€æ–‡ã€‚â€œæ–­è·¯å™¨â€æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œç”¨äºåœ¨ç”µè·¯ä¸Šä¿æŠ¤çº¿è·¯è¿‡è½½ï¼Œ<br>å½“çº¿è·¯ä¸­æœ‰ç”µå™¨å‘ç”ŸçŸ­è·¯æ—¶ï¼Œâ€œæ–­è·¯å™¨â€èƒ½å¤ŸåŠæ—¶çš„åˆ‡æ–­æ•…éšœç”µè·¯ï¼Œé˜²æ­¢å‘ç”Ÿè¿‡è½½ã€å‘çƒ­ã€ç”šè‡³èµ·ç«ç­‰ä¸¥é‡åæœã€‚</p>\n<p>åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼Œæ–­è·¯å™¨æ¨¡å¼çš„ä½œç”¨ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœï¼ˆç±»ä¼¼ç”¨ç”µå™¨å‘ç”ŸçŸ­è·¯ï¼‰ä¹‹åï¼Œ<br>é€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªé”™è¯¯å“åº”ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…ã€‚<br>è¿™æ ·å°±ä¸ä¼šä½¿å¾—çº¿ç¨‹å› è°ƒç”¨æ•…éšœæœåŠ¡è¢«é•¿æ—¶é—´å ç”¨ä¸é‡Šæ”¾ï¼Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶.</p>\n<h1 id=\"Netflix-Hystrix\"><a href=\"#Netflix-Hystrix\" class=\"headerlink\" title=\"Netflix Hystrix\"></a>Netflix Hystrix</h1><p>åœ¨Spring Cloudä¸­ä½¿ç”¨äº†Hystrix æ¥å®ç°æ–­è·¯å™¨çš„åŠŸèƒ½ã€‚Hystrixæ˜¯Netflixå¼€æºçš„å¾®æœåŠ¡æ¡†æ¶å¥—ä»¶ä¹‹ä¸€ï¼Œ<br>è¯¥æ¡†æ¶ç›®æ ‡åœ¨äºé€šè¿‡æ§åˆ¶é‚£äº›è®¿é—®è¿œç¨‹ç³»ç»Ÿã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ›ã€‚<br>Hystrixå…·å¤‡æ‹¥æœ‰å›é€€æœºåˆ¶å’Œæ–­è·¯å™¨åŠŸèƒ½çš„çº¿ç¨‹å’Œä¿¡å·éš”ç¦»ï¼Œè¯·æ±‚ç¼“å­˜å’Œè¯·æ±‚æ‰“åŒ…ï¼Œä»¥åŠç›‘æ§å’Œé…ç½®ç­‰åŠŸèƒ½ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Hystrixã€‚</p>\n<h2 id=\"å‡†å¤‡å·¥ä½œ\"><a href=\"#å‡†å¤‡å·¥ä½œ\" class=\"headerlink\" title=\"å‡†å¤‡å·¥ä½œ\"></a>å‡†å¤‡å·¥ä½œ</h2><p>å¯åŠ¨spring-couldï¼Œspring-cloud-provide,eureka-ribboné¡¹ç›®</p>\n<p>pom.xmlä¸­å¼•å…¥ä¾èµ–hystrixä¾èµ–<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency<span class=\"string\">&gt;  </span></div><div class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>\n<p>åœ¨eureka-ribbonçš„ä¸»ç±»RibbonApplicationä¸­ä½¿ç”¨@EnableCircuitBreakeræ³¨è§£å¼€å¯æ–­è·¯å™¨åŠŸèƒ½<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">@SpringBootApplication</div><div class=\"line\">@EnableDiscoveryClient</div><div class=\"line\">@EnableCircuitBreaker</div><div class=\"line\">public class EurekaRibbonApplication &#123;</div></pre></td></tr></table></figure></p>\n<p>æ–°å¢ä¹Ÿserviceç±»<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">@Service</div><div class=\"line\">public class SimpleService &#123;</div><div class=\"line\">    @Autowired</div><div class=\"line\">    RestTemplate restTemplate;</div><div class=\"line\"></div><div class=\"line\">    @HystrixCommand(fallbackMethod = <span class=\"string\">\"addServiceFallback\"</span>)</div><div class=\"line\">    public String addService() &#123;</div><div class=\"line\">        return restTemplate.getForEntity(<span class=\"string\">\"http://COMPUTE-SERVICE/add?a=10&amp;b=20\"</span>, String.class).getBody();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    public String addServiceFallback() &#123;</div><div class=\"line\">        return <span class=\"string\">\"error\"</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>æ”¹å˜ä¹‹å‰Controllerä¸­çš„æ–¹æ³•ä½¿å…¶æ‰ç”¨Serviceä¸­çš„addServiceå³å¯ï¼Œæ²¡å¼€æœåŠ¡å¯ä»¥å‘ç°æµè§ˆå™¨ä¸­è¿”å›äº†erroré”™è¯¯äº†ã€‚<br>å®Œæˆ</p>\n"},{"title":"Spring CloudæœåŠ¡æ¶ˆè´¹è€…","url":"https://yangzhiw.github.io/2016/08/24/Spring-CloudæœåŠ¡æ¶ˆè´¹è€…/","content":"<h1 id=\"Ribbon\"><a href=\"#Ribbon\" class=\"headerlink\" title=\"Ribbon\"></a>Ribbon</h1><p>Ribbonæ˜¯ä¸€ä¸ªåŸºäºHTTPå’ŒTCPçš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ã€‚<br>Ribbonå¯ä»¥åœ¨é€šè¿‡å®¢æˆ·ç«¯ä¸­é…ç½®çš„ribbonServerListæœåŠ¡ç«¯åˆ—è¡¨å»è½®è¯¢è®¿é—®ä»¥è¾¾åˆ°å‡è¡¡è´Ÿè½½çš„ä½œç”¨ã€‚</p>\n<p>1.å¯åŠ¨ä¹‹å‰çš„spring-could<br>2.å¯åŠ¨æœåŠ¡æä¾›æ–¹spring-cloud-provide</p>\n<p>ä¿®æ”¹spring-cloud-provideä¸­çš„server-portä¸º2223ï¼Œå†å¯åŠ¨ä¸€ä¸ªæœåŠ¡æä¾›æ–¹ï¼šservice</p>\n<h1 id=\"ä½¿ç”¨Ribbonå®ç°å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ¶ˆè´¹è€…\"><a href=\"#ä½¿ç”¨Ribbonå®ç°å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ¶ˆè´¹è€…\" class=\"headerlink\" title=\"ä½¿ç”¨Ribbonå®ç°å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ¶ˆè´¹è€…\"></a>ä½¿ç”¨Ribbonå®ç°å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ¶ˆè´¹è€…</h1><p>åœ¨pom.xmlä¸­æ·»åŠ <br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency<span class=\"string\">&gt;</span></div><div class=\"line\">       &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">       &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt;</div><div class=\"line\">   &lt;/dependency&gt;</div><div class=\"line\">   &lt;dependency&gt;</div><div class=\"line\">       &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">       &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</div><div class=\"line\">   &lt;/dependency&gt;</div><div class=\"line\">   &lt;dependencyManagement&gt;  </div><div class=\"line\">    &lt;dependencies&gt;</div><div class=\"line\">        &lt;dependency&gt;</div><div class=\"line\">\t        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">\t        &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">\t        &lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">\t        &lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">\t        &lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">    \t&lt;/dependency&gt;</div><div class=\"line\">    &lt;/dependencies&gt;</div><div class=\"line\">&lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure></p>\n<p>åœ¨åº”ç”¨ä¸»ç±»ä¸­ï¼Œé€šè¿‡@EnableDiscoveryClientæ³¨è§£æ¥æ·»åŠ å‘ç°æœåŠ¡èƒ½åŠ›ã€‚<br>åˆ›å»ºRestTemplateå®ä¾‹ï¼Œå¹¶é€šè¿‡@LoadBalancedæ³¨è§£å¼€å¯å‡è¡¡è´Ÿè½½èƒ½åŠ›ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">@SpringBootApplication</div><div class=\"line\">@EnableDiscoveryClient</div><div class=\"line\">public class RibbonApplication &#123;</div><div class=\"line\"></div><div class=\"line\">    @Bean</div><div class=\"line\">    @LoadBalanced</div><div class=\"line\">    RestTemplate restTemplate() &#123;</div><div class=\"line\">        return new RestTemplate();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    public static void main(String[] args) &#123;</div><div class=\"line\">        SpringApplication.run(RibbonApplication.class, args);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>åˆ›å»ºConsumerControlleræ¥æ¶ˆè´¹COMPUTE-SERVICEçš„addæœåŠ¡ã€‚<br>é€šè¿‡ç›´æ¥RestTemplateæ¥è°ƒç”¨æœåŠ¡ï¼Œè®¡ç®—10 + 20çš„å€¼ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">@RestController</div><div class=\"line\">public class ConsumerController &#123;</div><div class=\"line\"></div><div class=\"line\">    @Autowired</div><div class=\"line\">    RestTemplate restTemplate;</div><div class=\"line\"></div><div class=\"line\">    @RequestMapping(value = <span class=\"string\">\"/add\"</span>, method = RequestMethod.GET)</div><div class=\"line\">    public String add() &#123;</div><div class=\"line\">        return restTemplate.getForEntity(<span class=\"string\">\"http://COMPUTE-SERVICE/add?a=10&amp;b=20\"</span>, String.class).getBody();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>application.propertiesä¸­é…ç½®eurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">spring.application.name=ribbon-consumer  </div><div class=\"line\">server.port=<span class=\"number\">3333</span></div><div class=\"line\"></div><div class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:<span class=\"number\">1111</span>/eureka/</div></pre></td></tr></table></figure></p>\n<p>ç„¶åå¯åŠ¨è¯¥é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href=\"http://localhost:3333/add\" target=\"_blank\" rel=\"external\">http://localhost:3333/add</a><br>åœ¨2222å’Œ2223çš„ç«¯å£æ€»èƒ½çœ‹åˆ°æœ‰å…¶ä¸­ä¸€ä¸ªæ§åˆ¶å°æœ‰æ—¥å¿—æ‰“å‡ºï¼Œå…³é—­ä¸€ä¸ªï¼Œè¿˜èƒ½ç»§ç»­è¿è¡Œ<br>å³é€šè¿‡ribbonå®ç°äº†è´Ÿè½½å‡è¡¡äº†ã€‚</p>\n"},{"title":"Spring CloudæœåŠ¡æ³¨å†Œä¸å‘ç°","url":"https://yangzhiw.github.io/2016/08/23/Spring-CloudæœåŠ¡æ³¨å†Œä¸å‘ç°/","content":"<h1 id=\"Spring-Cloudç®€ä»‹\"><a href=\"#Spring-Cloudç®€ä»‹\" class=\"headerlink\" title=\"Spring Cloudç®€ä»‹\"></a>Spring Cloudç®€ä»‹</h1><p>Spring Cloudæ˜¯ä¸€ä¸ªåŸºäºSpring Bootå®ç°çš„äº‘åº”ç”¨å¼€å‘å·¥å…·ï¼Œå®ƒä¸ºåŸºäºJVMçš„äº‘åº”ç”¨å¼€å‘ä¸­çš„é…ç½®ç®¡ç†ã€<br>æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æ§åˆ¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯å’Œé›†ç¾¤çŠ¶æ€ç®¡ç†ç­‰æ“ä½œæä¾›äº†ä¸€ç§ç®€<br>Spring CloudåŒ…å«äº†å¤šä¸ªå­é¡¹ç›®ï¼ˆé’ˆå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ¶‰åŠçš„å¤šä¸ªä¸åŒå¼€æºäº§å“ï¼‰ï¼Œæ¯”å¦‚ï¼šSpring Cloud Configã€<br>Spring Cloud Netflixã€Spring Cloud CloudFoundryã€Spring Cloud AWSã€Spring Cloud Securityã€Spring Cloud Commonsã€<br>pring Cloud Zookeeperã€Spring Cloud CLIç­‰é¡¹ç›®ã€‚</p>\n<h1 id=\"å¾®æœåŠ¡æ¶æ„\"><a href=\"#å¾®æœåŠ¡æ¶æ„\" class=\"headerlink\" title=\"å¾®æœåŠ¡æ¶æ„\"></a>å¾®æœåŠ¡æ¶æ„</h1><p>â€œå¾®æœåŠ¡æ¶æ„â€åœ¨è¿™å‡ å¹´éå¸¸çš„ç«çƒ­ï¼Œä»¥è‡³äºå…³äºå¾®æœåŠ¡æ¶æ„ç›¸å…³çš„äº§å“ç¤¾åŒºä¹Ÿå˜å¾—è¶Šæ¥è¶Šæ´»è·ƒï¼ˆæ¯”å¦‚ï¼šnetflixã€dubboï¼‰ï¼Œ<br>Spring Cloudä¹Ÿå› Springç¤¾åŒºçš„å¼ºå¤§çŸ¥ååº¦å’Œå½±å“åŠ›ä¹Ÿè¢«å¹¿å¤§æ¶æ„å¸ˆä¸å¼€å‘è€…å¤‡å—å…³æ³¨ã€‚</p>\n<h1 id=\"æœåŠ¡æ³¨å†Œä¸å‘ç°\"><a href=\"#æœåŠ¡æ³¨å†Œä¸å‘ç°\" class=\"headerlink\" title=\"æœåŠ¡æ³¨å†Œä¸å‘ç°\"></a>æœåŠ¡æ³¨å†Œä¸å‘ç°</h1><p>è¿™é‡Œç”¨åˆ°Spring Cloud Netflixï¼Œè¯¥é¡¹ç›®æ˜¯Spring Cloudçš„å­é¡¹ç›®ä¹‹ä¸€ï¼Œä¸»è¦å†…å®¹æ˜¯å¯¹Netflixå…¬å¸ä¸€ç³»åˆ—å¼€æºäº§å“çš„åŒ…è£…ï¼Œ<br> å®ƒä¸ºSpring Bootåº”ç”¨æä¾›äº†è‡ªé…ç½®çš„Netflix OSSæ•´åˆã€‚é€šè¿‡ä¸€äº›ç®€å•çš„æ³¨è§£ï¼Œå¼€å‘è€…å°±å¯ä»¥å¿«é€Ÿçš„åœ¨åº”ç”¨ä¸­é…ç½®ä¸€ä¸‹å¸¸ç”¨<br> æ¨¡å—å¹¶æ„å»ºåºå¤§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å®ƒä¸»è¦æä¾›çš„æ¨¡å—åŒ…æ‹¬ï¼šæœåŠ¡å‘ç°ï¼ˆEurekaï¼‰ï¼Œæ–­è·¯å™¨ï¼ˆHystrixï¼‰ï¼Œæ™ºèƒ½è·¯ç”±ï¼ˆZuulï¼‰ï¼Œ<br> å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼ˆRibbonï¼‰ç­‰ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œçš„æ ¸å¿ƒå†…å®¹å°±æ˜¯æœåŠ¡å‘ç°æ¨¡å—ï¼šEurekaã€‚ä¸‹é¢æˆ‘ä»¬åŠ¨æ‰‹æ¥åšä¸€äº›å°è¯•ã€‚</p>\n<h2 id=\"åˆ›å»ºâ€œæœåŠ¡æ³¨å†Œä¸­å¿ƒâ€\"><a href=\"#åˆ›å»ºâ€œæœåŠ¡æ³¨å†Œä¸­å¿ƒâ€\" class=\"headerlink\" title=\"åˆ›å»ºâ€œæœåŠ¡æ³¨å†Œä¸­å¿ƒâ€\"></a>åˆ›å»ºâ€œæœåŠ¡æ³¨å†Œä¸­å¿ƒâ€</h2><p>åˆ›å»ºä¸€ä¸ªåŸºç¡€çš„Spring Bootå·¥ç¨‹ï¼Œå¹¶åœ¨pom.xmlä¸­å¼•å…¥éœ€è¦çš„ä¾èµ–å†…å®¹ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div></pre></td><td class=\"code\"><pre><div class=\"line\">\t&lt;parent<span class=\"string\">&gt;</span></div><div class=\"line\">\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</div><div class=\"line\">\t\t&lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class=\"line\">\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</div><div class=\"line\">\t&lt;/parent&gt;</div><div class=\"line\"></div><div class=\"line\">\t&lt;dependencies&gt;  </div><div class=\"line\">\t    &lt;dependency&gt;</div><div class=\"line\">\t        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">\t    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</div><div class=\"line\">\t    &lt;scope&gt;test&lt;/scope&gt;</div><div class=\"line\">\t    &lt;/dependency&gt;</div><div class=\"line\"></div><div class=\"line\">\t    &lt;dependency&gt;</div><div class=\"line\">\t        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">\t    &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;</div><div class=\"line\">\t    &lt;/dependency&gt;</div><div class=\"line\">\t&lt;/dependencies&gt;</div><div class=\"line\">\t&lt;dependencyManagement&gt;  </div><div class=\"line\">\t    &lt;dependencies&gt;</div><div class=\"line\">\t        &lt;dependency&gt;</div><div class=\"line\">\t        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">\t        &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">\t        &lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">\t        &lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">\t        &lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">\t    &lt;/dependency&gt;</div><div class=\"line\">    &lt;/dependencies&gt;</div><div class=\"line\">&lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure>\n<p>é€šè¿‡@EnableEurekaServeræ³¨è§£å¯åŠ¨ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒæä¾›ç»™å…¶ä»–åº”ç”¨è¿›è¡Œå¯¹è¯ã€‚<br>è¿™ä¸€æ­¥éå¸¸çš„ç®€å•ï¼Œåªéœ€è¦åœ¨ä¸€ä¸ªæ™®é€šçš„Spring Bootåº”ç”¨ä¸­æ·»åŠ è¿™ä¸ªæ³¨è§£å°±èƒ½å¼€å¯æ­¤åŠŸèƒ½ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">@SpringBootApplication</div><div class=\"line\">@EnableEurekaServer</div><div class=\"line\">public class SpringCloudApplication &#123;</div><div class=\"line\"></div><div class=\"line\">\tpublic static void main(String[] args) &#123;</div><div class=\"line\">\t\tSpringApplication.run(SpringCloudApplication.class, args);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>åœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼Œè¯¥æœåŠ¡æ³¨å†Œä¸­å¿ƒä¹Ÿä¼šå°†è‡ªå·±ä½œä¸ºå®¢æˆ·ç«¯æ¥å°è¯•æ³¨å†Œå®ƒè‡ªå·±ï¼Œ<br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¦ç”¨å®ƒçš„å®¢æˆ·ç«¯æ³¨å†Œè¡Œä¸ºï¼Œåªéœ€è¦åœ¨application.propertiesä¸­é—®å¢åŠ å¦‚ä¸‹é…ç½®ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">server.port=<span class=\"number\">11111</span></div><div class=\"line\"></div><div class=\"line\">eureka.client.register-with-eureka=<span class=\"literal\">false</span>  </div><div class=\"line\">eureka.client.fetch-registry=<span class=\"literal\">false</span>  </div><div class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:$&#123;server.port&#125;/eureka/</div></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼š<a href=\"http://localhost:11111\" target=\"_blank\" rel=\"external\">http://localhost:11111</a><br>å¯ä»¥çœ‹åˆ°æ³¨å†Œä¸­å¿ƒå·²ç»å¯åŠ¨äº†</p>\n<h1 id=\"åˆ›å»ºæœåŠ¡æä¾›æ–¹\"><a href=\"#åˆ›å»ºæœåŠ¡æä¾›æ–¹\" class=\"headerlink\" title=\"åˆ›å»ºæœåŠ¡æä¾›æ–¹\"></a>åˆ›å»ºæœåŠ¡æä¾›æ–¹</h1><p>ç°åœ¨ æä¾›è®¡ç®—åŠŸèƒ½çš„å¾®æœåŠ¡æ¨¡å—ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªRESTful APIï¼Œé€šè¿‡ä¼ å…¥ä¸¤ä¸ªå‚æ•°aå’Œbï¼Œæœ€åè¿”å›a + bçš„ç»“æœã€‚</p>\n<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„Spring Bootåº”ç”¨ï¼Œåœ¨pom.xmlä¸­ï¼ŒåŠ å…¥å¦‚ä¸‹é…ç½®ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;parent<span class=\"string\">&gt;</span></div><div class=\"line\">\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</div><div class=\"line\">\t\t&lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class=\"line\">\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</div><div class=\"line\">&lt;/parent&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&lt;dependencies&gt;  </div><div class=\"line\">    &lt;dependency&gt;</div><div class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</div><div class=\"line\">    &lt;scope&gt;test&lt;/scope&gt;</div><div class=\"line\">    &lt;/dependency&gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;dependency&gt;</div><div class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</div><div class=\"line\">    &lt;/dependency&gt;</div><div class=\"line\">&lt;/dependencies&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;dependencyManagement&gt;  </div><div class=\"line\">    &lt;dependencies&gt;</div><div class=\"line\">        &lt;dependency&gt;</div><div class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class=\"line\">        &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</div><div class=\"line\">        &lt;version&gt;Brixton.RELEASE&lt;/version&gt;</div><div class=\"line\">        &lt;type&gt;pom&lt;/type&gt;</div><div class=\"line\">        &lt;scope&gt;import&lt;/scope&gt;</div><div class=\"line\">    &lt;/dependency&gt;</div><div class=\"line\">    &lt;/dependencies&gt;</div><div class=\"line\">&lt;/dependencyManagement&gt;</div></pre></td></tr></table></figure></p>\n<p>å…¶æ¬¡ï¼Œå®ç°/addè¯·æ±‚å¤„ç†æ¥å£ï¼Œé€šè¿‡DiscoveryClientå¯¹è±¡ï¼Œåœ¨æ—¥å¿—ä¸­æ‰“å°å‡ºæœåŠ¡å®ä¾‹çš„ç›¸å…³å†…å®¹ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">@RestController</div><div class=\"line\">public class ComputeController &#123;</div><div class=\"line\"></div><div class=\"line\">    private final Logger logger = LoggerFactory.getLogger(getClass());</div><div class=\"line\"></div><div class=\"line\">    @Autowired</div><div class=\"line\">    private DiscoveryClient client;</div><div class=\"line\"></div><div class=\"line\">    @RequestMapping(value = <span class=\"string\">\"/add\"</span> ,method = RequestMethod.GET)</div><div class=\"line\">    public Integer add(@RequestParam Integer a, @RequestParam Integer b) &#123;</div><div class=\"line\">        ServiceInstance instance = client.getLocalServiceInstance();</div><div class=\"line\">        Integer r = a + b;</div><div class=\"line\">        logger.info(<span class=\"string\">\"/add, host:\"</span> + instance.getHost() + <span class=\"string\">\", service_id:\"</span> + instance.getServiceId() + <span class=\"string\">\", result:\"</span> + r);</div><div class=\"line\">        return r;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>æœ€ååœ¨ä¸»ç±»ä¸­é€šè¿‡åŠ ä¸Š@EnableDiscoveryClientæ³¨è§£ï¼Œ<br>è¯¥æ³¨è§£èƒ½æ¿€æ´»Eurekaä¸­çš„DiscoveryClientå®ç°ï¼Œæ‰èƒ½å®ç°Controllerä¸­å¯¹æœåŠ¡ä¿¡æ¯çš„è¾“å‡ºã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">@SpringBootApplication</div><div class=\"line\">@EnableDiscoveryClient</div><div class=\"line\">public class SpringCloudProvideApplication &#123;</div><div class=\"line\"></div><div class=\"line\">\tpublic static void main(String[] args) &#123;</div><div class=\"line\">\t\tSpringApplication.run(SpringCloudProvideApplication.class, args);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>application.propertiesçš„é…ç½®<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">spring.application.name=compute-service</div><div class=\"line\"></div><div class=\"line\">server.port=<span class=\"number\">2222</span></div><div class=\"line\"></div><div class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:<span class=\"number\">11111</span>/eureka/</div></pre></td></tr></table></figure></p>\n<p>é€šè¿‡spring.application.nameå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå¾®æœåŠ¡çš„åç§°åç»­åœ¨è°ƒç”¨çš„æ—¶å€™åªéœ€è¦ä½¿ç”¨è¯¥åç§°å°±å¯ä»¥è¿›è¡ŒæœåŠ¡çš„è®¿é—®ã€‚</p>\n<p>eureka.client.serviceUrl.defaultZoneå±æ€§å¯¹åº”æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„é…ç½®å†…å®¹ï¼ŒæŒ‡å®šæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„ä½ç½®ã€‚</p>\n<p>ä¸ºäº†åœ¨æœ¬æœºä¸Šæµ‹è¯•åŒºåˆ†æœåŠ¡æä¾›æ–¹å’ŒæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä½¿ç”¨server.portå±æ€§è®¾ç½®ä¸åŒçš„ç«¯å£ã€‚<br>å¯åŠ¨è¯¥å·¥ç¨‹åï¼Œå†æ¬¡è®¿é—®ï¼š<a href=\"http://localhost:11111/\" target=\"_blank\" rel=\"external\">http://localhost:11111/</a></p>\n"},{"title":"Kafkaå…¥é—¨","url":"https://yangzhiw.github.io/2016/08/23/Kafkarå…¥é—¨/","content":"<h1 id=\"åŸºç¡€çŸ¥è¯†\"><a href=\"#åŸºç¡€çŸ¥è¯†\" class=\"headerlink\" title=\"åŸºç¡€çŸ¥è¯†\"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id=\"ä»‹ç»\"><a href=\"#ä»‹ç»\" class=\"headerlink\" title=\"ä»‹ç»\"></a>ä»‹ç»</h2><p>Kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€å¯åˆ†åŒºçš„ã€å¯å¤åˆ¶çš„æ¶ˆæ¯ç³»ç»Ÿã€‚å®ƒæä¾›äº†æ™®é€šæ¶ˆæ¯ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œä½†å…·æœ‰è‡ªå·±ç‹¬ç‰¹çš„è®¾è®¡ã€‚<br>é¦–å…ˆè®©æˆ‘ä»¬çœ‹å‡ ä¸ªåŸºæœ¬çš„æ¶ˆæ¯ç³»ç»Ÿæœ¯è¯­ï¼š<br>Kafkaå°†æ¶ˆæ¯ä»¥topicä¸ºå•ä½è¿›è¡Œå½’çº³ã€‚<br>å°†å‘Kafka topicå‘å¸ƒæ¶ˆæ¯çš„ç¨‹åºæˆä¸ºproducers.<br>å°†é¢„è®¢topicså¹¶æ¶ˆè´¹æ¶ˆæ¯çš„ç¨‹åºæˆä¸ºconsumer.<br>Kafkaä»¥é›†ç¾¤çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡ç»„æˆï¼Œæ¯ä¸ªæœåŠ¡å«åšä¸€ä¸ªbroker.<br><img src=\"/2016/08/23/Kafkarå…¥é—¨/kafka1.jpg\" alt=\"kafakæ¶æ„\" title=\"kafakæ¶æ„\"></p>\n<h2 id=\"åˆ†å¸ƒå¼\"><a href=\"#åˆ†å¸ƒå¼\" class=\"headerlink\" title=\"åˆ†å¸ƒå¼\"></a>åˆ†å¸ƒå¼</h2><p>æ¯ä¸ªåˆ†åŒºåœ¨Kafkaé›†ç¾¤çš„è‹¥å¹²æœåŠ¡ä¸­éƒ½æœ‰å‰¯æœ¬ï¼Œè¿™æ ·è¿™äº›æŒæœ‰å‰¯æœ¬çš„æœåŠ¡å¯ä»¥å…±åŒå¤„ç†æ•°æ®å’Œè¯·æ±‚ï¼Œå‰¯æœ¬æ•°é‡æ˜¯å¯ä»¥é…ç½®çš„ã€‚å‰¯æœ¬ä½¿Kafkaå…·å¤‡äº†å®¹é”™èƒ½åŠ›ã€‚<br>æ¯ä¸ªåˆ†åŒºéƒ½ç”±ä¸€ä¸ªæœåŠ¡å™¨ä½œä¸ºâ€œleaderâ€ï¼Œé›¶æˆ–è‹¥å¹²æœåŠ¡å™¨ä½œä¸ºâ€œfollowersâ€,leaderè´Ÿè´£å¤„ç†æ¶ˆæ¯çš„è¯»å’Œå†™ï¼Œfollowersåˆ™å»å¤åˆ¶leader.å¦‚æœleader downäº†ï¼Œ<br>followersä¸­çš„ä¸€å°åˆ™ä¼šè‡ªåŠ¨æˆä¸ºleaderã€‚é›†ç¾¤ä¸­çš„æ¯ä¸ªæœåŠ¡éƒ½ä¼šåŒæ—¶æ‰®æ¼”ä¸¤ä¸ªè§’è‰²ï¼š<br>ä½œä¸ºå®ƒæ‰€æŒæœ‰çš„ä¸€éƒ¨åˆ†åˆ†åŒºçš„leaderï¼ŒåŒæ—¶ä½œä¸ºå…¶ä»–åˆ†åŒºçš„followersï¼Œè¿™æ ·é›†ç¾¤å°±ä¼šæ®æœ‰è¾ƒå¥½çš„è´Ÿè½½å‡è¡¡ã€‚</p>\n<h2 id=\"Producers\"><a href=\"#Producers\" class=\"headerlink\" title=\"Producers\"></a>Producers</h2><p>Producerå°†æ¶ˆæ¯å‘å¸ƒåˆ°å®ƒæŒ‡å®šçš„topicä¸­,å¹¶è´Ÿè´£å†³å®šå‘å¸ƒåˆ°å“ªä¸ªåˆ†åŒºã€‚é€šå¸¸ç®€å•çš„ç”±è´Ÿè½½å‡è¡¡æœºåˆ¶éšæœºé€‰æ‹©åˆ†åŒºï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡ç‰¹å®šçš„åˆ†åŒºå‡½æ•°é€‰æ‹©åˆ†åŒºã€‚<br>ä½¿ç”¨çš„æ›´å¤šçš„æ˜¯ç¬¬äºŒç§ã€‚</p>\n<h2 id=\"Consumers\"><a href=\"#Consumers\" class=\"headerlink\" title=\"Consumers\"></a>Consumers</h2><p>å‘å¸ƒæ¶ˆæ¯é€šå¸¸æœ‰ä¸¤ç§æ¨¡å¼ï¼šé˜Ÿåˆ—æ¨¡å¼ï¼ˆqueuingï¼‰å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼(publish-subscribe)ã€‚é˜Ÿåˆ—æ¨¡å¼ä¸­ï¼Œconsumerså¯ä»¥åŒæ—¶ä»æœåŠ¡ç«¯è¯»å–<br>æ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆæ¯åªè¢«å…¶ä¸­ä¸€ä¸ªconsumerè¯»åˆ°ï¼›å‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¸­æ¶ˆæ¯è¢«å¹¿æ’­åˆ°æ‰€æœ‰çš„consumerä¸­ã€‚Consumerså¯ä»¥åŠ å…¥ä¸€ä¸ªconsumer<br>ç»„ï¼Œå…±åŒç«äº‰ä¸€ä¸ªtopicï¼Œtopicä¸­çš„æ¶ˆæ¯å°†è¢«åˆ†å‘åˆ°ç»„ä¸­çš„ä¸€ä¸ªæˆå‘˜ä¸­ã€‚åŒä¸€ç»„ä¸­çš„consumerå¯ä»¥åœ¨ä¸åŒçš„ç¨‹åºä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„<br>æœºå™¨ä¸Šã€‚å¦‚æœæ‰€æœ‰çš„consumeréƒ½åœ¨ä¸€ä¸ªç»„ä¸­ï¼Œè¿™å°±æˆä¸ºäº†ä¼ ç»Ÿçš„é˜Ÿåˆ—æ¨¡å¼ï¼Œåœ¨å„consumerä¸­å®ç°è´Ÿè½½å‡è¡¡ã€‚å¦‚æœæ‰€æœ‰çš„consumer<br>ä¸åœ¨ä¸åŒçš„ç»„ä¸­ï¼Œè¿™å°±æˆä¸ºäº†å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œæ‰€æœ‰çš„æ¶ˆæ¯éƒ½è¢«åˆ†å‘åˆ°æ‰€æœ‰çš„consumerä¸­ã€‚æ›´å¸¸è§çš„æ˜¯ï¼Œæ¯ä¸ªtopicéƒ½æœ‰è‹¥å¹²æ•°é‡<br>çš„consumerç»„ï¼Œæ¯ä¸ªç»„éƒ½æ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„â€œè®¢é˜…è€…â€ï¼Œä¸ºäº†å®¹é”™å’Œæ›´å¥½çš„ç¨³å®šæ€§ï¼Œæ¯ä¸ªç»„ç”±è‹¥å¹²consumerç»„æˆã€‚è¿™å…¶å®å°±æ˜¯ä¸€ä¸ª<br>å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œåªä¸è¿‡è®¢é˜…è€…æ˜¯ä¸ªç»„è€Œä¸æ˜¯å•ä¸ªconsumerã€‚<br><img src=\"/2016/08/23/Kafkarå…¥é—¨/kafka2.jpg\" alt=\"kafakxæ¶ˆè´¹ç»„\" title=\"kafakxæ¶ˆè´¹ç»„\"><br>ç”±ä¸¤ä¸ªæœºå™¨ç»„æˆçš„é›†ç¾¤æ‹¥æœ‰4ä¸ªåˆ†åŒº (P0-P3) 2ä¸ªconsumerç»„. Aç»„æœ‰ä¸¤ä¸ªconsumerBç»„æœ‰4ä¸ª<br>ç›¸æ¯”ä¼ ç»Ÿçš„æ¶ˆæ¯ç³»ç»Ÿï¼ŒKafkaå¯ä»¥å¾ˆå¥½çš„ä¿è¯æœ‰åºæ€§ã€‚<br>ä¼ ç»Ÿçš„é˜Ÿåˆ—åœ¨æœåŠ¡å™¨ä¸Šä¿å­˜æœ‰åºçš„æ¶ˆæ¯ï¼Œå¦‚æœå¤šä¸ªconsumersåŒæ—¶ä»è¿™ä¸ªæœåŠ¡å™¨æ¶ˆè´¹æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨å°±ä¼šä»¥æ¶ˆæ¯å­˜å‚¨çš„é¡ºåºå‘<br>consumeråˆ†å‘æ¶ˆæ¯ã€‚è™½ç„¶æœåŠ¡å™¨æŒ‰é¡ºåºå‘å¸ƒæ¶ˆæ¯ï¼Œä½†æ˜¯æ¶ˆæ¯æ˜¯è¢«å¼‚æ­¥çš„åˆ†å‘åˆ°å„consumerä¸Šï¼Œæ‰€ä»¥å½“æ¶ˆæ¯åˆ°è¾¾æ—¶å¯èƒ½å·²ç»å¤±å»äº†<br>åŸæ¥çš„é¡ºåºï¼Œè¿™æ„å‘³ç€å¹¶å‘æ¶ˆè´¹å°†å¯¼è‡´é¡ºåºé”™ä¹±ã€‚ä¸ºäº†é¿å…æ•…éšœï¼Œè¿™æ ·çš„æ¶ˆæ¯ç³»ç»Ÿé€šå¸¸ä½¿ç”¨â€œä¸“ç”¨consumerâ€çš„æ¦‚å¿µï¼Œå…¶å®å°±æ˜¯<br>åªå…è®¸ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯ï¼Œå½“ç„¶è¿™å°±æ„å‘³ç€å¤±å»äº†å¹¶å‘æ€§ã€‚<br>åœ¨è¿™æ–¹é¢Kafkaåšçš„æ›´å¥½ï¼Œé€šè¿‡åˆ†åŒºçš„æ¦‚å¿µï¼ŒKafkaå¯ä»¥åœ¨å¤šä¸ªconsumerç»„å¹¶å‘çš„æƒ…å†µä¸‹æä¾›è¾ƒå¥½çš„æœ‰åºæ€§å’Œè´Ÿè½½å‡è¡¡ã€‚<br>å°†æ¯ä¸ªåˆ†åŒºåˆ†åªåˆ†å‘ç»™ä¸€ä¸ªconsumerç»„ï¼Œè¿™æ ·ä¸€ä¸ªåˆ†åŒºå°±åªè¢«è¿™ä¸ªç»„çš„ä¸€ä¸ªconsumeræ¶ˆè´¹ï¼Œå°±å¯ä»¥é¡ºåºçš„æ¶ˆè´¹è¿™ä¸ªåˆ†åŒºçš„æ¶ˆæ¯ã€‚<br>ä¸ºæœ‰å¤šä¸ªåˆ†åŒºï¼Œä¾ç„¶å¯ä»¥åœ¨å¤šä¸ªconsumerç»„ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚æ³¨æ„consumerç»„çš„æ•°é‡ä¸èƒ½å¤šäºåˆ†åŒºçš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯æœ‰å¤šå°‘<br>åˆ†åŒºå°±å…è®¸å¤šå°‘å¹¶å‘æ¶ˆè´¹ã€‚<br>Kafkaåªèƒ½ä¿è¯ä¸€ä¸ªåˆ†åŒºä¹‹å†…æ¶ˆæ¯çš„æœ‰åºæ€§ï¼Œåœ¨ä¸åŒçš„åˆ†åŒºä¹‹é—´æ˜¯ä¸å¯ä»¥çš„ï¼Œè¿™å·²ç»å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨çš„éœ€æ±‚ã€‚<br>å¦‚æœéœ€è¦topicä¸­æ‰€æœ‰æ¶ˆæ¯çš„æœ‰åºæ€§ï¼Œé‚£å°±åªèƒ½è®©è¿™ä¸ªtopicåªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œå½“ç„¶ä¹Ÿå°±åªæœ‰ä¸€ä¸ªconsumerç»„æ¶ˆè´¹å®ƒã€‚</p>\n<h1 id=\"ç¯å¢ƒæ­å»º\"><a href=\"#ç¯å¢ƒæ­å»º\" class=\"headerlink\" title=\"ç¯å¢ƒæ­å»º\"></a>ç¯å¢ƒæ­å»º</h1><h2 id=\"ä¸‹è½½å¹¶è§£å‹\"><a href=\"#ä¸‹è½½å¹¶è§£å‹\" class=\"headerlink\" title=\"ä¸‹è½½å¹¶è§£å‹\"></a>ä¸‹è½½å¹¶è§£å‹</h2><p>ä»<a href=\"http://kafka.apache.org/downloads.html\" target=\"_blank\" rel=\"external\">å®˜ç½‘</a>é€‰æ‹©ä¸‹è½½æœ€æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶<br>è§£å‹<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">tar -vxzf kafka_2<span class=\"number\">.11</span><span class=\"bullet\">-0.10</span><span class=\"number\">.0</span><span class=\"number\">.1</span>.tgz</div><div class=\"line\">cd kafka_2<span class=\"number\">.11</span><span class=\"bullet\">-0.10</span><span class=\"number\">.0</span><span class=\"number\">.1</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"å¯åŠ¨\"><a href=\"#å¯åŠ¨\" class=\"headerlink\" title=\"å¯åŠ¨\"></a>å¯åŠ¨</h2><p>1.å¯åŠ¨zookeeper<br>2.å¯åŠ¨kafka<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-server-start.sh config/server.properties</div></pre></td></tr></table></figure></p>\n<p>3.åˆ›å»ºtopic<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">ä½¿ç”¨kafka-topics.sh åˆ›å»ºå•åˆ†åŒºå•å‰¯æœ¬çš„topic testï¼š</div><div class=\"line\">bin/kafka-topics.sh --create --zookeeper localhost:<span class=\"number\">2181</span> --replication-factor <span class=\"number\">1</span> --partitions <span class=\"number\">1</span> --topic test</div><div class=\"line\">æŸ¥çœ‹</div><div class=\"line\">bin/kafka-topics.sh --list --zookeeper localhost:<span class=\"number\">2181</span></div><div class=\"line\">test</div></pre></td></tr></table></figure></p>\n<p>4.äº§ç”Ÿæ¶ˆæ¯<br>ä½¿ç”¨kafka-console-producer.sh å‘é€æ¶ˆæ¯ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-console-producer.sh --broker-list localhost:<span class=\"number\">9092</span> --topic test </div><div class=\"line\">Hello worldï¼</div><div class=\"line\">Hello Kafkaï¼</div></pre></td></tr></table></figure></p>\n<p>æŒ‰Ctrl+Cé€€å‡º<br>5.æ¶ˆè´¹æ¶ˆæ¯<br>ä½¿ç”¨kafka-console-consumer.sh æ¥æ”¶æ¶ˆæ¯å¹¶åœ¨ç»ˆç«¯æ‰“å°ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-console-consumer.sh --zookeeper localhost:<span class=\"number\">2181</span> --topic test --from-beginning</div><div class=\"line\">Hello world!</div><div class=\"line\">Hello Kafka!</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h1 id=\"é›†ç¾¤éƒ¨ç½²\"><a href=\"#é›†ç¾¤éƒ¨ç½²\" class=\"headerlink\" title=\"é›†ç¾¤éƒ¨ç½²\"></a>é›†ç¾¤éƒ¨ç½²</h1><h2 id=\"å•æœºå¤šbroker-é›†ç¾¤é…ç½®\"><a href=\"#å•æœºå¤šbroker-é›†ç¾¤é…ç½®\" class=\"headerlink\" title=\"å•æœºå¤šbroker é›†ç¾¤é…ç½®\"></a>å•æœºå¤šbroker é›†ç¾¤é…ç½®</h2><p>åˆ©ç”¨å•èŠ‚ç‚¹éƒ¨ç½²å¤šä¸ªbrokerã€‚ ä¸åŒçš„broker è®¾ç½®ä¸åŒçš„ idï¼Œç›‘å¬ç«¯å£åŠæ—¥å¿—ç›®å½•ã€‚ ä¾‹å¦‚ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp config/server.properties config/server<span class=\"bullet\">-1.</span>properties </div><div class=\"line\">cp config/server.properties config/server<span class=\"bullet\">-2.</span>properties</div></pre></td></tr></table></figure></p>\n<p>ç¼–è¾‘é…ç½®<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">config/server<span class=\"bullet\">-1.</span>properties:</div><div class=\"line\">    broker.id=<span class=\"number\">1</span></div><div class=\"line\">    port=<span class=\"number\">9093</span></div><div class=\"line\">    log.dir=/tmp/kafka-logs<span class=\"bullet\">-1</span></div><div class=\"line\">config/server<span class=\"bullet\">-2.</span>properties:</div><div class=\"line\">    broker.id=<span class=\"number\">2</span></div><div class=\"line\">    port=<span class=\"number\">9094</span></div><div class=\"line\">    log.dir=/tmp/kafka-logs<span class=\"bullet\">-2</span></div></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨KafkaæœåŠ¡ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-server-start.sh config/server<span class=\"bullet\">-1.</span>properties &amp;</div><div class=\"line\">bin/kafka-server-start.sh config/server<span class=\"bullet\">-2.</span>properties &amp;</div></pre></td></tr></table></figure></p>\n<p>åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰3ä¸ªå‰¯æœ¬çš„topic:<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-topics.sh --create --zookeeper localhost:<span class=\"number\">2181</span> --replication-factor <span class=\"number\">3</span> --partitions <span class=\"number\">1</span> --topic my-replicated-topic</div></pre></td></tr></table></figure></p>\n<p>ç°åœ¨æˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªé›†ç¾¤ï¼Œæ€ä¹ˆçŸ¥é“æ¯ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯å‘¢ï¼Ÿè¿è¡Œâ€œdescribe topicsâ€å‘½ä»¤å°±å¯ä»¥äº†ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-topics.sh --describe --zookeeper localhost:<span class=\"number\">2181</span> --topic my-replicated-topic</div><div class=\"line\"></div><div class=\"line\">æ˜¾ç¤º</div><div class=\"line\"><span class=\"attr\">Topic:</span>my-replicated-topic       PartitionCount:<span class=\"number\">1</span>        ReplicationFactor:<span class=\"number\">3</span>     Configs:</div><div class=\"line\"><span class=\"attr\">        Topic:</span> my-replicated-topic      Partition: <span class=\"number\">0</span>    Leader: <span class=\"number\">1</span>       Replicas: <span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">0</span> Isr: <span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">0</span></div></pre></td></tr></table></figure></p>\n<p>ä¸‹é¢è§£é‡Šä¸€ä¸‹è¿™äº›è¾“å‡ºã€‚ç¬¬ä¸€è¡Œæ˜¯å¯¹æ‰€æœ‰åˆ†åŒºçš„ä¸€ä¸ªæè¿°ï¼Œç„¶åæ¯ä¸ªåˆ†åŒºéƒ½ä¼šå¯¹åº”ä¸€è¡Œï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªåˆ†åŒºæ‰€ä»¥ä¸‹é¢å°±åªåŠ äº†ä¸€è¡Œã€‚<br>leaderï¼šè´Ÿè´£å¤„ç†æ¶ˆæ¯çš„è¯»å’Œå†™ï¼Œleaderæ˜¯ä»æ‰€æœ‰èŠ‚ç‚¹ä¸­éšæœºé€‰æ‹©çš„.<br>replicasï¼šåˆ—å‡ºäº†æ‰€æœ‰çš„å‰¯æœ¬èŠ‚ç‚¹ï¼Œä¸ç®¡èŠ‚ç‚¹æ˜¯å¦åœ¨æœåŠ¡ä¸­.<br>isrï¼šæ˜¯æ­£åœ¨æœåŠ¡ä¸­çš„èŠ‚ç‚¹.<br>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒèŠ‚ç‚¹1æ˜¯ä½œä¸ºleaderè¿è¡Œã€‚<br>å‘topicå‘é€æ¶ˆæ¯ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-console-producer.sh --broker-list localhost:<span class=\"number\">9092</span> --topic my-replicated-topic</div></pre></td></tr></table></figure></p>\n<p>my test message 1<br>my test message 2<br>æ¶ˆè´¹è€…æ¥å—è¿™äº›æ¶ˆæ¯<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt; bin/kafka-console-consumer.sh --zookeeper localhost:<span class=\"number\">2181</span> --from-beginning --topic my-replicated-topic</div></pre></td></tr></table></figure></p>\n<p>æµ‹è¯•ä¸€ä¸‹å®¹é”™èƒ½åŠ›.Broker 1ä½œä¸ºleaderè¿è¡Œï¼Œç°åœ¨æˆ‘ä»¬killæ‰å®ƒï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt; ps | grep server<span class=\"bullet\">-1.</span>properties7564 ttys002    <span class=\"number\">0</span>:<span class=\"number\">15.91</span> /System/Library/Frameworks/JavaVM.framework/Versions/<span class=\"number\">1.6</span>/Home/bin/java...</div><div class=\"line\">&gt; kill <span class=\"bullet\">-9</span> <span class=\"number\">7564</span></div></pre></td></tr></table></figure></p>\n<p>å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹è¢«é€‰åšäº†leader,node 1 ä¸å†å‡ºç°åœ¨ in-sync å‰¯æœ¬åˆ—è¡¨ä¸­ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">bin/kafka-topics.sh --describe --zookeeper localhost:<span class=\"number\">218192</span> --topic my-replicated-topic</div><div class=\"line\"><span class=\"attr\">Topic:</span>my-replicated-topic       PartitionCount:<span class=\"number\">1</span>        ReplicationFactor:<span class=\"number\">3</span>     Configs:</div><div class=\"line\"><span class=\"attr\">        Topic:</span> my-replicated-topic      Partition: <span class=\"number\">0</span>    Leader: <span class=\"number\">2</span>       Replicas: <span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">0</span> Isr: <span class=\"number\">2</span>,<span class=\"number\">0</span></div></pre></td></tr></table></figure></p>\n<p>è™½ç„¶æœ€åˆè´Ÿè´£ç»­å†™æ¶ˆæ¯çš„leader downæ‰äº†ï¼Œä½†ä¹‹å‰çš„æ¶ˆæ¯è¿˜æ˜¯å¯ä»¥æ¶ˆè´¹çš„.</p>\n<h2 id=\"å¤šæœºå¤šbroker-é›†ç¾¤é…ç½®\"><a href=\"#å¤šæœºå¤šbroker-é›†ç¾¤é…ç½®\" class=\"headerlink\" title=\"å¤šæœºå¤šbroker é›†ç¾¤é…ç½®\"></a>å¤šæœºå¤šbroker é›†ç¾¤é…ç½®</h2><p>åˆ†åˆ«åœ¨å¤šä¸ªèŠ‚ç‚¹æŒ‰ä¸Šè¿°æ–¹å¼å®‰è£…Kafkaï¼Œé…ç½®å¯åŠ¨å¤šä¸ªZookeeper å®ä¾‹ã€‚<br>ä¾‹å¦‚ï¼š åœ¨10.4.253.22ï¼Œ10.4.253.23ï¼Œ10.4.253.24ä¸‰å°æœºå™¨éƒ¨ç½²ï¼ŒZookeeperé…ç½®å¦‚ä¸‹ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">initLimit=<span class=\"number\">5</span></div><div class=\"line\">syncLimit=<span class=\"number\">2</span></div><div class=\"line\">server<span class=\"number\">.1</span>=<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.22</span>:<span class=\"number\">2888</span>:<span class=\"number\">3888</span></div><div class=\"line\">server<span class=\"number\">.2</span>=<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.23</span>:<span class=\"number\">2888</span>:<span class=\"number\">3888</span></div><div class=\"line\">server<span class=\"number\">.3</span>=<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.24</span>:<span class=\"number\">2888</span>:<span class=\"number\">3888</span></div></pre></td></tr></table></figure></p>\n<p>åˆ†åˆ«é…ç½®å¤šä¸ªæœºå™¨ä¸Šçš„KafkaæœåŠ¡ è®¾ç½®ä¸åŒçš„broke idï¼Œzookeeper.connectè®¾ç½®å¦‚ä¸‹:<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">zookeeper.connect=<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.22</span>:<span class=\"number\">2181</span>,<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.23</span>:<span class=\"number\">2181</span>,<span class=\"number\">10.4</span><span class=\"number\">.253</span><span class=\"number\">.24</span>:<span class=\"number\">2181</span></div></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨Zookeeperä¸KafkaæœåŠ¡ï¼ŒæŒ‰ä¸Šæ–‡æ–¹å¼äº§ç”Ÿå’Œæ¶ˆè´¹æ¶ˆæ¯ï¼ŒéªŒè¯é›†ç¾¤åŠŸèƒ½(æœ¬äººæœªéªŒè¯)ã€‚</p>\n"},{"title":"ä½¿ç”¨Redisåšé›†ä¸­å¼ç¼“å­˜","url":"https://yangzhiw.github.io/2016/08/19/ä½¿ç”¨Redisåšé›†ä¸­å¼ç¼“å­˜/","content":""},{"title":"Sporing Bootä¸­ä½¿ç”¨log4jè®°å½•æ—¥å¿—","url":"https://yangzhiw.github.io/2016/08/19/Bootä¸­ä½¿ç”¨log4jè®°å½•æ—¥å¿—/","content":"<h1 id=\"å¼•å…¥log4jä¾èµ–\"><a href=\"#å¼•å…¥log4jä¾èµ–\" class=\"headerlink\" title=\"å¼•å…¥log4jä¾èµ–\"></a>å¼•å…¥log4jä¾èµ–</h1><p>åœ¨åˆ›å»ºSpring Bootå·¥ç¨‹æ—¶ï¼Œæˆ‘ä»¬å¼•å…¥äº†spring-boot-starterï¼Œå…¶ä¸­åŒ…å«äº†spring-boot-starter-loggingï¼Œè¯¥ä¾èµ–å†…å®¹å°±æ˜¯<br>Spring Booté»˜è®¤çš„æ—¥å¿—æ¡†æ¶Logbackï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å¼•å…¥log4jä¹‹å‰ï¼Œéœ€è¦å…ˆæ’é™¤è¯¥åŒ…çš„ä¾èµ–ï¼Œå†å¼•å…¥log4jçš„ä¾èµ–ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency<span class=\"string\">&gt;  </span></div><div class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</div><div class=\"line\">    &lt;exclusions&gt;</div><div class=\"line\">        &lt;exclusion&gt; </div><div class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;</div><div class=\"line\">        &lt;/exclusion&gt;</div><div class=\"line\">    &lt;/exclusions&gt;</div><div class=\"line\">&lt;/dependency&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;dependency&gt;  </div><div class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-boot-starter-log4j&lt;/artifactId&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>\n<h1 id=\"é…ç½®log4j-properties\"><a href=\"#é…ç½®log4j-properties\" class=\"headerlink\" title=\"é…ç½®log4j.properties\"></a>é…ç½®log4j.properties</h1><p>åœ¨å¼•å…¥äº†log4jä¾èµ–ä¹‹åï¼Œåªéœ€è¦åœ¨src/main/resourcesç›®å½•ä¸‹åŠ å…¥log4j.propertiesé…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥å¼€å§‹å¯¹åº”ç”¨çš„æ—¥å¿—è¿›è¡Œé…ç½®ä½¿ç”¨ã€‚</p>\n<h2 id=\"æ§åˆ¶å°è¾“å‡º\"><a href=\"#æ§åˆ¶å°è¾“å‡º\" class=\"headerlink\" title=\"æ§åˆ¶å°è¾“å‡º\"></a>æ§åˆ¶å°è¾“å‡º</h2><p>é€šè¿‡å¦‚ä¸‹é…ç½®ï¼Œè®¾å®šrootæ—¥å¿—çš„è¾“å‡ºçº§åˆ«ä¸ºINFOï¼Œappenderä¸ºæ§åˆ¶å°è¾“å‡ºstdout</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># LOG4Jé…ç½®</span></div><div class=\"line\">log4j.rootCategory=INFO, stdout</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># æ§åˆ¶å°è¾“å‡º</span></div><div class=\"line\">\tlog4j.appender.stdout=org.apache.log4j.ConsoleAppender  </div><div class=\"line\">\tlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout  </div><div class=\"line\">\tlog4j.appender.stdout.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %<span class=\"number\">5</span>p %c&#123;<span class=\"number\">1</span>&#125;:%L - %m%n</div></pre></td></tr></table></figure>\n<h2 id=\"è¾“å‡ºåˆ°æ–‡ä»¶\"><a href=\"#è¾“å‡ºåˆ°æ–‡ä»¶\" class=\"headerlink\" title=\"è¾“å‡ºåˆ°æ–‡ä»¶\"></a>è¾“å‡ºåˆ°æ–‡ä»¶</h2><p>åœ¨å¼€å‘ç¯å¢ƒï¼Œæˆ‘ä»¬åªæ˜¯è¾“å‡ºåˆ°æ§åˆ¶å°æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯åˆ°äº†ç”Ÿäº§æˆ–æµ‹è¯•ç¯å¢ƒï¼Œæˆ–è®¸æŒä¹…åŒ–æ—¥å¿—å†…å®¹ï¼Œæ–¹ä¾¿è¿½æº¯é—®é¢˜åŸå› ã€‚<br>å¯ä»¥é€šè¿‡æ·»åŠ å¦‚ä¸‹çš„appenderå†…å®¹ï¼ŒæŒ‰å¤©è¾“å‡ºåˆ°ä¸åŒçš„æ–‡ä»¶ä¸­å»ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸ºlog4j.rootCategoryæ·»åŠ åä¸ºfileçš„appenderï¼Œ<br>è¿™æ ·rootæ—¥å¿—å°±å¯ä»¥è¾“å‡ºåˆ°logs/all.logæ–‡ä»¶ä¸­äº†ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\">log4j.rootCategory=INFO, stdout, file</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># rootæ—¥å¿—è¾“å‡º</span></div><div class=\"line\">log4j.appender.file=org.apache.log4j.DailyRollingFileAppender  </div><div class=\"line\">log4j.appender.file.file=logs/all.log  </div><div class=\"line\">log4j.appender.file.DatePattern=<span class=\"string\">'.'</span>yyyy-MM-dd  </div><div class=\"line\">log4j.appender.file.layout=org.apache.log4j.PatternLayout  </div><div class=\"line\">log4j.appender.file.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %<span class=\"number\">5</span>p %c&#123;<span class=\"number\">1</span>&#125;:%L - %m%n</div></pre></td></tr></table></figure></p>\n<h2 id=\"åˆ†ç±»è¾“å‡º\"><a href=\"#åˆ†ç±»è¾“å‡º\" class=\"headerlink\" title=\"åˆ†ç±»è¾“å‡º\"></a>åˆ†ç±»è¾“å‡º</h2><p>1.å¯ä»¥æŒ‰ä¸åŒpackageè¿›è¡Œè¾“å‡ºã€‚é€šè¿‡å®šä¹‰è¾“å‡ºåˆ°logs/my.logçš„appenderï¼Œå¹¶å¯¹com.didispaceåŒ…ä¸‹çš„æ—¥å¿—çº§åˆ«è®¾å®š<br>ä¸ºDEBUGçº§åˆ«ã€appenderè®¾ç½®ä¸ºè¾“å‡ºåˆ°logs/my.logçš„åä¸ºdidifileçš„appenderã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># com.juziåŒ…ä¸‹çš„æ—¥å¿—é…ç½®</span></div><div class=\"line\">log4j.category.com.juzi=DEBUG, didifile</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># com.didispaceä¸‹çš„æ—¥å¿—è¾“å‡º</span></div><div class=\"line\">log4j.appender.didifile=org.apache.log4j.DailyRollingFileAppender  </div><div class=\"line\">log4j.appender.didifile.file=logs/my.log  </div><div class=\"line\">log4j.appender.didifile.DatePattern=<span class=\"string\">'.'</span>yyyy-MM-dd  </div><div class=\"line\">log4j.appender.didifile.layout=org.apache.log4j.PatternLayout  </div><div class=\"line\">log4j.appender.didifile.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %<span class=\"number\">5</span>p %c&#123;<span class=\"number\">1</span>&#125;:%L ---- %m%n</div></pre></td></tr></table></figure></p>\n<p>å¯ä»¥å¯¹ä¸åŒçº§åˆ«è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚å¯¹ERRORçº§åˆ«è¾“å‡ºåˆ°ç‰¹å®šçš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå…·ä½“é…ç½®å¯ä»¥å¦‚ä¸‹ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">og4j.logger.error=errorfile  </div><div class=\"line\"><span class=\"comment\"># erroræ—¥å¿—è¾“å‡º</span></div><div class=\"line\">log4j.appender.errorfile=org.apache.log4j.DailyRollingFileAppender  </div><div class=\"line\">log4j.appender.errorfile.file=logs/error.log  </div><div class=\"line\">log4j.appender.errorfile.DatePattern=<span class=\"string\">'.'</span>yyyy-MM-dd  </div><div class=\"line\">log4j.appender.errorfile.Threshold = ERROR  </div><div class=\"line\">log4j.appender.errorfile.layout=org.apache.log4j.PatternLayout  </div><div class=\"line\">log4j.appender.errorfile.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; %<span class=\"number\">5</span>p %c&#123;<span class=\"number\">1</span>&#125;:%L - %m%n</div></pre></td></tr></table></figure></p>\n"},{"title":"Spring Bootæ—¥å¿—ç®¡ç†","url":"https://yangzhiw.github.io/2016/08/19/Bootæ—¥å¿—ç®¡ç†/","content":"<p>Spring Bootåœ¨æ‰€æœ‰å†…éƒ¨æ—¥å¿—ä¸­ä½¿ç”¨Commons Loggingï¼Œä½†æ˜¯é»˜è®¤é…ç½®ä¹Ÿæä¾›äº†å¯¹å¸¸ç”¨æ—¥å¿—çš„æ”¯æŒï¼Œ<br>å¦‚ï¼šJava Util Loggingï¼ŒLog4J, Log4J2å’ŒLogbackã€‚æ¯ç§Loggeréƒ½å¯ä»¥é€šè¿‡é…ç½®ä½¿ç”¨æ§åˆ¶å°æˆ–è€…æ–‡ä»¶è¾“å‡ºæ—¥å¿—å†…å®¹ã€‚</p>\n<h1 id=\"æ—¥å¿—è¾“å‡ºæ ¼å¼\"><a href=\"#æ—¥å¿—è¾“å‡ºæ ¼å¼\" class=\"headerlink\" title=\"æ—¥å¿—è¾“å‡ºæ ¼å¼\"></a>æ—¥å¿—è¾“å‡ºæ ¼å¼</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">2016</span><span class=\"bullet\">-08</span><span class=\"bullet\">-19</span> <span class=\"number\">10</span>:<span class=\"number\">22</span>:<span class=\"number\">04.233</span>  INFO <span class=\"number\">7368</span> --- [           main] com.juzi.AsyncTest                       : Started AsyncTest in <span class=\"number\">10.084</span> seconds (JVM running for <span class=\"number\">12.545</span>)</div></pre></td></tr></table></figure>\n<p>è¾“å‡ºå†…å®¹å…ƒç´ å…·ä½“å¦‚ä¸‹ï¼š</p>\n<p>æ—¶é—´æ—¥æœŸ â€” ç²¾ç¡®åˆ°æ¯«ç§’<br>æ—¥å¿—çº§åˆ« â€” ERROR, WARN, INFO, DEBUG or TRACE<br>è¿›ç¨‹ID<br>åˆ†éš”ç¬¦ â€” â€” æ ‡è¯†å®é™…æ—¥å¿—çš„å¼€å§‹<br>çº¿ç¨‹å â€” æ–¹æ‹¬å·æ‹¬èµ·æ¥ï¼ˆå¯èƒ½ä¼šæˆªæ–­æ§åˆ¶å°è¾“å‡ºï¼‰<br>Loggerå â€” é€šå¸¸ä½¿ç”¨æºä»£ç çš„ç±»å<br>æ—¥å¿—å†…å®¹</p>\n<h1 id=\"æ§åˆ¶å°è¾“å‡º\"><a href=\"#æ§åˆ¶å°è¾“å‡º\" class=\"headerlink\" title=\"æ§åˆ¶å°è¾“å‡º\"></a>æ§åˆ¶å°è¾“å‡º</h1><p>åœ¨Spring Bootä¸­é»˜è®¤é…ç½®äº†ERRORã€WARNå’ŒINFOçº§åˆ«çš„æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼åˆ‡æ¢è‡³DEBUGçº§åˆ«ï¼š<br>1.åœ¨è¿è¡Œå‘½ä»¤ååŠ å…¥â€“debugæ ‡å¿—ï¼Œå¦‚ï¼š$ java -jar myapp.jar â€“debug<br>2.åœ¨application.propertiesä¸­é…ç½®debug=trueï¼Œè¯¥å±æ€§ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œæ ¸å¿ƒLoggerï¼ˆåŒ…å«åµŒå…¥å¼å®¹å™¨ã€hibernateã€springï¼‰<br>ä¼šè¾“å‡ºæ›´å¤šå†…å®¹ï¼Œä½†æ˜¯ä½ è‡ªå·±åº”ç”¨çš„æ—¥å¿—å¹¶ä¸ä¼šè¾“å‡ºä¸ºDEBUGçº§åˆ«ã€‚</p>\n<h1 id=\"å¤šå½©è¾“å‡º\"><a href=\"#å¤šå½©è¾“å‡º\" class=\"headerlink\" title=\"å¤šå½©è¾“å‡º\"></a>å¤šå½©è¾“å‡º</h1><p>å¦‚æœä½ çš„ç»ˆç«¯æ”¯æŒANSIï¼Œè®¾ç½®å½©è‰²è¾“å‡ºä¼šè®©æ—¥å¿—æ›´å…·å¯è¯»æ€§ã€‚é€šè¿‡åœ¨application.propertiesä¸­è®¾ç½®spring.output.ansi.enabledå‚æ•°æ¥æ”¯æŒã€‚</p>\n<p>1.NEVERï¼šç¦ç”¨ANSI-coloredè¾“å‡ºï¼ˆé»˜è®¤é¡¹ï¼‰<br>2.DETECTï¼šä¼šæ£€æŸ¥ç»ˆç«¯æ˜¯å¦æ”¯æŒANSIï¼Œæ˜¯çš„è¯å°±é‡‡ç”¨å½©è‰²è¾“å‡ºï¼ˆæ¨èé¡¹ï¼‰<br>3.ALWAYSï¼šæ€»æ˜¯ä½¿ç”¨ANSI-coloredæ ¼å¼è¾“å‡ºï¼Œè‹¥ç»ˆç«¯ä¸æ”¯æŒçš„æ—¶å€™ï¼Œä¼šæœ‰å¾ˆå¤šå¹²æ‰°ä¿¡æ¯ï¼Œä¸æ¨èä½¿ç”¨</p>\n<h1 id=\"æ–‡ä»¶è¾“å‡º\"><a href=\"#æ–‡ä»¶è¾“å‡º\" class=\"headerlink\" title=\"æ–‡ä»¶è¾“å‡º\"></a>æ–‡ä»¶è¾“å‡º</h1><p>Spring Booté»˜è®¤é…ç½®åªä¼šè¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œå¹¶ä¸ä¼šè®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æ—¶éƒ½éœ€è¦ä»¥æ–‡ä»¶æ–¹å¼è®°å½•ã€‚</p>\n<p>è‹¥è¦å¢åŠ æ–‡ä»¶è¾“å‡ºï¼Œéœ€è¦åœ¨application.propertiesä¸­é…ç½®logging.fileæˆ–logging.pathå±æ€§ã€‚</p>\n<p>1.logging.fileï¼Œè®¾ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚ï¼šlogging.file=my.log<br>2.logging.pathï¼Œè®¾ç½®ç›®å½•ï¼Œä¼šåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºspring.logæ–‡ä»¶ï¼Œå¹¶å†™å…¥æ—¥å¿—å†…å®¹ï¼Œå¦‚ï¼šlogging.path=/var/log</p>\n<p>æ—¥å¿—æ–‡ä»¶ä¼šåœ¨10Mbå¤§å°çš„æ—¶å€™è¢«æˆªæ–­ï¼Œäº§ç”Ÿæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤çº§åˆ«ä¸ºï¼šERRORã€WARNã€INFO *</p>\n<h1 id=\"çº§åˆ«æ§åˆ¶\"><a href=\"#çº§åˆ«æ§åˆ¶\" class=\"headerlink\" title=\"çº§åˆ«æ§åˆ¶\"></a>çº§åˆ«æ§åˆ¶</h1><p>åœ¨Spring Bootä¸­åªéœ€è¦åœ¨application.propertiesä¸­è¿›è¡Œé…ç½®å®Œæˆæ—¥å¿—è®°å½•çš„çº§åˆ«æ§åˆ¶ã€‚</p>\n<p>é…ç½®æ ¼å¼ï¼šlogging.level.*=LEVEL</p>\n<p>1.logging.levelï¼šæ—¥å¿—çº§åˆ«æ§åˆ¶å‰ç¼€ï¼Œ*ä¸ºåŒ…åæˆ–Loggerå<br>2.LEVELï¼šé€‰é¡¹TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFF<br>ä¸¾ä¾‹ï¼š</p>\n<p>logging.level.com.juzi=DEBUG     com.juziåŒ…ä¸‹æ‰€æœ‰classä»¥DEBUGçº§åˆ«è¾“å‡º<br>logging.level.root=WARN      rootæ—¥å¿—ä»¥WARNçº§åˆ«è¾“å‡º</p>\n<h1 id=\"è‡ªå®šä¹‰æ—¥å¿—é…ç½®\"><a href=\"#è‡ªå®šä¹‰æ—¥å¿—é…ç½®\" class=\"headerlink\" title=\"è‡ªå®šä¹‰æ—¥å¿—é…ç½®\"></a>è‡ªå®šä¹‰æ—¥å¿—é…ç½®</h1><p>ç”±äºæ—¥å¿—æœåŠ¡ä¸€èˆ¬éƒ½åœ¨ApplicationContextåˆ›å»ºå‰å°±åˆå§‹åŒ–äº†ï¼Œå®ƒå¹¶ä¸æ˜¯å¿…é¡»é€šè¿‡Springçš„é…ç½®æ–‡ä»¶æ§åˆ¶ã€‚<br>å› æ­¤é€šè¿‡ç³»ç»Ÿå±æ€§å’Œä¼ ç»Ÿçš„Spring Bootå¤–éƒ¨é…ç½®æ–‡ä»¶ä¾ç„¶å¯ä»¥å¾ˆå¥½çš„æ”¯æŒæ—¥å¿—æ§åˆ¶å’Œç®¡ç†ã€‚</p>\n<p>æ ¹æ®ä¸åŒçš„æ—¥å¿—ç³»ç»Ÿï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹è§„åˆ™ç»„ç»‡é…ç½®æ–‡ä»¶åï¼Œå°±èƒ½è¢«æ­£ç¡®åŠ è½½ï¼š</p>\n<p>1.Logbackï¼šlogback-spring.xml, logback-spring.groovy, logback.xml, logback.groovy    <a href=\"2016/07/21/logback\">logbackæ—¥å¿—é…ç½®</a><br>2.Log4jï¼šlog4j-spring.properties, log4j-spring.xml, log4j.properties, log4j.xml<br>3.Log4j2ï¼šlog4j2-spring.xml, log4j2.xml<br>4.JDK (Java Util Logging)ï¼šlogging.properties</p>\n<p>Spring Bootå®˜æ–¹æ¨èä¼˜å…ˆä½¿ç”¨å¸¦æœ‰-springçš„æ–‡ä»¶åä½œä¸ºä½ çš„æ—¥å¿—é…ç½®ï¼ˆå¦‚ä½¿ç”¨logback-spring.xmlï¼Œè€Œä¸æ˜¯logback.xmlï¼‰</p>\n<h1 id=\"è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼\"><a href=\"#è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼\" class=\"headerlink\" title=\"è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼\"></a>è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼</h1><p>åœ¨Spring Bootä¸­å¯ä»¥é€šè¿‡åœ¨application.propertiesé…ç½®å¦‚ä¸‹å‚æ•°æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼š</p>\n<p>1.logging.pattern.consoleï¼šå®šä¹‰è¾“å‡ºåˆ°æ§åˆ¶å°çš„æ ·å¼ï¼ˆä¸æ”¯æŒJDK Loggerï¼‰<br>2.logging.pattern.fileï¼šå®šä¹‰è¾“å‡ºåˆ°æ–‡ä»¶çš„æ ·å¼ï¼ˆä¸æ”¯æŒJDK Loggerï¼‰</p>\n"},{"title":"@EnableJpaRepositoriesé…ç½®è¯¦è§£","url":"https://yangzhiw.github.io/2016/08/18/EnableJpaRepositoriesé…ç½®è¯¦è§£/","content":"<h1 id=\"1-ç®€å•é…ç½®\"><a href=\"#1-ç®€å•é…ç½®\" class=\"headerlink\" title=\"1,ç®€å•é…ç½®\"></a>1,ç®€å•é…ç½®</h1><p>@EnableJpaRepositories(â€œcom.juzi.repositoryâ€)<br>æˆ–è€… @EnableJpaRepositories({â€œcom.juzi.repositoryâ€, â€œcom.cshtong.second.repositoryâ€})</p>\n<h1 id=\"2-å®Œæ•´çš„-EnableJpaRepositoriesæ³¨è§£\"><a href=\"#2-å®Œæ•´çš„-EnableJpaRepositoriesæ³¨è§£\" class=\"headerlink\" title=\"2,å®Œæ•´çš„@EnableJpaRepositoriesæ³¨è§£\"></a>2,å®Œæ•´çš„@EnableJpaRepositoriesæ³¨è§£</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"> @EnableJpaRepositories(</div><div class=\"line\">     basePackages = &#123;&#125;,</div><div class=\"line\">     basePackageClasses = &#123;&#125;,</div><div class=\"line\">     includeFilters = &#123;&#125;,</div><div class=\"line\">     excludeFilters = &#123;&#125;,</div><div class=\"line\">     repositoryImplementationPostfix = <span class=\"string\">\"Impl\"</span>,</div><div class=\"line\">     namedQueriesLocation = <span class=\"string\">\"\"</span>,//META-INF/jpa-named-queries.properties</div><div class=\"line\">     queryLookupStrategy=QueryLookupStrategy.Key.CREATE_IF_NOT_FOUND, //QueryLookupStrategy.Key.x</div><div class=\"line\">     repositoryFactoryBeanClass=JpaRepositoryFactoryBean.class, //class</div><div class=\"line\">     entityManagerFactoryRef=<span class=\"string\">\"entityManagerFactory\"</span>,</div><div class=\"line\">     transactionManagerRef=<span class=\"string\">\"transactionManager\"</span>,</div><div class=\"line\">     considerNestedRepositories=<span class=\"literal\">false</span>, </div><div class=\"line\">     enableDefaultTransactions=<span class=\"literal\">true</span></div><div class=\"line\">)</div></pre></td></tr></table></figure>\n<p>å„ä¸ªé…ç½®é¡¹çš„ä½œç”¨<br>1ï¼‰basePackage<br>ç”¨äºé…ç½®æ‰«æRepositoriesæ‰€åœ¨çš„packageåŠå­packageã€‚ç®€å•é…ç½®ä¸­çš„é…ç½®åˆ™ç­‰åŒäºæ­¤é¡¹é…ç½®å€¼ï¼Œ<br>basePackageså¯ä»¥é…ç½®ä¸ºå•ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥é…ç½®ä¸ºå­—ç¬¦ä¸²æ•°ç»„å½¢å¼ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">@EnableJpaRepositories(</div><div class=\"line\">        basePackages = <span class=\"string\">\"com.juzi\"</span>)</div><div class=\"line\">å¤šä¸ªåŒ…è·¯å¾„</div><div class=\"line\">@EnableJpaRepositories(</div><div class=\"line\">        basePackages = &#123;<span class=\"string\">\"com.juzi.repository\"</span>, <span class=\"string\">\"com.juzi.second.repository\"</span>&#125;)</div></pre></td></tr></table></figure></p>\n<p>2ï¼‰basePackageClasses<br>æŒ‡å®š Repository ç±»<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">@EnableJpaRepositories(basePackageClasses = BookRepository.class)</div><div class=\"line\"></div><div class=\"line\">@EnableJpaRepositories(</div><div class=\"line\">         basePackageClasses = &#123;ShopRepository.class, OrganizationRepository.class&#125;)</div></pre></td></tr></table></figure></p>\n<p>3ï¼‰includeFilters<br>è¿‡æ»¤å™¨ï¼Œè¯¥è¿‡æ»¤åŒºé‡‡ç”¨ComponentScançš„è¿‡æ»¤å™¨ç±»<br>@EnableJpaRepositories(<br>      includeFilters={@ComponentScan.Filter(type=FilterType.ANNOTATION, value=Repository.class)})<br>4ï¼‰excludeFilters<br>ä¸åŒ…å«è¿‡æ»¤å™¨</p>\n<p>@EnableJpaRepositories(<br>         excludeFilters={<br>                 @ComponentScan.Filter(type=FilterType.ANNOTATION, value=Service.class),<br>                 @ComponentScan.Filter(type=FilterType.ANNOTATION, value=Controller.class)})</p>\n<p>5ï¼‰repositoryImplementationPostfix<br>å®ç°ç±»è¿½åŠ çš„å°¾éƒ¨ï¼Œæ¯”å¦‚ShopRepositoryï¼Œå¯¹åº”çš„ä¸ºShopRepositoryImpl</p>\n<p>6ï¼‰namedQueriesLocation<br>named SQLå­˜æ”¾çš„ä½ç½®ï¼Œé»˜è®¤ä¸ºMETA-INF/jpa-named-queries.properties</p>\n<p>7ï¼‰queryLookupStrategy<br>æ„å»ºæ¡ä»¶æŸ¥è¯¢çš„ç­–ç•¥ï¼ŒåŒ…å«ä¸‰ç§æ–¹å¼CREATEï¼ŒUSE_DECLARED_QUERYï¼ŒCREATE_IF_NOT_FOUND</p>\n<p>CREATEï¼šæŒ‰ç…§æ¥å£åç§°è‡ªåŠ¨æ„å»ºæŸ¥è¯¢<br>USE_DECLARED_QUERYï¼šç”¨æˆ·å£°æ˜æŸ¥è¯¢<br>CREATE_IF_NOT_FOUNDï¼šå…ˆæœç´¢ç”¨æˆ·å£°æ˜çš„ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨æ„å»º</p>\n<p>8ï¼‰repositoryFactoryBeanClass<br>æŒ‡å®šRepositoryçš„å·¥å‚ç±»</p>\n<p>9)entityManagerFactoryRef<br>å®ä½“ç®¡ç†å·¥å‚å¼•ç”¨åç§°ï¼Œå¯¹åº”åˆ°@Beanæ³¨è§£å¯¹åº”çš„æ–¹æ³•</p>\n<p>10)transactionManagerRef</p>\n<p>äº‹åŠ¡ç®¡ç†å·¥å‚å¼•ç”¨åç§°ï¼Œå¯¹åº”åˆ°@Beanæ³¨è§£å¯¹åº”çš„æ–¹æ³•</p>\n"},{"title":"Spring Bootä¸­ä½¿ç”¨Spring Securityè¿›è¡Œå®‰å…¨æ§åˆ¶","url":"https://yangzhiw.github.io/2016/08/17/Securityè¿›è¡Œå®‰å…¨æ§åˆ¶/","content":""},{"title":"JavaWebåŸºç¡€","url":"https://yangzhiw.github.io/2016/08/16/JavaWebåŸºç¡€/","content":"<h1 id=\"1ï¼ŒServlet-ç”Ÿå‘½å‘¨æœŸã€å·¥ä½œåŸç†\"><a href=\"#1ï¼ŒServlet-ç”Ÿå‘½å‘¨æœŸã€å·¥ä½œåŸç†\" class=\"headerlink\" title=\"1ï¼ŒServlet ç”Ÿå‘½å‘¨æœŸã€å·¥ä½œåŸç†\"></a>1ï¼ŒServlet ç”Ÿå‘½å‘¨æœŸã€å·¥ä½œåŸç†</h1><p><a href=\"http://www.cnblogs.com/xuekyo/archive/2013/02/24/2924072.html\" target=\"_blank\" rel=\"external\">ç‚¹æˆ‘è·³è½¬</a></p>\n<h1 id=\"2ï¼ŒJSPå’ŒServletçš„åŒºåˆ«\"><a href=\"#2ï¼ŒJSPå’ŒServletçš„åŒºåˆ«\" class=\"headerlink\" title=\"2ï¼ŒJSPå’ŒServletçš„åŒºåˆ«\"></a>2ï¼ŒJSPå’ŒServletçš„åŒºåˆ«</h1><p>jspç»è¿‡ç¼–è¯‘åå˜æˆç±»servletï¼Œ<br>jspç”±htmlä»£ç å’Œjspæ ‡ç­¾ç»„æˆï¼Œæ“…é•¿é¡µé¢æ˜¾ç¤ºï¼Œservletæ“…é•¿æµç¨‹æ§åˆ¶ï¼›<br>JSPä¸­åµŒå…¥JAVAä»£ç ï¼Œè€ŒServletä¸­åµŒå…¥HTMLä»£ç ã€‚</p>\n<h1 id=\"3ï¼ŒJSPçš„åŠ¨æ€includeå’Œé™æ€include\"><a href=\"#3ï¼ŒJSPçš„åŠ¨æ€includeå’Œé™æ€include\" class=\"headerlink\" title=\"3ï¼ŒJSPçš„åŠ¨æ€includeå’Œé™æ€include\"></a>3ï¼ŒJSPçš„åŠ¨æ€includeå’Œé™æ€include</h1><p>(1)åŠ¨æ€includeç”¨jsp:includeåŠ¨ä½œå®ç°ï¼Œå¦‚<jsp:include page=\"abc.jsp\" flush=\"true\">ï¼Œ<br>å®ƒæ€»æ˜¯ä¼šæ£€æŸ¥æ‰€å«æ–‡ä»¶ä¸­çš„å˜åŒ–ï¼Œé€‚åˆç”¨äºåŒ…å«åŠ¨æ€é¡µé¢ï¼Œå¹¶ä¸”å¯ä»¥å¸¦å‚æ•°ã€‚ä¼šå…ˆè§£ææ‰€è¦åŒ…å«çš„é¡µé¢ï¼Œè§£æåå’Œä¸»é¡µé¢åˆå¹¶ä¸€èµ·æ˜¾ç¤ºï¼Œå³å…ˆç¼–è¯‘ååŒ…å«ã€‚<br>(2)é™æ€includeç”¨includeä¼ªç å®ç°ï¼Œä¸ä¼šæ£€æŸ¥æ‰€å«æ–‡ä»¶çš„å˜åŒ–ï¼Œé€‚ç”¨äºåŒ…å«é™æ€é¡µé¢ï¼Œå¦‚&lt;%@ include file=â€qq.htmâ€ %&gt;ï¼Œ<br>ä¸ä¼šæå‰è§£ææ‰€è¦åŒ…å«çš„é¡µé¢ï¼Œå…ˆæŠŠè¦æ˜¾ç¤ºçš„é¡µé¢åŒ…å«è¿›æ¥ï¼Œç„¶åç»Ÿä¸€ç¼–è¯‘ï¼Œå³å…ˆåŒ…å«åç¼–è¯‘ã€‚</jsp:include></p>\n<h1 id=\"4ï¼Œè®¾è®¡æ¨¡å¼çš„6å¤§åŸåˆ™\"><a href=\"#4ï¼Œè®¾è®¡æ¨¡å¼çš„6å¤§åŸåˆ™\" class=\"headerlink\" title=\"4ï¼Œè®¾è®¡æ¨¡å¼çš„6å¤§åŸåˆ™\"></a>4ï¼Œè®¾è®¡æ¨¡å¼çš„6å¤§åŸåˆ™</h1><p>(1)å•ä¸€èŒè´£åŸåˆ™<br>    å¯ä»¥é™ä½ç±»çš„å¤æ‚åº¦ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ï¼Œå…¶é€»è¾‘è‚¯å®šè¦æ¯”è´Ÿè´£å¤šé¡¹èŒè´£ç®€å•çš„å¤šï¼›<br>    æé«˜ç±»çš„å¯è¯»æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ï¼›<br>    å˜æ›´å¼•èµ·çš„é£é™©é™ä½ï¼Œå˜æ›´æ˜¯å¿…ç„¶çš„ï¼Œå¦‚æœå•ä¸€èŒè´£åŸåˆ™éµå®ˆçš„å¥½ï¼Œå½“ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œå¯ä»¥æ˜¾è‘—é™ä½å¯¹å…¶ä»–åŠŸèƒ½çš„å½±å“ã€‚</p>\n<p>(2)é‡Œæ°æ›¿æ¢åŸåˆ™<br>    å­ç±»å¯ä»¥å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½è¦†ç›–çˆ¶ç±»çš„éæŠ½è±¡æ–¹æ³•ã€‚<br>    å­ç±»ä¸­å¯ä»¥å¢åŠ è‡ªå·±ç‰¹æœ‰çš„æ–¹æ³•ã€‚<br>    å½“å­ç±»çš„æ–¹æ³•é‡è½½çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„å½¢å‚ï¼‰è¦æ¯”çˆ¶ç±»æ–¹æ³•çš„è¾“å…¥å‚æ•°æ›´å®½æ¾ã€‚<br>    å½“å­ç±»çš„æ–¹æ³•å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„åç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¿”å›å€¼ï¼‰è¦æ¯”çˆ¶ç±»æ›´ä¸¥æ ¼ã€‚</p>\n<p>(3)ä¾èµ–å€’ç½®åŸåˆ™<br>å®šä¹‰ï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼›ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚<br>ä¼ é€’ä¾èµ–å…³ç³»çš„ä¸‰ç§å…³ç³»ï¼š<br>    æ¥å£ä¼ é€’<br>    æ„é€ æ–¹æ³•ä¼ é€’<br>    setteræ–¹æ³•ä¼ é€’<br>(4)æ¥å£éš”ç¦»åŸåˆ™<br>å®šä¹‰ï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚<br>æ¥å£å°½é‡å°ï¼Œä½†æ˜¯è¦æœ‰é™åº¦ã€‚å¯¹æ¥å£è¿›è¡Œç»†åŒ–å¯ä»¥æé«˜ç¨‹åºè®¾è®¡çµæ´»æ€§æ˜¯ä¸æŒ£çš„äº‹å®ï¼Œä½†æ˜¯å¦‚æœè¿‡å°ï¼Œ<br>    åˆ™ä¼šé€ æˆæ¥å£æ•°é‡è¿‡å¤šï¼Œä½¿è®¾è®¡å¤æ‚åŒ–ã€‚æ‰€ä»¥ä¸€å®šè¦é€‚åº¦ã€‚<br>ä¸ºä¾èµ–æ¥å£çš„ç±»å®šåˆ¶æœåŠ¡ï¼Œåªæš´éœ²ç»™è°ƒç”¨çš„ç±»å®ƒéœ€è¦çš„æ–¹æ³•ï¼Œå®ƒä¸éœ€è¦çš„æ–¹æ³•åˆ™éšè—èµ·æ¥ã€‚åªæœ‰ä¸“æ³¨åœ°ä¸ºä¸€ä¸ªæ¨¡å—æä¾›å®šåˆ¶æœåŠ¡ï¼Œ<br>    æ‰èƒ½å»ºç«‹æœ€å°çš„ä¾èµ–å…³ç³»ã€‚<br>æé«˜å†…èšï¼Œå‡å°‘å¯¹å¤–äº¤äº’ã€‚ä½¿æ¥å£ç”¨æœ€å°‘çš„æ–¹æ³•å»å®Œæˆæœ€å¤šçš„äº‹æƒ…ã€‚<br>(5)è¿ªç±³ç‰¹æ³•åˆ™<br>å®šä¹‰ï¼šä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ã€‚<br>(6)å¼€é—­åŸåˆ™<br>å®šä¹‰ï¼šä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p>\n<h1 id=\"4ï¼ŒHibernateç¼“å­˜ï¼šä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜\"><a href=\"#4ï¼ŒHibernateç¼“å­˜ï¼šä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜\" class=\"headerlink\" title=\"4ï¼ŒHibernateç¼“å­˜ï¼šä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜\"></a>4ï¼ŒHibernateç¼“å­˜ï¼šä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜</h1><p>Hibernateç¼“å­˜çš„åˆ†ç±»ï¼š<br>(1),Sessionç¼“å­˜ï¼ˆåˆç§°äº‹ç‰©ç¼“å­˜ï¼‰ï¼ŒHibernateå†…ç½®çš„ï¼Œä¸èƒ½å¸è½½ï¼›<br>ç¼“å­˜èŒƒå›´ï¼šç¼“å­˜åªèƒ½è¢«å½“å‰Sessionå¯¹è±¡è®¿é—®ã€‚ç¼“å­˜çš„ç”Ÿå‘½å‘¨æœŸä¾èµ–äºSessionçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“Sessionè¢«å…³é—­åï¼Œç¼“å­˜ä¹Ÿå°±ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚<br>(2)SessionFactoryç¼“å­˜ï¼ˆåˆç§°ä½œåº”ç”¨ç¼“å­˜ï¼‰ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå¯æ’æ‹”.<br>ç¼“å­˜èŒƒå›´ï¼šç¼“å­˜è¢«åº”ç”¨èŒƒå›´å†…çš„æ‰€æœ‰sessionå…±äº«,ä¸åŒçš„Sessionå¯ä»¥å…±äº«ã€‚è¿™äº›sessionæœ‰å¯èƒ½æ˜¯å¹¶å‘è®¿é—®ç¼“å­˜ï¼Œå› æ­¤å¿…é¡»å¯¹ç¼“å­˜è¿›è¡Œæ›´æ–°ã€‚<br>        ç¼“å­˜çš„ç”Ÿå‘½å‘¨æœŸä¾èµ–äºåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œåº”ç”¨ç»“æŸæ—¶ï¼Œç¼“å­˜ä¹Ÿå°±ç»“æŸäº†ç”Ÿå‘½å‘¨æœŸï¼ŒäºŒçº§ç¼“å­˜å­˜åœ¨äºåº”ç”¨ç¨‹åºèŒƒå›´ã€‚</p>\n<p>ä¸€çº§ç¼“å­˜ï¼š<br>(1). save()ã€‚å½“sessionå¯¹è±¡è°ƒç”¨save()æ–¹æ³•ä¿å­˜ä¸€ä¸ªå¯¹è±¡åï¼Œè¯¥å¯¹è±¡ä¼šè¢«æ”¾å…¥åˆ°sessionçš„ç¼“å­˜ä¸­ã€‚<br>(2). get()å’Œload()ã€‚å½“sessionå¯¹è±¡è°ƒç”¨get()æˆ–load()æ–¹æ³•ä»æ•°æ®åº“å–å‡ºä¸€ä¸ªå¯¹è±¡åï¼Œè¯¥å¯¹è±¡ä¹Ÿä¼šè¢«æ”¾å…¥åˆ°sessionçš„ç¼“å­˜ä¸­ã€‚<br>(3). ä½¿ç”¨HQLå’ŒQBCç­‰ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br>æ•°æ®ä»ç¼“å­˜ä¸­æ¸…é™¤ï¼š<br>(1). evit()å°†æŒ‡å®šçš„æŒä¹…åŒ–å¯¹è±¡ä»ç¼“å­˜ä¸­æ¸…é™¤ï¼Œé‡Šæ”¾å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜èµ„æºï¼ŒæŒ‡å®šå¯¹è±¡ä»æŒä¹…åŒ–çŠ¶æ€å˜ä¸ºè„±ç®¡çŠ¶æ€ï¼Œä»è€Œæˆä¸ºæ¸¸ç¦»å¯¹è±¡ã€‚<br>(2). clear()å°†ç¼“å­˜ä¸­çš„æ‰€æœ‰æŒä¹…åŒ–å¯¹è±¡æ¸…é™¤ï¼Œé‡Šæ”¾å…¶å ç”¨çš„å†…å­˜èµ„æºã€‚<br>å…¶ä»–ç¼“å­˜æ“ä½œï¼š<br>(1). contains()åˆ¤æ–­æŒ‡å®šçš„å¯¹è±¡æ˜¯å¦å­˜åœ¨äºç¼“å­˜ä¸­ã€‚<br>(2). flush()åˆ·æ–°ç¼“å­˜åŒºçš„å†…å®¹ï¼Œä½¿ä¹‹ä¸æ•°æ®åº“æ•°æ®ä¿æŒåŒæ­¥ã€‚</p>\n<p>äºŒçº§ç¼“å­˜ï¼š<br>å®šä¹‰ï¼šSessionFactoryçº§åˆ«çš„ç¼“å­˜ï¼Œå¯ä»¥è·¨è¶ŠSessionå­˜åœ¨ï¼Œå¯ä»¥è¢«å¤šä¸ªSessionæ‰€å…±äº«ã€‚<br>å®ç°åŸç†ï¼š<br>Hibernateå¦‚ä½•å°†æ•°æ®åº“ä¸­çš„æ•°æ®æ”¾å…¥åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼Ÿæ³¨æ„ï¼Œä½ å¯ä»¥æŠŠç¼“å­˜çœ‹åšæ˜¯ä¸€ä¸ªMapå¯¹è±¡ï¼Œ<br>å®ƒçš„Keyç”¨äºå­˜å‚¨å¯¹è±¡OIDï¼ŒValueç”¨äºå­˜å‚¨POJOã€‚é¦–å…ˆï¼Œå½“æˆ‘ä»¬ä½¿ç”¨Hibernateä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ•°æ®ï¼Œ<br>è·å–æ£€ç´¢çš„æ•°æ®åï¼ŒHibernateå°†æ£€ç´¢å‡ºæ¥çš„å¯¹è±¡çš„OIDæ”¾å…¥ç¼“å­˜ä¸­key ä¸­ï¼Œç„¶åå°†å…·ä½“çš„POJOæ”¾å…¥valueä¸­ï¼Œ<br>ç­‰å¾…ä¸‹ä¸€æ¬¡å†æ¬¡å‘æ•°æ®æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒHibernateæ ¹æ®ä½ æä¾›çš„OIDå…ˆæ£€ç´¢ä¸€çº§ç¼“å­˜ï¼Œè‹¥æœ‰ä¸”é…ç½®äº†äºŒçº§ç¼“å­˜ï¼Œåˆ™æ£€ç´¢äºŒçº§ç¼“å­˜ï¼Œ<br>å¦‚æœè¿˜æ²¡æœ‰åˆ™æ‰å‘æ•°æ®åº“å‘é€SQLè¯­å¥ï¼Œç„¶åå°†æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡æ”¾å…¥ç¼“å­˜ä¸­ã€‚</p>\n"},{"title":"è®¡ç®—æœºç½‘ç»œçŸ¥è¯†å¤ä¹ ","url":"https://yangzhiw.github.io/2016/08/12/è®¡ç®—æœºç½‘ç»œçŸ¥è¯†å¤ä¹ /","content":""},{"title":"Springå®šæ—¶ä»»åŠ¡","url":"https://yangzhiw.github.io/2016/08/10/springå®šæ—¶ä»»åŠ¡/","content":"<h2 id=\"è·å–æ˜¨å¤©æ—¶é—´\"><a href=\"#è·å–æ˜¨å¤©æ—¶é—´\" class=\"headerlink\" title=\"è·å–æ˜¨å¤©æ—¶é—´\"></a>è·å–æ˜¨å¤©æ—¶é—´</h2><pre><code>Calendar c=Calendar.getInstance();\nc.add(Calendar.DAY_OF_MONTH,-1);   //æ—¥æœŸæœˆæ˜¯0-11\nc.set(Calendar.HOUR_OF_DAY,0);     \nc.set(Calendar.MINUTE,0);\nc.set(Calendar.SECOND,0);\nc.set(Calendar.MILLISECOND,0);\nreturn c.getTime();\n</code></pre><h2 id=\"åœ¨ç±»ä¸ŠåŠ ä¸Šæ³¨è§£\"><a href=\"#åœ¨ç±»ä¸ŠåŠ ä¸Šæ³¨è§£\" class=\"headerlink\" title=\"åœ¨ç±»ä¸ŠåŠ ä¸Šæ³¨è§£\"></a>åœ¨ç±»ä¸ŠåŠ ä¸Šæ³¨è§£</h2><p>@Configuration<br>@EnableScheduling<br>@Scheduled(fixedRate = 5000) ï¼šä¸Šä¸€æ¬¡å¼€å§‹æ‰§è¡Œæ—¶é—´ç‚¹ä¹‹å5ç§’å†æ‰§è¡Œ<br>@Scheduled(fixedDelay = 5000) ï¼šä¸Šä¸€æ¬¡æ‰§è¡Œå®Œæ¯•æ—¶é—´ç‚¹ä¹‹å5ç§’å†æ‰§è¡Œ<br>@Scheduled(initialDelay=1000, fixedRate=5000) ï¼šç¬¬ä¸€æ¬¡å»¶è¿Ÿ1ç§’åæ‰§è¡Œï¼Œä¹‹åæŒ‰fixedRateçš„è§„åˆ™æ¯5ç§’æ‰§è¡Œä¸€æ¬¡<br>@Scheduled(cron=â€<em>/5 </em> <em> </em> <em> </em>â€œ) ï¼šé€šè¿‡cronè¡¨è¾¾å¼å®šä¹‰è§„åˆ™        </p>\n"},{"title":"è·å–æ–‡ä»¶æµç¼–ç ","url":"https://yangzhiw.github.io/2016/08/10/è·å–æ–‡ä»¶æµçš„ç¼–ç /","content":"<h1 id=\"1ï¼Œè·å–æ–‡ä»¶çš„æµ\"><a href=\"#1ï¼Œè·å–æ–‡ä»¶çš„æµ\" class=\"headerlink\" title=\"1ï¼Œè·å–æ–‡ä»¶çš„æµ\"></a>1ï¼Œè·å–æ–‡ä»¶çš„æµ</h1><pre><code>InportStream importStream = file.getInputStream()ï¼›\n</code></pre><h1 id=\"2ï¼ŒæŠŠæ–‡ä»¶æµè½¬åŒ–ä¸ºå­—èŠ‚æµ\"><a href=\"#2ï¼ŒæŠŠæ–‡ä»¶æµè½¬åŒ–ä¸ºå­—èŠ‚æµ\" class=\"headerlink\" title=\"2ï¼ŒæŠŠæ–‡ä»¶æµè½¬åŒ–ä¸ºå­—èŠ‚æµ\"></a>2ï¼ŒæŠŠæ–‡ä»¶æµè½¬åŒ–ä¸ºå­—èŠ‚æµ</h1><pre><code>//å­—èŠ‚æ•°ç»„è¾“å‡ºæµ\nByteArrayOutputStream baos = new ByteArrayOutputStream();\ntry {\n    byte[] buffer = new byte[1024];\n    int len;\n    while ((len = inputStream.read(buffer)) &gt; -1) {\n        baos.write(buffer, 0, len);\n    }\n    baos.flush();\n}catch(IOException e){\n    e.printStackTrace();\n}\nreturn new ByteArrayInputStream(baos.toByteArray());\n</code></pre><h1 id=\"3ï¼Œæ ¹æ®å­—èŠ‚æµçš„åˆ¤æ–­æ–‡ä»¶çš„ç¼–ç \"><a href=\"#3ï¼Œæ ¹æ®å­—èŠ‚æµçš„åˆ¤æ–­æ–‡ä»¶çš„ç¼–ç \" class=\"headerlink\" title=\"3ï¼Œæ ¹æ®å­—èŠ‚æµçš„åˆ¤æ–­æ–‡ä»¶çš„ç¼–ç \"></a>3ï¼Œæ ¹æ®å­—èŠ‚æµçš„åˆ¤æ–­æ–‡ä»¶çš„ç¼–ç </h1><pre><code>//é»˜è®¤ç¼–ç \nString charset = &quot;GBK&quot;;\nbyte[] first3Bytes = new byte[3];\n//ç¼“å­˜æµ\nBufferedInputStream bis = new BufferedInputStream(inputStream1);\ntry {\n    boolean checked = false;\n    //æ ‡è®°\n    bis.mark(0);\n    //è¯»å–æ–‡ä»¶çš„å‰3ä¸ªå­—ç¬¦\n    int read = bis.read(first3Bytes, 0, 3);\n    if (read == -1) return charset;\n    if (first3Bytes[0] == (byte) 0xFF &amp;&amp; first3Bytes[1] == (byte) 0xFE) {\n        charset = &quot;UTF-16LE&quot;;\n        checked = true;\n    } else if (first3Bytes[0] == (byte) 0xFE &amp;&amp; first3Bytes[1] == (byte) 0xFF) {\n        charset = &quot;UTF-16BE&quot;;\n        checked = true;\n    } else if (first3Bytes[0] == (byte) 0xEF &amp;&amp; first3Bytes[1] == (byte) 0xBB &amp;&amp; first3Bytes[2] == (byte) 0xBF) {\n        charset = &quot;UTF-8&quot;;\n        checked = true;\n    }\n    bis.reset();\n    if (!checked) {\n\n        int loc = 0;\n        while ((read = bis.read()) != -1) {\n            loc++;\n            if (read &gt;= 0xF0) break;\n            if (0x80 &lt;= read &amp;&amp; read &lt;= 0xBF) // å•ç‹¬å‡ºç°BFä»¥ä¸‹çš„ï¼Œä¹Ÿç®—æ˜¯GBK\n                break;\n            if (0xC0 &lt;= read &amp;&amp; read &lt;= 0xDF) {\n                read = bis.read();\n                if (0x80 &lt;= read &amp;&amp; read &lt;= 0xBF) // åŒå­—èŠ‚ (0xC0 - 0xDF) (0x80\n                    continue;\n                else break;\n            } else if (0xE0 &lt;= read &amp;&amp; read &lt;= 0xEF) {// ä¹Ÿæœ‰å¯èƒ½å‡ºé”™ï¼Œä½†æ˜¯å‡ ç‡è¾ƒå°\n                read = bis.read();\n                if (0x80 &lt;= read &amp;&amp; read &lt;= 0xBF) {\n                    read = bis.read();\n                    if (0x80 &lt;= read &amp;&amp; read &lt;= 0xBF) {\n                        charset = &quot;UTF-8&quot;;\n                        break;\n                    } else break;\n                } else break;\n            }\n        }\n    }\n} catch (Exception e) {\n    e.printStackTrace();\n} finally {\n    try {\n        bis.close();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>"},{"title":"java å¤ä¹ èµ„æ–™","url":"https://yangzhiw.github.io/2016/08/01/java-åŸºç¡€é¢˜/","content":"<h1 id=\"javaåŸºç¡€\"><a href=\"#javaåŸºç¡€\" class=\"headerlink\" title=\"javaåŸºç¡€\"></a>javaåŸºç¡€</h1><p>1ï¼Œé¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«<br>2ï¼Œjavaçš„ä¸‰å¤§ç‰¹æ€§</p>\n<hr>\n<pre><code>å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€\n</code></pre><p>3ï¼ŒOverLoadä¸Overrideçš„åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">   Overrideï¼ˆé‡å†™ï¼Œè¦†ç›–ï¼‰ </div><div class=\"line\">æ–¹æ³•åã€å‚æ•°ã€è¿”å›å€¼ç›¸åŒã€‚</div><div class=\"line\">å­ç±»æ–¹æ³•ä¸èƒ½ç¼©å°çˆ¶ç±»æ–¹æ³•çš„è®¿é—®æƒé™ã€‚</div><div class=\"line\">å­ç±»æ–¹æ³•ä¸èƒ½æŠ›å‡ºæ¯”çˆ¶ç±»æ–¹æ³•æ›´å¤šçš„å¼‚å¸¸(ä½†å­ç±»æ–¹æ³•å¯ä»¥ä¸æŠ›å‡ºå¼‚å¸¸)ã€‚</div><div class=\"line\">å­˜åœ¨äºçˆ¶ç±»å’Œå­ç±»ä¹‹é—´ã€‚</div><div class=\"line\">æ–¹æ³•è¢«å®šä¹‰ä¸ºfinalä¸èƒ½è¢«é‡å†™ã€‚</div><div class=\"line\"></div><div class=\"line\">   Overloadï¼ˆé‡è½½ï¼Œè¿‡è½½ï¼‰</div><div class=\"line\">å‚æ•°ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºè‡³å°‘æœ‰ä¸€ä¸ªä¸ç›¸åŒã€‚  </div><div class=\"line\">ä¸èƒ½é‡è½½åªæœ‰è¿”å›å€¼ä¸åŒçš„æ–¹æ³•åã€‚</div><div class=\"line\">å­˜åœ¨äºçˆ¶ç±»å’Œå­ç±»ã€åŒç±»ä¸­ã€‚</div></pre></td></tr></table></figure></p>\n<p>4ï¼Œæ„é€ å™¨ä¸èƒ½è¢«ä¿®é¥°Override<br>5ï¼Œè®¿é—®æ§åˆ¶ç¬¦public,protected,private,ä»¥åŠé»˜è®¤çš„åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">ä½œç”¨åŸŸ      å½“å‰ç±»      åŒåŒ…   å­ç±»    å…¶ä»–</div><div class=\"line\">public        âˆš        âˆš       âˆš      âˆš</div><div class=\"line\">protected     âˆš        âˆš       âˆš      Ã—</div><div class=\"line\">default       âˆš        âˆš       Ã—      Ã—</div><div class=\"line\">private       âˆš        Ã—       Ã—      Ã—</div></pre></td></tr></table></figure></p>\n<p>6ï¼ŒStringå’ŒStringBufferã€StringBuilderçš„åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">å¯å˜ä¸ä¸å¯å˜</div><div class=\"line\">Stringç±»ä¸­ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹å°±æ˜¯ï¼Œå› ä¸ºæœ‰â€œfinalâ€ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“stringå¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚</div><div class=\"line\">private final char value[];</div><div class=\"line\"></div><div class=\"line\">StringBuilderä¸StringBufferéƒ½ç»§æ‰¿è‡ªAbstractStringBuilderç±»ï¼Œåœ¨AbstractStringBuilderä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦</div><div class=\"line\">æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹å°±æ˜¯ï¼Œå¯çŸ¥è¿™ä¸¤ç§å¯¹è±¡éƒ½æ˜¯å¯å˜çš„ã€‚</div><div class=\"line\"></div><div class=\"line\">char[] value;</div><div class=\"line\">çº¿ç¨‹æ˜¯å¦å®‰å…¨</div><div class=\"line\">StringBufferå¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</div><div class=\"line\">StringBuilderå¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</div></pre></td></tr></table></figure></p>\n<p>7ï¼ŒæŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>ï¼‰æŠ½è±¡ç±»å¯ä»¥æä¾›æˆå‘˜æ–¹æ³•çš„å®ç°ç»†èŠ‚ï¼Œè€Œæ¥å£ä¸­åªèƒ½å­˜åœ¨public abstract æ–¹æ³•ï¼›</div><div class=\"line\"></div><div class=\"line\">ã€€ã€€<span class=\"number\">2</span>ï¼‰æŠ½è±¡ç±»ä¸­çš„æˆå‘˜å˜é‡å¯ä»¥æ˜¯å„ç§ç±»å‹çš„ï¼Œè€Œæ¥å£ä¸­çš„æˆå‘˜å˜é‡åªèƒ½æ˜¯public static finalç±»å‹çš„ï¼›</div><div class=\"line\"></div><div class=\"line\">ã€€ã€€<span class=\"number\">3</span>ï¼‰æ¥å£ä¸­ä¸èƒ½å«æœ‰é™æ€ä»£ç å—ä»¥åŠé™æ€æ–¹æ³•ï¼Œè€ŒæŠ½è±¡ç±»å¯ä»¥æœ‰é™æ€ä»£ç å—å’Œé™æ€æ–¹æ³•ï¼›</div><div class=\"line\"></div><div class=\"line\">ã€€ã€€<span class=\"number\">4</span>ï¼‰ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè€Œä¸€ä¸ªç±»å´å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</div></pre></td></tr></table></figure></p>\n<p>8ï¼Œè‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">åŸºæœ¬æ•°æ®ç±»å‹çš„è‡ªåŠ¨è£…ç®±(autoboxing)ã€æ‹†ç®±(unboxing)æ˜¯è‡ªJ2SE <span class=\"number\">5.0</span>å¼€å§‹æä¾›çš„åŠŸèƒ½ã€‚ </div><div class=\"line\">åŸºæœ¬æ•°æ®ä¸å¯¹è±¡çš„åŒºåˆ«</div><div class=\"line\">å¦‚ï¼šint t = <span class=\"number\">1</span>ï¼›     t.  åé¢æ˜¯æ²¡æœ‰æ–¹æ³•æ»´ã€‚</div><div class=\"line\"></div><div class=\"line\">    Integer t =<span class=\"number\">1</span>ï¼› t.  åé¢å°±æœ‰å¾ˆå¤šæ–¹æ³•å¯è®©ä½ è°ƒç”¨äº†ã€‚</div><div class=\"line\"></div><div class=\"line\">Integer i = <span class=\"number\">100</span>; // è‡ªåŠ¨è£…ç®±</div><div class=\"line\">ç›¸å½“äºç¼–è¯‘å™¨è‡ªåŠ¨ä¸ºæ‚¨ä½œä»¥ä¸‹çš„è¯­æ³•ç¼–è¯‘ï¼šInteger i = Integer.valueOf(<span class=\"number\">100</span>);</div><div class=\"line\">Integer i = <span class=\"number\">10</span>; //è£…ç®± </div><div class=\"line\">int t = i; //æ‹†ç®±ï¼Œå®é™…ä¸Šæ‰§è¡Œäº† int t = i.intValue();    </div><div class=\"line\"></div><div class=\"line\">æ³¨æ„ï¼šintegerå€¼å¾—é»˜è®¤å¤§å°æ˜¯<span class=\"bullet\">-127</span><span class=\"bullet\">-128</span></div></pre></td></tr></table></figure></p>\n<p>7ï¼Œæ³›å‹<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">æ³›å‹æ˜¯Java SE <span class=\"number\">1.5</span>çš„æ–°ç‰¹æ€§ï¼Œæ³›å‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°,</div><div class=\"line\">ç±»å‹æ“¦é™¤å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå°†æ³›å‹javaä»£ç è½¬æ¢ä¸ºæ™®é€šjavaä»£ç ï¼Œåªä¸è¿‡ç¼–è¯‘å™¨æ›´ç›´æ¥ç‚¹ï¼Œ</div><div class=\"line\">å°†æ³›å‹javaä»£ç ç›´æ¥è½¬æ¢æˆæ™®é€šjavaå­—èŠ‚ç ã€‚</div><div class=\"line\">     ç±»å‹æ“¦é™¤çš„ä¸»è¦è¿‡ç¨‹å¦‚ä¸‹ï¼š</div><div class=\"line\">     <span class=\"number\">1.</span>å°†æ‰€æœ‰çš„æ³›å‹å‚æ•°ç”¨å…¶æœ€å·¦è¾¹ç•Œï¼ˆæœ€é¡¶çº§çš„çˆ¶ç±»å‹ï¼‰ç±»å‹æ›¿æ¢ã€‚</div><div class=\"line\">     <span class=\"number\">2.</span>ç§»é™¤æ‰€æœ‰çš„ç±»å‹å‚æ•°ã€‚</div></pre></td></tr></table></figure></p>\n<p>8,Javaä¸­çš„é›†åˆç±»åŠå…¶å…³ç³»å›¾<br>å…³ç³»å›¾<br><img src=\"/2016/08/01/java-åŸºç¡€é¢˜/java_collection.jpg\" alt=\"å¾®æœåŠ¡æ¶æ„å›¾\" title=\"å¾®æœåŠ¡æ¶æ„å›¾\"><br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">ã€€ä¸Šè¿°ç±»å›¾ä¸­ï¼Œå®çº¿è¾¹æ¡†çš„æ˜¯å®ç°ç±»ï¼Œæ¯”å¦‚ArrayListï¼ŒLinkedListï¼ŒHashMapç­‰ï¼Œ</div><div class=\"line\">  æŠ˜çº¿è¾¹æ¡†çš„æ˜¯æŠ½è±¡ç±»ï¼Œæ¯”å¦‚AbstractCollectionï¼ŒAbstractListï¼ŒAbstractMapç­‰ï¼Œ</div><div class=\"line\">  è€Œç‚¹çº¿è¾¹æ¡†çš„æ˜¯æ¥å£ï¼Œæ¯”å¦‚Collectionï¼ŒIteratorï¼ŒListç­‰ã€‚</div><div class=\"line\">  \tã€€\t\tæ˜¯å¦æœ‰åº\tæ˜¯å¦å…è®¸å…ƒç´ é‡å¤</div><div class=\"line\">Collection\t\tå¦\t\tæ˜¯</div><div class=\"line\">List\t\t\tæ˜¯\t\tæ˜¯</div><div class=\"line\">Set\tAbstractSet\tå¦\t\tå¦</div><div class=\"line\">ã€€\tHashSet    \t å¦\t\tå¦</div><div class=\"line\">ã€€\tTreeSet\t\tæ˜¯\t\tå¦</div><div class=\"line\">Map\tAbstractMap\tå¦\tä½¿ç”¨key-valueæ¥æ˜ å°„å’Œå­˜å‚¨æ•°æ®ï¼Œkeyå¿…é¡»å”¯ä¸€ï¼Œvalueå¯ä»¥é‡å¤</div><div class=\"line\">ã€€\tHashMap</div><div class=\"line\">ã€€\tTreeMap\t\tæ˜¯ï¼ˆç”¨äºŒå‰æ’åºæ ‘ï¼‰</div></pre></td></tr></table></figure></p>\n<p>9ï¼ŒHashMapçš„å®ç°åŸç†<br>   è§æ­¤é“¾æ¥<br>10ï¼ŒHashTableå®ç°åŸç†<br>   è§æ­¤é“¾æ¥<br>11ï¼ŒHashMapä¸HashTableçš„åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">ç¬¬ä¸€ï¼Œç»§æ‰¿ä¸åŒã€‚</div><div class=\"line\"></div><div class=\"line\">public class Hashtable extends Dictionary implements Map</div><div class=\"line\">public class HashMap  extends AbstractMap implements Map</div><div class=\"line\">ç¬¬äºŒ</div><div class=\"line\"></div><div class=\"line\">Hashtable ä¸­çš„æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œè€ŒHashMapä¸­çš„æ–¹æ³•åœ¨ç¼ºçœæƒ…å†µä¸‹æ˜¯éåŒæ­¥çš„ã€‚åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„ç¯å¢ƒä¸‹ï¼Œ</div><div class=\"line\">å¯ä»¥ç›´æ¥ä½¿ç”¨Hashtableï¼Œä½†æ˜¯è¦ä½¿ç”¨HashMapçš„è¯å°±è¦è‡ªå·±å¢åŠ åŒæ­¥å¤„ç†äº†ã€‚</div><div class=\"line\">å¦‚æœä¸ºäº†è¦çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ä½¿ç”¨CurrentHashMap</div><div class=\"line\"></div><div class=\"line\">ç¬¬ä¸‰</div><div class=\"line\"></div><div class=\"line\">Hashtableä¸­ï¼Œkeyå’Œvalueéƒ½ä¸å…è®¸å‡ºç°<span class=\"literal\">null</span>å€¼ã€‚</div><div class=\"line\"></div><div class=\"line\">åœ¨HashMapä¸­ï¼Œ<span class=\"literal\">null</span>å¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼›å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸º<span class=\"literal\">null</span>ã€‚å½“get()æ–¹æ³•è¿”å›<span class=\"literal\">null</span>å€¼æ—¶ï¼Œå³å¯ä»¥è¡¨ç¤º HashMapä¸­æ²¡æœ‰è¯¥é”®ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºè¯¥é”®æ‰€å¯¹åº”çš„å€¼ä¸º<span class=\"literal\">null</span>ã€‚å› æ­¤ï¼Œåœ¨HashMapä¸­ä¸èƒ½ç”±get()æ–¹æ³•æ¥åˆ¤æ–­HashMapä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé”®ï¼Œ è€Œåº”è¯¥ç”¨containsKey()æ–¹æ³•æ¥åˆ¤æ–­ã€‚</div><div class=\"line\"></div><div class=\"line\">ç¬¬å››ï¼Œä¸¤ä¸ªéå†æ–¹å¼çš„å†…éƒ¨å®ç°ä¸Šä¸åŒã€‚</div><div class=\"line\"></div><div class=\"line\">Hashtableã€HashMapéƒ½ä½¿ç”¨äº† Iteratorã€‚è€Œç”±äºå†å²åŸå› ï¼ŒHashtableè¿˜ä½¿ç”¨äº†Enumerationçš„æ–¹å¼ ã€‚</div><div class=\"line\"></div><div class=\"line\">ç¬¬äº”</div><div class=\"line\"></div><div class=\"line\">å“ˆå¸Œå€¼çš„ä½¿ç”¨ä¸åŒï¼ŒHashTableç›´æ¥ä½¿ç”¨å¯¹è±¡çš„hashCodeã€‚è€ŒHashMapé‡æ–°è®¡ç®—hashå€¼ã€‚</div><div class=\"line\"></div><div class=\"line\">ç¬¬å…­</div><div class=\"line\"></div><div class=\"line\">Hashtableå’ŒHashMapå®ƒä»¬ä¸¤ä¸ªå†…éƒ¨å®ç°æ–¹å¼çš„æ•°ç»„çš„åˆå§‹å¤§å°å’Œæ‰©å®¹çš„æ–¹å¼ã€‚HashTableä¸­hashæ•°ç»„é»˜è®¤å¤§å°æ˜¯<span class=\"number\">11</span>ï¼Œå¢åŠ çš„æ–¹å¼æ˜¯ old*<span class=\"number\">2</span>+<span class=\"number\">1</span>ã€‚HashMapä¸­hashæ•°ç»„çš„é»˜è®¤å¤§å°æ˜¯<span class=\"number\">16</span>ï¼Œè€Œä¸”ä¸€å®šæ˜¯<span class=\"number\">2</span>çš„æŒ‡æ•°ã€‚</div></pre></td></tr></table></figure></p>\n<p>12ï¼ŒArrayListå’ŒvectoråŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>ï¼‰  Vectorçš„æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„(Synchronized),æ˜¯çº¿ç¨‹å®‰å…¨çš„(thread-safe)ï¼Œè€ŒArrayListçš„æ–¹æ³•ä¸æ˜¯ï¼Œç”±äºçº¿ç¨‹çš„åŒæ­¥å¿…ç„¶è¦å½±å“æ€§èƒ½ï¼Œå› æ­¤,ArrayListçš„æ€§èƒ½æ¯”Vectorå¥½ã€‚ </div><div class=\"line\"><span class=\"number\">2</span>ï¼‰ å½“Vectoræˆ–ArrayListä¸­çš„å…ƒç´ è¶…è¿‡å®ƒçš„åˆå§‹å¤§å°æ—¶,Vectorä¼šå°†å®ƒçš„å®¹é‡ç¿»å€,è€ŒArrayListåªå¢åŠ <span class=\"number\">50</span>%çš„å¤§å°ï¼Œè¿™æ ·,ArrayListå°±æœ‰åˆ©äºèŠ‚çº¦å†…å­˜ç©ºé—´ã€‚</div></pre></td></tr></table></figure></p>\n<p>13,ArrayListå’ŒLinkedListåŒºåˆ«åŠä½¿ç”¨åœºæ™¯<br>åŒºåˆ«<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">ArryListåˆå§‹åŒ–æ—¶ï¼ŒelementDataæ•°ç»„å¤§å°é»˜è®¤ä¸º<span class=\"number\">10</span>ï¼›</div><div class=\"line\">æ¯æ¬¡addï¼ˆï¼‰æ—¶ï¼Œå…ˆè°ƒç”¨ensureCapacityï¼ˆï¼‰ä¿è¯æ•°ç»„ä¸ä¼šæº¢å‡ºï¼Œå¦‚æœæ­¤æ—¶å·²æ»¡ï¼Œä¼šæ‰©å±•ä¸ºæ•°ç»„lengthçš„<span class=\"number\">1.5</span>å€+<span class=\"number\">1</span>ï¼Œ</div><div class=\"line\">ç„¶åç”¨array.copyçš„æ–¹æ³•ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°æ–°çš„æ•°ç»„ä¸­ï¼›çº¿ç¨‹ä¸å®‰å…¨ã€‚</div><div class=\"line\"></div><div class=\"line\">LinkedListæ˜¯åŸºäºåŒé“¾è¡¨å®ç°çš„ï¼š</div><div class=\"line\">ä½¿ç”¨headerçš„ä¼˜ç‚¹æ˜¯ï¼šåœ¨ä»»ä½•ä¸€ä¸ªæ¡ç›®ï¼ˆåŒ…æ‹¬ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼‰éƒ½æœ‰ä¸€ä¸ªå‰ç½®æ¡ç›®å’Œä¸€ä¸ªåç½®æ¡ç›®ï¼Œ</div><div class=\"line\">å› æ­¤åœ¨LinkedListå¯¹è±¡çš„å¼€å§‹æˆ–è€…æœ«å°¾è¿›è¡Œæ’å…¥æ“ä½œæ²¡æœ‰ç‰¹æ®Šçš„åœ°æ–¹ï¼›</div></pre></td></tr></table></figure></p>\n<p>ä½¿ç”¨åœºæ™¯<br>   ï¼ˆ1ï¼‰æŸ¥è¯¢æ“ä½œå¤šï¼ŒArrayListå¯¹è±¡è¦è¿œä¼˜äºLinkedListå¯¹è±¡ï¼›</p>\n<p>   ï¼ˆ2ï¼‰ä¿®æ”¹å’Œåˆ é™¤æ“ä½œå¤šï¼ŒLinkedListå¯¹è±¡è¦è¿œä¼˜äºArrayListå¯¹è±¡ï¼›</p>\n<p>14ï¼Œstaticå’ŒfinalåŒºåˆ«å’Œç”¨é€”<br> static<br> <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">ä¿®é¥°å˜é‡ï¼šé™æ€å˜é‡éšç€ç±»è¢«åŠ è½½æ—¶è¢«å®Œå…¨åˆå§‹åŒ–ï¼Œåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”JVMåªä¼šä¸ºå®ƒåˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œæ‰€æœ‰ç±»å…±äº«æ­¤å˜é‡ã€‚</div><div class=\"line\">ä¿®é¥°æ–¹æ³•ï¼šåœ¨ç±»åŠ è½½æ—¶å­˜åœ¨ï¼Œä¸ä¾èµ–ä»»ä½•å®ä¾‹ï¼Œæ–¹æ³•å¿…é¡»å®ç°ï¼Œä¸èƒ½ç”¨abstractä¿®é¥°ã€‚</div><div class=\"line\">ä¿®é¥°ä»£ç å—ï¼šåœ¨ç±»åŠ è½½å®Œä¹‹åæ‰§è¡Œä»£ç å—çš„å†…å®¹ã€‚</div><div class=\"line\">   çˆ¶ç±»é™æ€ä»£ç å—-&gt;å­ç±»é™æ€ä»£ç å—-&gt;çˆ¶ç±»éé™æ€ä»£ç å—-&gt;çˆ¶ç±»æ„é€ æ–¹æ³•â€”&gt;å­ç±»éé™æ€ä»£ç å—-&gt;å­ç±»æ„é€ æ–¹æ³•</div></pre></td></tr></table></figure></p>\n<p> final<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"> ä¿®é¥°å˜é‡ï¼š</div><div class=\"line\">  ç¼–è¯‘å™¨å¸¸é‡ï¼šç±»åŠ è½½æ˜¯å®Œæˆåˆå§‹åŒ–ï¼Œç¼–è¯‘åå¸¦å…¥åˆ°ä»»ä½•è®¡ç®—ä¸­ï¼Œåªèƒ½åŸºæœ¬æ•°æ®ç±»å‹ã€‚</div><div class=\"line\">  è¿è¡Œæ—¶å¸¸é‡ï¼šåŸºæœ¬æ•°æ®ç±»å‹æˆ–å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¼•ç”¨ä¸å¯å˜ï¼Œä½†å¼•ç”¨çš„ç±»å‹å¯å˜ã€‚</div><div class=\"line\">ä¿®é¥°æ–¹æ³•ï¼šæ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¸èƒ½è¢«å­ç±»ä¿®æ”¹ã€‚</div><div class=\"line\">ä¿®é¥°ç±»ï¼šä¸èƒ½è¢«ç»§æ‰¿ã€‚</div><div class=\"line\">ä¿®é¥°å½¢å‚ï¼šfinalå½¢å‚ä¸å¯å˜ã€‚</div></pre></td></tr></table></figure></p>\n<p>15,HashMapå’ŒConcurrentHashMapçš„åŒºåˆ«<br>HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒConcurrentHashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<br>ConcurrentHashMapå°†æ•´ä¸ªHashæ¡¶è¿›è¡Œäº†åˆ†æ®µsegmentï¼Œæ¯ä¸ªsegmentä¸Šé¢éƒ½æœ‰é”çš„å­˜åœ¨ã€‚<br>ConcurrentHashMapçš„é”çš„ç²’åº¦è¶Šç»†ï¼Œå¹¶å‘æ€§èƒ½è¶Šå¥½ã€‚</p>\n<p>16ï¼Œçº¿ç¨‹å®‰å…¨<br>å®šä¹‰ï¼šç±»çš„è¡Œä¸ºä¸å…¶çš„è§„èŒƒä¸€è‡´ã€‚<br>å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼š<br>   å¯¹å˜é‡ä½¿ç”¨validate<br>   å¯¹ç¨‹åºè¿›è¡ŒåŠ é”<br>17ï¼Œå¤šçº¿ç¨‹å¦‚ä½•è¿›è¡Œä¿¡æ¯äº¤äº’<br>Objectä¸­çš„æ–¹æ³•ï¼Œwaitï¼Œnotify(),notifyAll()</p>\n<p>18,å¤šçº¿ç¨‹å…±ç”¨ä¸€ä¸ªå˜é‡éœ€è¦æ³¨æ„ä»€ä¹ˆ<br>åœ¨çº¿ç¨‹å¯¹è±¡runnableä¸­å®šä¹‰äº†å…¨å±€å˜é‡ï¼Œrunæ–¹æ³•ä¼šä¿®æ”¹è¯¥å˜é‡æ—¶ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨è¯¥å˜é‡æ—¶å€™ï¼Œå¯èƒ½æœ‰é”™è¯¯å‘ç”Ÿã€‚<br>ThreadLocalæ˜¯JDKå¼•å…¥çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒç”¨äºè§£å†³çº¿ç¨‹çš„å…±äº«å˜é‡ï¼Œä½¿ç”¨ThreadLocalå£°æ˜çš„å˜é‡ï¼Œå³ä½¿åœ¨çº¿ç¨‹ä¸­å±äºå…¨å±€å˜é‡ï¼Œ<br>é’ˆå¯¹æ¯ä¸ªçº¿ç¨‹æ¥è®²ï¼Œè¿™ä¸ªå˜é‡æ˜¯ç‹¬ç«‹çš„ã€‚<br>validateå˜é‡æ¯æ¬¡è¢«çº¿ç¨‹è®¿é—®æ—¶ï¼Œéƒ½ä¼šä½¿å¾—çº¿ç¨‹ä»ä¸»å†…å­˜ä¸­é‡è¯»è¯¥å˜é‡çš„æœ€æ–°å€¼ï¼Œè€Œè¯¥å˜é‡å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œä¹Ÿæ˜¯æŠŠä¿®æ”¹çš„å€¼å†™å…¥åˆ°<br>å†…å­˜ä¸­å»ã€‚</p>\n<p>19ï¼Œçº¿ç¨‹æ± <br>åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼š<br>  çº¿ç¨‹ç®¡ç†å™¨(ThreadPool) :ç”¨æˆ·åˆ›å»ºå¹¶ç®¡ç†çº¿ç¨‹æ± ï¼ŒåŒ…æ‹¬åˆ›å»ºï¼Œæ‘§æ¯çº¿ç¨‹æ± ï¼Œæ·»åŠ æ–°ä»»åŠ¡ã€‚<br>  å·¥ä½œçº¿ç¨‹ï¼ˆpoolworkï¼‰:çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œåœ¨æ²¡æœ‰ä»»åŠ¡æ—¶ï¼Œå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¯ä»¥å¾ªç¯ä½¿ç”¨ã€‚<br>  ä»»åŠ¡æ¥å£ï¼ˆTaskï¼‰ï¼šæ¯ä¸ªä»»åŠ¡å¿…é¡»å®ç°çš„æ¥å£ï¼Œä»¥ä¾›å·¥ä½œçº¿ç¨‹è°ƒåº¦çš„æ‰§è¡Œï¼Œå®ƒä¸»è¦è§„å®šäº†ä»»åŠ¡çš„å…¥å£ï¼Œ<br>    ä»»åŠ¡å®Œæˆçš„æ”¶å°¾å·¥ä½œï¼Œä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ç­‰ã€‚<br>  ä»»åŠ¡é˜Ÿåˆ—ï¼ˆTaskqueueï¼‰ï¼šç”¨äºå­˜æ”¾æ²¡æœ‰å¤„ç†çš„ä»»åŠ¡ï¼Œæä¾›ä¸€ç§ç¼“å­˜æœºåˆ¶ã€‚</p>\n"},{"title":"spring AOP æ³¨è§£å¼€å‘","url":"https://yangzhiw.github.io/2016/07/28/spring-AOP-æ³¨è§£å¼€å‘/","content":"<h1 id=\"1-ç®€ä»‹\"><a href=\"#1-ç®€ä»‹\" class=\"headerlink\" title=\"1.ç®€ä»‹\"></a>1.ç®€ä»‹</h1><p>AOPä¸»è¦åŒ…å«äº†é€šçŸ¥ã€åˆ‡ç‚¹å’Œè¿æ¥ç‚¹ç­‰æœ¯è¯­ï¼Œä»‹ç»å¦‚ä¸‹:</p>\n<h2 id=\"é€šçŸ¥ï¼ˆadviceï¼‰\"><a href=\"#é€šçŸ¥ï¼ˆadviceï¼‰\" class=\"headerlink\" title=\"é€šçŸ¥ï¼ˆadviceï¼‰\"></a>é€šçŸ¥ï¼ˆadviceï¼‰</h2><p>é€šçŸ¥å®šä¹‰äº†åˆ‡é¢æ˜¯ä»€ä¹ˆä»¥åŠä½•æ—¶è°ƒç”¨ï¼Œä½•æ—¶è°ƒç”¨åŒ…å«ä»¥ä¸‹å‡ ç§<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">Before åœ¨æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥</div><div class=\"line\">After åœ¨æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ— è®ºæ–¹æ³•æ‰§è¡Œæ˜¯å¦æˆåŠŸ</div><div class=\"line\">After-returning åœ¨æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥</div><div class=\"line\">After-throwing åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥</div><div class=\"line\">Around é€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸º</div></pre></td></tr></table></figure></p>\n<h2 id=\"åˆ‡ç‚¹-PointCut\"><a href=\"#åˆ‡ç‚¹-PointCut\" class=\"headerlink\" title=\"åˆ‡ç‚¹(PointCut)\"></a>åˆ‡ç‚¹(PointCut)</h2><p>é€šçŸ¥å®šä¹‰äº†åˆ‡é¢çš„ä»€ä¹ˆå’Œä½•æ—¶ï¼Œåˆ‡ç‚¹å®šä¹‰äº†ä½•å¤„ï¼Œåˆ‡ç‚¹çš„å®šä¹‰ä¼šåŒ¹é…é€šçŸ¥æ‰€è¦ç»‡å…¥çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥ç‚¹ï¼Œ<br>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ˜ç¡®çš„ç±»çš„æ–¹æ³•åç§°æ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ï¼Œæˆ–æ˜¯åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰åŒ¹é…çš„ç±»å’Œæ–¹æ³•åç§°æ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ã€‚</p>\n<h2 id=\"è¿æ¥ç‚¹-JoinPoint\"><a href=\"#è¿æ¥ç‚¹-JoinPoint\" class=\"headerlink\" title=\"è¿æ¥ç‚¹(JoinPoint)\"></a>è¿æ¥ç‚¹(JoinPoint)</h2><p>è¿æ¥ç‚¹æ˜¯åœ¨åº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å¯ä»¥æ˜¯è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œç”šè‡³æ˜¯ä¿®æ”¹ä¸€ä¸ªå­—æ®µæ—¶ï¼Œ<br>åˆ‡é¢ä»£ç å¯ä»¥åˆ©ç”¨è¿™äº›è¿æ¥ç‚¹æ’å…¥åˆ°åº”ç”¨çš„æ­£å¸¸æµç¨‹ä¸­ï¼Œå¹¶æ·»åŠ æ–°çš„è¡Œä¸ºï¼Œå¦‚æ—¥å¿—ã€å®‰å…¨ã€äº‹åŠ¡ã€ç¼“å­˜ç­‰ã€‚<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">joinPoint.getSignature().getDeclaringTypeName() å¯ä»¥è·å–åˆ°è°ƒç”¨æ–¹æ³•çš„ç±»åï¼ˆåŒ…æ‹¬åŒ…åï¼‰ï¼Œ</div><div class=\"line\">joinPoint.getSignature().getName()    å¯ä»¥è·å–æ–¹æ³•åï¼Œ</div><div class=\"line\">Arrays.toString(joinPoint.getArgs())   å¾—åˆ°çš„æ˜¯æ–¹æ³•è°ƒç”¨çš„å‚æ•°åˆ—è¡¨ï¼Œ</div><div class=\"line\">joinPoint.proceed()   å¯ä»¥å¾—åˆ°æ–¹æ³•çš„è¿”å›ç»“æœ</div></pre></td></tr></table></figure></p>\n<h1 id=\"2-æ³¨è§£å¼€å‘\"><a href=\"#2-æ³¨è§£å¼€å‘\" class=\"headerlink\" title=\"2.æ³¨è§£å¼€å‘\"></a>2.æ³¨è§£å¼€å‘</h1><p>å£°æ˜ä¸€ä¸ªåˆ‡é¢ï¼Œåªéœ€è¦åœ¨ç±»åä¸Šæ·»åŠ @Aspectå±æ€§å³å¯ï¼Œå…·ä½“çš„è¿æ¥ç‚¹ï¼Œæˆ‘ä»¬ç”¨@Pointcutå’Œ@Beforeã€@Afterç­‰æ ‡æ³¨ã€‚<br>åœ¨å£°æ˜å‰ æˆ‘ä»¬éœ€è¦ä¾èµ–é…ç½®pom<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">&lt;dependency<span class=\"string\">&gt;</span></div><div class=\"line\">    &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;</div><div class=\"line\">    &lt;version&gt;1.6.11&lt;/version&gt;</div><div class=\"line\">&lt;/dependency&gt;</div><div class=\"line\">&lt;dependency&gt;</div><div class=\"line\">    &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;</div><div class=\"line\">    &lt;version&gt;1.6.11&lt;/version&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>\n<p>ä¾‹å­<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div></pre></td><td class=\"code\"><pre><div class=\"line\">package com.ganji.demo.service.aspect;</div><div class=\"line\"></div><div class=\"line\">import org.aspectj.lang.ProceedingJoinPoint;</div><div class=\"line\">import org.aspectj.lang.annotation.*;</div><div class=\"line\">import org.springframework.stereotype.Service;</div><div class=\"line\"></div><div class=\"line\">/**</div><div class=\"line\"> * Created by admin on <span class=\"number\">2015</span>/<span class=\"number\">9</span>/<span class=\"number\">2.</span></div><div class=\"line\"> */</div><div class=\"line\">@Aspect</div><div class=\"line\">@Service</div><div class=\"line\">public class XmlAopDemoUserLog &#123;</div><div class=\"line\"></div><div class=\"line\">// é…ç½®åˆ‡ç‚¹ åŠè¦ä¼ çš„å‚æ•°   </div><div class=\"line\">    @Pointcut(<span class=\"string\">\"execution(* com.ganji.demo.service.user.UserService.GetDemoUser(..)) &amp;&amp; args(id)\"</span>)</div><div class=\"line\">    public void pointCut(int id)</div><div class=\"line\">    &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">// é…ç½®è¿æ¥ç‚¹ æ–¹æ³•å¼€å§‹æ‰§è¡Œæ—¶é€šçŸ¥</div><div class=\"line\">    @Before(<span class=\"string\">\"pointCut(id)\"</span>)</div><div class=\"line\">    public void beforeLog(int id) &#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"å¼€å§‹æ‰§è¡Œå‰ç½®é€šçŸ¥  æ—¥å¿—è®°å½•:\"</span>+id);</div><div class=\"line\">    &#125;</div><div class=\"line\">//    æ–¹æ³•æ‰§è¡Œå®Œåé€šçŸ¥</div><div class=\"line\">    @After(<span class=\"string\">\"pointCut(id)\"</span>)</div><div class=\"line\">    public void afterLog(int id) &#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"å¼€å§‹æ‰§è¡Œåç½®é€šçŸ¥ æ—¥å¿—è®°å½•:\"</span>+id);</div><div class=\"line\">    &#125;</div><div class=\"line\">//    æ‰§è¡ŒæˆåŠŸåé€šçŸ¥</div><div class=\"line\">    @AfterReturning(<span class=\"string\">\"pointCut(id)\"</span>)</div><div class=\"line\">    public void afterReturningLog(int id) &#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"æ–¹æ³•æˆåŠŸæ‰§è¡Œåé€šçŸ¥ æ—¥å¿—è®°å½•:\"</span>+id);</div><div class=\"line\">    &#125;</div><div class=\"line\">//    æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥</div><div class=\"line\">    @AfterThrowing(<span class=\"string\">\"pointCut(id)\"</span>)</div><div class=\"line\">    public void afterThrowingLog(int id) &#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œé€šçŸ¥ æ—¥å¿—è®°å½•\"</span>+id);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">//    ç¯ç»•é€šçŸ¥</div><div class=\"line\">    @Around(<span class=\"string\">\"pointCut(id)\"</span>)</div><div class=\"line\">    public Object aroundLog(ProceedingJoinPoint joinpoint,int id) &#123;</div><div class=\"line\">        Object result = <span class=\"literal\">null</span>;</div><div class=\"line\">        try &#123;</div><div class=\"line\">            System.out.println(<span class=\"string\">\"ç¯ç»•é€šçŸ¥å¼€å§‹ æ—¥å¿—è®°å½•\"</span>+id);</div><div class=\"line\">            long start = System.currentTimeMillis();</div><div class=\"line\"></div><div class=\"line\">            //æœ‰è¿”å›å‚æ•° åˆ™éœ€è¿”å›å€¼</div><div class=\"line\">            result =  joinpoint.proceed();</div><div class=\"line\"></div><div class=\"line\">            long end = System.currentTimeMillis();</div><div class=\"line\">            System.out.println(<span class=\"string\">\"æ€»å…±æ‰§è¡Œæ—¶é•¿\"</span> + (end - start) + <span class=\"string\">\" æ¯«ç§’\"</span>);</div><div class=\"line\">            System.out.println(<span class=\"string\">\"ç¯ç»•é€šçŸ¥ç»“æŸ æ—¥å¿—è®°å½•\"</span>);</div><div class=\"line\">        &#125; catch (Throwable t) &#123;</div><div class=\"line\">            System.out.println(<span class=\"string\">\"å‡ºç°é”™è¯¯\"</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        return result;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h1 id=\"AOPåˆ‡é¢ä¸­çš„åŒæ­¥é—®é¢˜\"><a href=\"#AOPåˆ‡é¢ä¸­çš„åŒæ­¥é—®é¢˜\" class=\"headerlink\" title=\"AOPåˆ‡é¢ä¸­çš„åŒæ­¥é—®é¢˜\"></a>AOPåˆ‡é¢ä¸­çš„åŒæ­¥é—®é¢˜</h1><p>åœ¨WebLogAspectåˆ‡é¢ä¸­ï¼Œåˆ†åˆ«é€šè¿‡doBeforeå’ŒdoAfterReturningä¸¤ä¸ªç‹¬ç«‹å‡½æ•°å®ç°äº†åˆ‡ç‚¹å¤´éƒ¨å’Œåˆ‡ç‚¹è¿”å›åæ‰§è¡Œçš„å†…å®¹ï¼Œ<br>è‹¥æˆ‘ä»¬æƒ³ç»Ÿè®¡è¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œå°±éœ€è¦åœ¨doBeforeå¤„è®°å½•æ—¶é—´ï¼Œå¹¶åœ¨doAfterReturningå¤„é€šè¿‡å½“å‰æ—¶é—´ä¸å¼€å§‹å¤„è®°å½•çš„æ—¶é—´è®¡ç®—<br>å¾—åˆ°è¯·æ±‚å¤„ç†çš„æ¶ˆè€—æ—¶é—´ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨WebLogAspectåˆ‡é¢ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡æ¥ç»™doBeforeå’ŒdoAfterReturningä¸€èµ·è®¿é—®å‘¢ï¼Ÿæ˜¯å¦ä¼šæœ‰åŒæ­¥é—®é¢˜å‘¢ï¼Ÿ<br>çš„ç¡®ï¼Œç›´æ¥åœ¨è¿™é‡Œå®šä¹‰åŸºæœ¬ç±»å‹ä¼šæœ‰åŒæ­¥é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¼•å…¥ThreadLocalå¯¹è±¡ï¼Œåƒä¸‹é¢è¿™æ ·è¿›è¡Œè®°å½•ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">@Aspect</div><div class=\"line\">@Component</div><div class=\"line\">public class WebLogAspect &#123;</div><div class=\"line\"></div><div class=\"line\">    private Logger logger = Logger.getLogger(getClass());</div><div class=\"line\"></div><div class=\"line\">    ThreadLocal&lt;Long&gt; startTime = new ThreadLocal&lt;&gt;();</div><div class=\"line\"></div><div class=\"line\">    @Pointcut(<span class=\"string\">\"execution(public * com.juzi.web..*.*(..))\"</span>)</div><div class=\"line\">    public void webLog()&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    @Before(<span class=\"string\">\"webLog()\"</span>)</div><div class=\"line\">    public void doBefore(JoinPoint joinPoint) throws Throwable &#123;</div><div class=\"line\">        startTime.set(System.currentTimeMillis());</div><div class=\"line\"></div><div class=\"line\">        // çœç•¥æ—¥å¿—è®°å½•å†…å®¹</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    @AfterReturning(returning = <span class=\"string\">\"ret\"</span>, pointcut = <span class=\"string\">\"webLog()\"</span>)</div><div class=\"line\">    public void doAfterReturning(Object ret) throws Throwable &#123;</div><div class=\"line\">        // å¤„ç†å®Œè¯·æ±‚ï¼Œè¿”å›å†…å®¹</div><div class=\"line\">        logger.info(<span class=\"string\">\"RESPONSE : \"</span> + ret);</div><div class=\"line\">        logger.info(<span class=\"string\">\"SPEND TIME : \"</span> + (System.currentTimeMillis() - startTime.get()));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h1 id=\"AOPåˆ‡é¢çš„ä¼˜å…ˆçº§\"><a href=\"#AOPåˆ‡é¢çš„ä¼˜å…ˆçº§\" class=\"headerlink\" title=\"AOPåˆ‡é¢çš„ä¼˜å…ˆçº§\"></a>AOPåˆ‡é¢çš„ä¼˜å…ˆçº§</h1><p>ç”±äºé€šè¿‡AOPå®ç°ï¼Œç¨‹åºå¾—åˆ°äº†å¾ˆå¥½çš„è§£è€¦ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬å¯èƒ½ä¼šå¯¹Webå±‚åšå¤šä¸ªåˆ‡é¢ï¼Œæ ¡éªŒç”¨æˆ·ï¼Œ<br>æ ¡éªŒå¤´ä¿¡æ¯ç­‰ç­‰ï¼Œè¿™ä¸ªæ—¶å€™ç»å¸¸ä¼šç¢°åˆ°åˆ‡é¢çš„å¤„ç†é¡ºåºé—®é¢˜ã€‚</p>\n<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ¯ä¸ªåˆ‡é¢çš„ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬éœ€è¦@Order(i)æ³¨è§£æ¥æ ‡è¯†åˆ‡é¢çš„ä¼˜å…ˆçº§ã€‚içš„å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚<br>å‡è®¾æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªåˆ‡é¢æ˜¯CheckNameAspectç”¨æ¥æ ¡éªŒnameå¿…é¡»ä¸ºdidiï¼Œæˆ‘ä»¬ä¸ºå…¶è®¾ç½®@Order(10)ï¼Œ<br>è€Œä¸Šæ–‡ä¸­WebLogAspectè®¾ç½®ä¸º@Order(5)ï¼Œæ‰€ä»¥WebLogAspectæœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š</p>\n<p>åœ¨@Beforeä¸­ä¼˜å…ˆæ‰§è¡Œ@Order(5)çš„å†…å®¹ï¼Œå†æ‰§è¡Œ@Order(10)çš„å†…å®¹<br>åœ¨@Afterå’Œ@AfterReturningä¸­ä¼˜å…ˆæ‰§è¡Œ@Order(10)çš„å†…å®¹ï¼Œå†æ‰§è¡Œ@Order(5)çš„å†…å®¹<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å­æ€»ç»“ï¼š</p>\n<p>åœ¨åˆ‡å…¥ç‚¹å‰çš„æ“ä½œï¼ŒæŒ‰orderçš„å€¼ç”±å°åˆ°å¤§æ‰§è¡Œ<br>åœ¨åˆ‡å…¥ç‚¹åçš„æ“ä½œï¼ŒæŒ‰orderçš„å€¼ç”±å¤§åˆ°å°æ‰§è¡Œ</p>\n"},{"title":"Docker åº”ç”¨","url":"https://yangzhiw.github.io/2016/07/27/Docker-åº”ç”¨/","content":"<h1 id=\"åº”ç”¨Dockeréƒ¨ç½²\"><a href=\"#åº”ç”¨Dockeréƒ¨ç½²\" class=\"headerlink\" title=\"åº”ç”¨Dockeréƒ¨ç½²\"></a>åº”ç”¨Dockeréƒ¨ç½²</h1><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªDockerfileæ–‡ä»¶<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">FROM maven:<span class=\"number\">3.3</span><span class=\"number\">.3</span>  </div><div class=\"line\">  </div><div class=\"line\">ADD pom.xml /tmp/build/  </div><div class=\"line\">RUN cd /tmp/build &amp;&amp; mvn -q dependency:resolve  </div><div class=\"line\">  </div><div class=\"line\">ADD src /tmp/build/src  </div><div class=\"line\">        <span class=\"comment\">#æ„å»ºåº”ç”¨  </span></div><div class=\"line\">RUN cd /tmp/build &amp;&amp; mvn -q -DskipTests=<span class=\"literal\">true</span> package \\  </div><div class=\"line\">        <span class=\"comment\">#æ‹·è´ç¼–è¯‘ç»“æœåˆ°æŒ‡å®šç›®å½•  </span></div><div class=\"line\">        &amp;&amp; mv target/*.jar /app.jar \\  </div><div class=\"line\">        <span class=\"comment\">#æ¸…ç†ç¼–è¯‘ç—•è¿¹  </span></div><div class=\"line\">        &amp;&amp; cd / &amp;&amp; rm -rf /tmp/build  </div><div class=\"line\">  </div><div class=\"line\">VOLUME /tmp  </div><div class=\"line\">EXPOSE <span class=\"number\">8080</span>  </div><div class=\"line\">ENTRYPOINT [<span class=\"string\">\"java\"</span>,<span class=\"string\">\"-Djava.security.egd=file:/dev/./urandom\"</span>,<span class=\"string\">\"-jar\"</span>,<span class=\"string\">\"/app.jar\"</span>]</div></pre></td></tr></table></figure></p>\n<p>å› ä¸º Spring Boot æ¡†æ¶æ‰“åŒ…çš„åº”ç”¨æ˜¯ä¸€ä¸ªåŒ…å«ä¾èµ–çš„ jar æ–‡ä»¶ï¼Œå†…åµŒäº† Tomcat å’Œ Jetty æ”¯æŒï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨åŒ…å« Java<br>çš„ Maven é•œåƒå³å¯ï¼Œä¸éœ€è¦ Tomcat é•œåƒã€‚<br>ä¸ºäº†å‡å°‘é•œåƒå¤§å°ï¼Œåœ¨æ‰§è¡Œ Maven æ„å»ºä¹‹åï¼Œæ¸…ç†äº†æ„å»ºç—•è¿¹ã€‚<br>åœ¨ Dockerfile æ–‡ä»¶çš„æœ€åï¼Œä½¿ç”¨ ENTRYPOINT æŒ‡ä»¤æ‰§è¡Œå¯åŠ¨ Java åº”ç”¨çš„æ“ä½œã€‚</p>\n<h1 id=\"æ„å»º-Docker-é•œåƒ\"><a href=\"#æ„å»º-Docker-é•œåƒ\" class=\"headerlink\" title=\"æ„å»º Docker é•œåƒ\"></a>æ„å»º Docker é•œåƒ</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker build -t docker-demo-spring-boot .   ï¼ï¼æ³¨æ„åé¢çš„ . è¡¨ç¤ºå½“å‰è·¯å¾„ä¸‹</div></pre></td></tr></table></figure>\n<h1 id=\"ä»é•œåƒå¯åŠ¨å®¹å™¨\"><a href=\"#ä»é•œåƒå¯åŠ¨å®¹å™¨\" class=\"headerlink\" title=\"ä»é•œåƒå¯åŠ¨å®¹å™¨\"></a>ä»é•œåƒå¯åŠ¨å®¹å™¨</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker run -d -p <span class=\"number\">8080</span>:<span class=\"number\">8080</span> docker-demo-spring-boot</div></pre></td></tr></table></figure>\n<h1 id=\"å®Œæˆéƒ¨ç½²ï¼š\"><a href=\"#å®Œæˆéƒ¨ç½²ï¼š\" class=\"headerlink\" title=\"å®Œæˆéƒ¨ç½²ï¼š\"></a>å®Œæˆéƒ¨ç½²ï¼š</h1><p>URLè®¿é—®ï¼Œå¯é€šè¿‡docker ipæŸ¥çœ‹åº”ç”¨çš„è™šæ‹Ÿåœ°å€ã€‚</p>\n<h1 id=\"Docker-Composeç¼–æ’\"><a href=\"#Docker-Composeç¼–æ’\" class=\"headerlink\" title=\"Docker Composeç¼–æ’\"></a>Docker Composeç¼–æ’</h1><p>Docker Composeæ˜¯ç”¨äºå®šä¹‰å’Œç»„è£…è¿è¡Œå¤šå®¹å™¨åˆ†å¸ƒå¼åº”ç”¨çš„å·¥å…·ï¼Œ<br>å®ƒæä¾›ä¸€ä¸ªç®€å•çš„åŸºäºYAMLè¯­è¨€çš„dockerï¼compose.ymlé…ç½®æ–‡ä»¶ã€‚ é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨dockerå®šä¹‰å’Œè¿è¡Œå¤æ‚çš„åº”ç”¨ï¼Œ<br>ä½¿ç”¨docker composeï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œå®šä¹‰å¤šå®¹å™¨åº”ç”¨çš„å¯åŠ¨é¡ºåºï¼Œèµ·åˆ°æœåŠ¡ç¼–æ’çš„ä½œç”¨ã€‚</p>\n<h2 id=\"ç¼–å†™-docker-compose-yaml-æ–‡ä»¶\"><a href=\"#ç¼–å†™-docker-compose-yaml-æ–‡ä»¶\" class=\"headerlink\" title=\"ç¼–å†™ docker-compose.yaml æ–‡ä»¶\"></a>ç¼–å†™ docker-compose.yaml æ–‡ä»¶</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attr\">web:</span>  </div><div class=\"line\"><span class=\"attr\">  build:</span> .  </div><div class=\"line\"><span class=\"attr\">  ports:</span>  </div><div class=\"line\"><span class=\"bullet\">    -</span> <span class=\"string\">\"8080:8080\"</span>  </div><div class=\"line\"><span class=\"attr\">  links:</span>  </div><div class=\"line\"><span class=\"attr\">    - mongodb:</span>mongodb  </div><div class=\"line\">  </div><div class=\"line\"><span class=\"attr\">mongodb:</span>  </div><div class=\"line\"><span class=\"attr\">  image:</span> daocloud.io/library/mongo:latest  </div><div class=\"line\"><span class=\"attr\">  ports:</span>  </div><div class=\"line\"><span class=\"bullet\">    -</span> <span class=\"string\">\"27017:27017\"</span></div></pre></td></tr></table></figure>\n<p>è¿™é‡Œä»¥MongoDBæ•°æ®åº“æä¾›æœåŠ¡çš„demoï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šäºäº†ä¸¤ä¸ªæœåŠ¡ï¼š</p>\n<pre><code>åŸºäºæˆ‘ä»¬åº”ç”¨æ„å»ºçš„ docker-demo-java-mongo é•œåƒï¼Œç”¨æ¥æä¾› Web æœåŠ¡\nåŸºäº DaoCloud æä¾›çš„ MongoDB é•œåƒï¼Œæä¾›å­˜å‚¨æœåŠ¡\né€šè¿‡ links ä¸º web å…³è” mongo æœåŠ¡\n</code></pre><h2 id=\"å¯åŠ¨-Docker-Compose\"><a href=\"#å¯åŠ¨-Docker-Compose\" class=\"headerlink\" title=\"å¯åŠ¨ Docker Compose\"></a>å¯åŠ¨ Docker Compose</h2><pre><code class=\"yaml\">docker-compose up\n</code></pre>\n"},{"title":"spring Boot Cloud2","url":"https://yangzhiw.github.io/2016/07/27/spring-Boot-Cloud2/","content":"<h1 id=\"Spring-Cloudä»‹ç»\"><a href=\"#Spring-Cloudä»‹ç»\" class=\"headerlink\" title=\"Spring Cloudä»‹ç»\"></a>Spring Cloudä»‹ç»</h1><p>Spring Cloudæ˜¯ä¸€ä¸ªåŸºäºSpring Bootå®ç°çš„äº‘åº”ç”¨å¼€å‘å·¥å…·ï¼Œå®ƒä¸ºåŸºäºJVMçš„äº‘åº”ç”¨å¼€å‘ä¸­çš„é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€<br>æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æ§åˆ¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯å’Œé›†ç¾¤çŠ¶æ€ç®¡ç†ç­‰æ“ä½œæä¾›äº†ä¸€ç§ç®€å•çš„å¼€å‘æ–¹å¼ã€‚</p>\n<h1 id=\"Spring-Cloudä¸Dubboå¯¹æ¯”\"><a href=\"#Spring-Cloudä¸Dubboå¯¹æ¯”\" class=\"headerlink\" title=\"Spring Cloudä¸Dubboå¯¹æ¯”\"></a>Spring Cloudä¸Dubboå¯¹æ¯”</h1><p>å®ƒä»¬ä¸¤éƒ½å…·å¤‡åˆ†å¸ƒå¼æœåŠ¡æ²»ç†ç›¸å…³çš„åŠŸèƒ½ï¼Œéƒ½èƒ½å¤Ÿæä¾›æœåŠ¡æ³¨å†Œã€å‘ç°ã€è·¯ç”±ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚è¯´åˆ°è¿™ï¼ŒDubboçš„åŠŸèƒ½å¥½åƒ<br>ä¹Ÿå°±è¿™ä¹ˆå¤šäº†ï¼Œä½†æ˜¯Spring Cloudæ˜¯æä¾›äº†ä¸€æ•´å¥—ä¼ä¸šçº§åˆ†å¸ƒå¼äº‘åº”ç”¨çš„å®Œç¾è§£å†³æ–¹æ¡ˆï¼Œèƒ½å¤Ÿç»“åˆSpring Bootï¼Œ<br>Dockerå®ç°å¿«é€Ÿå¼€å‘çš„ç›®çš„ï¼Œæ‰€ä»¥è¯´Dubboåªæœ‰Spring Cloudçš„ä¸€éƒ¨åˆ†RPCåŠŸèƒ½ï¼Œè€Œä¸”ä¹Ÿè°ˆä¸ä¸Šè°å¥½è°åã€‚ä¸è¿‡ï¼Œ<br>Dubboé¡¹ç›®ç°å·²åœæ­¢äº†æ›´æ–°ï¼Œæ·˜å®å†…éƒ¨ç”±hsfæ›¿ä»£dubboï¼Œæˆ‘æƒ³è¿™ä¼šæœ‰æ›´å¤šäººå€¾å‘Spring Cloudäº†ã€‚<br>ä»å¼€å‘è§’åº¦ä¸Šè¯´ï¼ŒDubboå¸¸ä¸Springã€zookeeperç»“åˆï¼Œè€Œä¸”å®ç°åªæ˜¯é€šè¿‡xmlæ¥é…ç½®æœåŠ¡åœ°å€ã€åç§°ã€ç«¯å£ï¼Œ<br>ä»£ç çš„ä¾µå…¥æ€§æ˜¯å¾ˆå°çš„ï¼Œç›¸å¯¹Spring Cloudï¼Œå®ƒçš„å®ç°éœ€è¦ç±»æ³¨è§£ç­‰ï¼Œå¤šå°‘å…·æœ‰ä¸€å®šä¾µå…¥æ€§ã€‚</p>\n<h1 id=\"Spring-Cloudå­é¡¹ç›®\"><a href=\"#Spring-Cloudå­é¡¹ç›®\" class=\"headerlink\" title=\"Spring Cloudå­é¡¹ç›®\"></a>Spring Cloudå­é¡¹ç›®</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">Spring CloudåŒ…å«äº†å¤šä¸ªå­é¡¹ç›®ï¼ˆé’ˆå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ¶‰åŠçš„å¤šä¸ªä¸åŒå¼€æºäº§å“ï¼‰ï¼Œä¹‹å‰åœ¨ç¬¬ä¸€ç« èŠ‚ä¹Ÿä»‹ç»è¿™äº›ï¼Œ</div><div class=\"line\">æ¯”å¦‚ï¼šSpring Cloud Configã€Spring Cloud Netflixã€Spring Cloud CloudFoundryã€Spring Cloud AWSã€</div><div class=\"line\">Spring Cloud Securityã€Spring Cloud Commonsã€Spring Cloud Zookeeperã€Spring Cloud CLIç­‰é¡¹ç›®ã€‚</div></pre></td></tr></table></figure>\n<h2 id=\"é…ç½®æœåŠ¡\"><a href=\"#é…ç½®æœåŠ¡\" class=\"headerlink\" title=\"é…ç½®æœåŠ¡\"></a>é…ç½®æœåŠ¡</h2><p>Spring Cloudé€šè¿‡Netflix OSSçš„Eurekaæ¥å®ç°æœåŠ¡å‘ç°ï¼ŒæœåŠ¡å‘ç°çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è®©æ¯ä¸ªæœåŠ¡ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ã€‚<br>Eureka Serverä¸ºå¾®æœåŠ¡çš„æ³¨å†Œä¸­å¿ƒã€‚è°ˆåˆ°Spring Cloud Netflixï¼Œå®ƒæ˜¯Spring Cloudçš„å­é¡¹ç›®ä¹‹ä¸€ï¼Œä¸»è¦æä¾›çš„æ¨¡å—åŒ…æ‹¬ï¼š<br>æœåŠ¡å‘ç°ï¼ˆEurekaï¼‰ï¼Œæ–­è·¯å™¨ï¼ˆHystrixï¼‰ï¼Œæ™ºèƒ½è·¯ç”±ï¼ˆZuulï¼‰ï¼Œå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼ˆRibbonï¼‰ç­‰ã€‚<br>Spring Cloudä½¿ç”¨æ³¨è§£çš„æ–¹å¼æä¾›äº†EurekaæœåŠ¡ç«¯ï¼ˆ@EnableEurekaServerï¼‰å’Œå®¢æˆ·ç«¯ï¼ˆ@EnableEurekaClientï¼‰ã€‚</p>\n<h2 id=\"è·¯ç”±ç½‘å…³\"><a href=\"#è·¯ç”±ç½‘å…³\" class=\"headerlink\" title=\"è·¯ç”±ç½‘å…³\"></a>è·¯ç”±ç½‘å…³</h2><p>è·¯ç”±ç½‘å…³çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è®©æ‰€æœ‰çš„å¾®æœåŠ¡å¯¹å¤–åªæœ‰ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬åªéœ€è®¿é—®ä¸€ä¸ªç½‘å…³åœ°å€ï¼Œå³å¯ç”±ç½‘å…³å°†æ‰€æœ‰çš„è¯·æ±‚ä»£ç†<br>åˆ°ä¸åŒçš„æœåŠ¡ä¸­ã€‚Spring Cloudæ˜¯é€šè¿‡Zuulæ¥å®ç°çš„ï¼Œæ”¯æŒè‡ªåŠ¨è·¯ç”±æ˜ å°„åˆ°åœ¨Eureka Serverä¸Šæ³¨å†Œçš„æœåŠ¡ã€‚<br>Spring Cloudæä¾›äº†æ³¨è§£@EnableZuulProxyæ¥å¯ç”¨è·¯ç”±ä»£ç†ã€‚</p>\n<h2 id=\"è´Ÿè½½å‡è¡¡\"><a href=\"#è´Ÿè½½å‡è¡¡\" class=\"headerlink\" title=\"è´Ÿè½½å‡è¡¡\"></a>è´Ÿè½½å‡è¡¡</h2><p>Spring Cloudæä¾›äº†Ribbonå’ŒFeignä½œä¸ºå®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚åœ¨Spring Cloudä¸‹ï¼Œä½¿ç”¨Ribbonç›´æ¥æ³¨å…¥ä¸€ä¸ªRestTemplate<br>å¯¹è±¡å³å¯ï¼Œæ­¤RestTemplateå·²åšå¥½è´Ÿè½½å‡è¡¡çš„é…ç½®ï¼›è€Œä½¿ç”¨Feignåªéœ€å®šä¹‰ä¸ªæ³¨è§£ï¼Œæœ‰@FeignClientæ³¨è§£çš„æ¥å£ï¼Œ<br>ç„¶åä½¿ç”¨@RequestMappingæ³¨è§£åœ¨æ–¹æ³•ä¸Šæ˜ å°„è¿œç¨‹çš„RESTæœåŠ¡ï¼Œæ­¤æ–¹æ³•ä¹Ÿæ˜¯åšå¥½äº†è´Ÿè½½å‡è¡¡é…ç½®ã€‚</p>\n<h2 id=\"è·¯æ–­å™¨\"><a href=\"#è·¯æ–­å™¨\" class=\"headerlink\" title=\"è·¯æ–­å™¨\"></a>è·¯æ–­å™¨</h2><p>æ–­è·¯å™¨ï¼ˆCircuit Breakerï¼‰ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å½“æŸä¸ªæ–¹æ³•è°ƒç”¨å¤±è´¥çš„æ—¶å€™ï¼Œè°ƒç”¨åå¤‡æ–¹æ³•æ¥æ›¿ä»£å¤±è´¥çš„æ–¹æ³•ï¼Œ<br>å·²è¾¾åˆ°å®¹é”™ï¼é˜»æ­¢çº§è”é”™è¯¯çš„åŠŸèƒ½ã€‚Spring Cloudä½¿ç”¨@EnableCircuitBreakeræ¥å¯ç”¨æ–­è·¯å™¨æ”¯æŒï¼Œ<br>ä½¿ç”¨@HystrixCommandçš„fallbackMethodæ¥æŒ‡å®šåå¤‡æ–¹æ³•ã€‚ï¼ˆ@HystrixCommand(fallbackMethod=â€fallbackOperâ€)ï¼‰<br>Spring Cloudè¿˜æä¾›äº†ä¸€ä¸ªæ§åˆ¶å°æ¥ç›‘æ§æ–­è·¯å™¨çš„è¿è¡Œæƒ…å†µï¼Œé€šè¿‡@EnableHystrixDashboardæ³¨è§£å¼€å¯ã€‚</p>\n<p>Spring Cloudä¾èµ–<br><img src=\"/2016/07/27/spring-Boot-Cloud2/spring_cloud.jpg\" alt=\"spring_cloud\" title=\"spring_cloud\"></p>\n"},{"title":"spring Boot Cloud å­¦ä¹ 1","url":"https://yangzhiw.github.io/2016/07/27/spring-Boot-Cloud/","content":"<h1 id=\"Spring-ç®€ä»‹\"><a href=\"#Spring-ç®€ä»‹\" class=\"headerlink\" title=\"Spring ç®€ä»‹\"></a>Spring ç®€ä»‹</h1><img src=\"/2016/07/27/spring-Boot-Cloud/Spring.jpg\" alt=\"Spring Project\" title=\"Spring Project\">\n<p>Spring IO platform:ç”¨äºç³»ç»Ÿéƒ¨ç½²ï¼Œæ˜¯å¯é›†æˆçš„ï¼Œæ„å»ºç°ä»£åŒ–åº”ç”¨çš„ç‰ˆæœ¬å¹³å°ï¼Œå…·ä½“æ¥è¯´å½“ä½ ä½¿ç”¨maven dependencyå¼•å…¥spring jaråŒ…æ—¶å®ƒå°±åœ¨å·¥ä½œäº†ã€‚</p>\n<p>Spring Boot:æ—¨åœ¨ç®€åŒ–åˆ›å»ºäº§å“çº§çš„ Spring åº”ç”¨å’ŒæœåŠ¡ï¼Œç®€åŒ–äº†é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨åµŒå…¥å¼webæœåŠ¡å™¨ï¼Œå«æœ‰è¯¸å¤šå¼€ç®±å³ç”¨å¾®æœåŠ¡åŠŸèƒ½ï¼Œå¯ä»¥å’Œspring cloudè”åˆéƒ¨ç½²ã€‚</p>\n<p>Spring Framework:å³é€šå¸¸æ‰€è¯´çš„spring æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„Java/Java EEå…¨åŠŸèƒ½æ ˆåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå…¶å®ƒspringé¡¹ç›®å¦‚spring bootä¹Ÿä¾èµ–äºæ­¤æ¡†æ¶ã€‚</p>\n<p>Spring Cloudï¼šå¾®æœåŠ¡å·¥å…·åŒ…ï¼Œä¸ºå¼€å‘è€…æä¾›äº†åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æ§åˆ¶æ€»çº¿ç­‰å¼€å‘å·¥å…·åŒ…ã€‚</p>\n<p>Spring XDï¼šæ˜¯ä¸€ç§è¿è¡Œæ—¶ç¯å¢ƒï¼ˆæœåŠ¡å™¨è½¯ä»¶ï¼Œéå¼€å‘æ¡†æ¶ï¼‰ï¼Œç»„åˆspringæŠ€æœ¯ï¼Œå¦‚spring batchã€spring bootã€spring dataï¼Œé‡‡é›†å¤§æ•°æ®å¹¶å¤„ç†ã€‚</p>\n<p>Spring Dataï¼šæ˜¯ä¸€ä¸ªæ•°æ®è®¿é—®åŠæ“ä½œçš„å·¥å…·åŒ…ï¼Œå°è£…äº†å¾ˆå¤šç§æ•°æ®åŠæ•°æ®åº“çš„è®¿é—®ç›¸å…³æŠ€æœ¯ï¼ŒåŒ…æ‹¬ï¼šjdbcã€Redisã€MongoDBã€Neo4jç­‰ã€‚</p>\n<p>Spring Batchï¼šæ‰¹å¤„ç†æ¡†æ¶ï¼Œæˆ–è¯´æ˜¯æ‰¹é‡ä»»åŠ¡æ‰§è¡Œç®¡ç†å™¨ï¼ŒåŠŸèƒ½åŒ…æ‹¬ä»»åŠ¡è°ƒåº¦ã€æ—¥å¿—è®°å½•/è·Ÿè¸ªç­‰ã€‚</p>\n<p>Spring Securityï¼šæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä¸ºåŸºäºSpringçš„ä¼ä¸šåº”ç”¨ç³»ç»Ÿæä¾›å£°æ˜å¼çš„å®‰å…¨è®¿é—®æ§åˆ¶è§£å†³æ–¹æ¡ˆçš„å®‰å…¨æ¡†æ¶ã€‚</p>\n<p>Spring Integrationï¼šé¢å‘ä¼ä¸šåº”ç”¨é›†æˆï¼ˆEAI/ESBï¼‰çš„ç¼–ç¨‹æ¡†æ¶ï¼Œæ”¯æŒçš„é€šä¿¡æ–¹å¼åŒ…æ‹¬HTTPã€FTPã€TCP/UDPã€JMSã€RabbitMQã€Emailç­‰ã€‚</p>\n<p>Spring Socialï¼šä¸€ç»„å·¥å…·åŒ…ï¼Œä¸€ç»„è¿æ¥ç¤¾äº¤æœåŠ¡APIï¼Œå¦‚Twitterã€Facebookã€LinkedInã€GitHubç­‰ï¼Œæœ‰å‡ åä¸ªã€‚</p>\n<p>Spring AMQPï¼šæ¶ˆæ¯é˜Ÿåˆ—æ“ä½œçš„å·¥å…·åŒ…ï¼Œä¸»è¦æ˜¯å°è£…äº†RabbitMQçš„æ“ä½œã€‚</p>\n<p>Spring HATEOASï¼šæ˜¯ä¸€ä¸ªç”¨äºæ”¯æŒå®ç°è¶…æ–‡æœ¬é©±åŠ¨çš„ REST Web æœåŠ¡çš„å¼€å‘åº“ã€‚</p>\n<p>Spring Mobileï¼šæ˜¯Spring MVCçš„æ‰©å±•ï¼Œç”¨æ¥ç®€åŒ–æ‰‹æœºä¸Šçš„Webåº”ç”¨å¼€å‘ã€‚</p>\n<p>Spring for Androidï¼šæ˜¯Springæ¡†æ¶çš„ä¸€ä¸ªæ‰©å±•ï¼Œå…¶ä¸»è¦ç›®çš„åœ¨ä¹ç®€åŒ–Androidæœ¬åœ°åº”ç”¨çš„å¼€å‘ï¼Œæä¾›RestTemplateæ¥è®¿é—®RestæœåŠ¡ã€‚</p>\n<p>Spring Web Flowï¼šç›®æ ‡æ˜¯æˆä¸ºç®¡ç†Webåº”ç”¨é¡µé¢æµç¨‹çš„æœ€ä½³æ–¹æ¡ˆï¼Œå°†é¡µé¢è·³è½¬æµç¨‹å•ç‹¬ç®¡ç†ï¼Œå¹¶å¯é…ç½®ã€‚</p>\n<p>Spring LDAPï¼šæ˜¯ä¸€ä¸ªç”¨äºæ“ä½œLDAPçš„Javaå·¥å…·åŒ…ï¼ŒåŸºäºSpringçš„JdbcTemplateæ¨¡å¼ï¼Œç®€åŒ–LDAPè®¿é—®ã€‚</p>\n<p>Spring Sessionï¼šsessionç®¡ç†çš„å¼€å‘å·¥å…·åŒ…ï¼Œè®©ä½ å¯ä»¥æŠŠsessionä¿å­˜åˆ°redisç­‰ï¼Œè¿›è¡Œé›†ç¾¤åŒ–sessionç®¡ç†ã€‚</p>\n<p>Spring Web Servicesï¼šæ˜¯åŸºäºSpringçš„WebæœåŠ¡æ¡†æ¶ï¼Œæä¾›SOAPæœåŠ¡å¼€å‘ï¼Œå…è®¸é€šè¿‡å¤šç§æ–¹å¼åˆ›å»ºWebæœåŠ¡ã€‚</p>\n<p>Spring Shellï¼šæä¾›äº¤äº’å¼çš„Shellå¯è®©ä½ ä½¿ç”¨ç®€å•çš„åŸºäºSpringçš„ç¼–ç¨‹æ¨¡å‹æ¥å¼€å‘å‘½ä»¤ï¼Œæ¯”å¦‚Spring Rooå‘½ä»¤ã€‚</p>\n<p>Spring Rooï¼šæ˜¯ä¸€ç§Springå¼€å‘çš„è¾…åŠ©å·¥å…·ï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œæ¥ç”Ÿæˆè‡ªåŠ¨åŒ–é¡¹ç›®ï¼Œæ“ä½œéå¸¸ç±»ä¼¼äºRailsã€‚</p>\n<p>Spring Scalaï¼šä¸ºScalaè¯­è¨€ç¼–ç¨‹æä¾›çš„springæ¡†æ¶çš„å°è£…ï¼ˆæ–°çš„ç¼–ç¨‹è¯­è¨€ï¼ŒJavaå¹³å°çš„Scalaäº2003å¹´åº•/2004å¹´åˆå‘å¸ƒï¼‰ã€‚</p>\n<p>Spring BlazeDS Integrationï¼šä¸€ä¸ªå¼€å‘RIAå·¥å…·åŒ…ï¼Œå¯ä»¥é›†æˆAdobe Flexã€BlazeDSã€Springä»¥åŠJavaæŠ€æœ¯åˆ›å»ºRIAã€‚</p>\n<p>Spring Loadedï¼šç”¨äºå®ç°javaç¨‹åºå’Œwebåº”ç”¨çš„çƒ­éƒ¨ç½²çš„å¼€æºå·¥å…·ã€‚</p>\n<p>Spring REST Shellï¼šå¯ä»¥è°ƒç”¨RestæœåŠ¡çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ•²å‘½ä»¤è¡Œæ“ä½œRestæœåŠ¡ã€‚</p>\n<a id=\"more\"></a>\n<h1 id=\"Spring-Cloud-é¡¹ç›®\"><a href=\"#Spring-Cloud-é¡¹ç›®\" class=\"headerlink\" title=\"Spring Cloud é¡¹ç›®\"></a>Spring Cloud é¡¹ç›®</h1><p>ç›®å‰æ¥è¯´springä¸»è¦é›†ä¸­äºspring bootï¼ˆç”¨äºå¼€å‘å¾®æœåŠ¡ï¼‰å’Œspring cloudç›¸å…³æ¡†æ¶çš„å¼€å‘ï¼Œæˆ‘ä»¬ä»å‡ å¼ å›¾ç€æ‰‹ç†è§£ï¼Œç„¶åå†å…·ä½“ä»‹ç»</p>\n<img src=\"/2016/07/27/spring-Boot-Cloud/spring_cloud.jpg\" alt=\"å¾®æœåŠ¡æ¶æ„å›¾\" title=\"å¾®æœåŠ¡æ¶æ„å›¾\">\n<img src=\"/2016/07/27/spring-Boot-Cloud/cloud.jpg\" alt=\"å¾®æœåŠ¡æ¶æ„è¿è¡Œå›¾\" title=\"å¾®æœåŠ¡æ¶æ„è¿è¡Œå›¾\">\n<p>spring cloudå­é¡¹ç›®åŒ…æ‹¬ï¼š</p>\n<p>1, Spring Cloud Configï¼šé…ç½®ç®¡ç†å¼€å‘å·¥å…·åŒ…ï¼Œå¯ä»¥è®©ä½ æŠŠé…ç½®æ”¾åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œç›®å‰æ”¯æŒæœ¬åœ°å­˜å‚¨ã€Gitä»¥åŠSubversionã€‚</p>\n<p>2, Spring Cloud Busï¼šäº‹ä»¶ã€æ¶ˆæ¯æ€»çº¿ï¼Œç”¨äºåœ¨é›†ç¾¤ï¼ˆä¾‹å¦‚ï¼Œé…ç½®å˜åŒ–äº‹ä»¶ï¼‰ä¸­ä¼ æ’­çŠ¶æ€å˜åŒ–ï¼Œå¯ä¸Spring Cloud Configè”åˆå®ç°çƒ­éƒ¨ç½²ã€‚</p>\n<p>3, Spring Cloud Netflixï¼šé’ˆå¯¹å¤šç§Netflixç»„ä»¶æä¾›çš„å¼€å‘å·¥å…·åŒ…ï¼Œå…¶ä¸­åŒ…æ‹¬Eurekaã€Hystrixã€Zuulã€Archaiusç­‰ã€‚</p>\n<p>3.1, Netflix Eurekaï¼šäº‘ç«¯è´Ÿè½½å‡è¡¡ï¼Œä¸€ä¸ªåŸºäº REST çš„æœåŠ¡ï¼Œç”¨äºå®šä½æœåŠ¡ï¼Œä»¥å®ç°äº‘ç«¯çš„è´Ÿè½½å‡è¡¡å’Œä¸­é—´å±‚æœåŠ¡å™¨çš„æ•…éšœè½¬ç§»ã€‚</p>\n<p>3.2, Netflix Hystrixï¼šå®¹é”™ç®¡ç†å·¥å…·ï¼Œæ—¨åœ¨é€šè¿‡æ§åˆ¶æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„èŠ‚ç‚¹,ä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ›ã€‚</p>\n<p>3.3, Netflix Zuulï¼šè¾¹ç¼˜æœåŠ¡å·¥å…·ï¼Œæ˜¯æä¾›åŠ¨æ€è·¯ç”±ï¼Œç›‘æ§ï¼Œå¼¹æ€§ï¼Œå®‰å…¨ç­‰çš„è¾¹ç¼˜æœåŠ¡ã€‚</p>\n<p>3.4, Netflix Archaiusï¼šé…ç½®ç®¡ç†APIï¼ŒåŒ…å«ä¸€ç³»åˆ—é…ç½®ç®¡ç†APIï¼Œæä¾›åŠ¨æ€ç±»å‹åŒ–å±æ€§ã€çº¿ç¨‹å®‰å…¨é…ç½®æ“ä½œã€è½®è¯¢æ¡†æ¶ã€å›è°ƒæœºåˆ¶ç­‰åŠŸèƒ½ã€‚</p>\n<p>4, Spring Cloud for Cloud Foundryï¼šé€šè¿‡Oauth2åè®®ç»‘å®šæœåŠ¡åˆ°CloudFoundryï¼ŒCloudFoundryæ˜¯VMwareæ¨å‡ºçš„å¼€æºPaaSäº‘å¹³å°ã€‚</p>\n<p>5, Spring Cloud Sleuthï¼šæ—¥å¿—æ”¶é›†å·¥å…·åŒ…ï¼Œå°è£…äº†Dapper,Zipkinå’ŒHTraceæ“ä½œã€‚</p>\n<p>6, Spring Cloud Data Flowï¼šå¤§æ•°æ®æ“ä½œå·¥å…·ï¼Œé€šè¿‡å‘½ä»¤è¡Œæ–¹å¼æ“ä½œæ•°æ®æµã€‚</p>\n<p>7, Spring Cloud Securityï¼šå®‰å…¨å·¥å…·åŒ…ï¼Œä¸ºä½ çš„åº”ç”¨ç¨‹åºæ·»åŠ å®‰å…¨æ§åˆ¶ï¼Œä¸»è¦æ˜¯æŒ‡OAuth2ã€‚</p>\n<p>8, Spring Cloud Consulï¼šå°è£…äº†Consulæ“ä½œï¼Œconsulæ˜¯ä¸€ä¸ªæœåŠ¡å‘ç°ä¸é…ç½®å·¥å…·ï¼Œä¸Dockerå®¹å™¨å¯ä»¥æ— ç¼é›†æˆã€‚</p>\n<p>9, Spring Cloud Zookeeperï¼šæ“ä½œZookeeperçš„å·¥å…·åŒ…ï¼Œç”¨äºä½¿ç”¨zookeeperæ–¹å¼çš„æœåŠ¡æ³¨å†Œå’Œå‘ç°ã€‚</p>\n<p>10, Spring Cloud Streamï¼šæ•°æ®æµæ“ä½œå¼€å‘åŒ…ï¼Œå°è£…äº†ä¸Redis,Rabbitã€Kafkaç­‰å‘é€æ¥æ”¶æ¶ˆæ¯ã€‚</p>\n<p>11, Spring Cloud CLIï¼šåŸºäº Spring Boot CLIï¼Œå¯ä»¥è®©ä½ ä»¥å‘½ä»¤è¡Œæ–¹å¼å¿«é€Ÿå»ºç«‹äº‘ç»„ä»¶ã€‚</p>\n"},{"title":"markDown çš„ä½¿ç”¨","url":"https://yangzhiw.github.io/2016/07/22/markDown/","content":"<h1 id=\"æ ‡é¢˜\"><a href=\"#æ ‡é¢˜\" class=\"headerlink\" title=\"æ ‡é¢˜\"></a>æ ‡é¢˜</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># ä¸€çº§æ ‡é¢˜</span></div><div class=\"line\"><span class=\"comment\">## äºŒçº§æ ‡é¢˜</span></div><div class=\"line\">ä¾æ¬¡ç±»æ¨</div></pre></td></tr></table></figure>\n<h1 id=\"åˆ—è¡¨\"><a href=\"#åˆ—è¡¨\" class=\"headerlink\" title=\"åˆ—è¡¨\"></a>åˆ—è¡¨</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">åœ¨ Markdown ä¸‹ï¼Œåˆ—è¡¨çš„æ˜¾ç¤ºåªéœ€è¦åœ¨æ–‡å­—å‰åŠ ä¸Š - æˆ– * å³å¯å˜ä¸ºæ— åºåˆ—è¡¨ï¼Œ</div><div class=\"line\">æœ‰åºåˆ—è¡¨åˆ™ç›´æ¥åœ¨æ–‡å­—å‰åŠ  <span class=\"number\">1.</span> <span class=\"number\">2.</span> <span class=\"number\">3.</span> ç¬¦å·è¦å’Œæ–‡å­—ä¹‹é—´åŠ ä¸Šä¸€ä¸ªå­—ç¬¦çš„ç©ºæ ¼ã€‚</div></pre></td></tr></table></figure>\n<h1 id=\"å¼•ç”¨\"><a href=\"#å¼•ç”¨\" class=\"headerlink\" title=\"å¼•ç”¨\"></a>å¼•ç”¨</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">åªéœ€è¦åœ¨æ–‡æœ¬å‰åŠ å…¥ &gt; è¿™ç§å°–æ‹¬å·ï¼ˆå¤§äºå·ï¼‰å³å¯</div></pre></td></tr></table></figure>\n<h1 id=\"å›¾ç‰‡ä¸é“¾æ¥\"><a href=\"#å›¾ç‰‡ä¸é“¾æ¥\" class=\"headerlink\" title=\"å›¾ç‰‡ä¸é“¾æ¥\"></a>å›¾ç‰‡ä¸é“¾æ¥</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">æ’å…¥é“¾æ¥ä¸æ’å…¥å›¾ç‰‡çš„è¯­æ³•å¾ˆåƒï¼ŒåŒºåˆ«åœ¨ä¸€ä¸ª !å·</div></pre></td></tr></table></figure>\n<h1 id=\"ç²—ä½“ä¸æ–œä½“\"><a href=\"#ç²—ä½“ä¸æ–œä½“\" class=\"headerlink\" title=\"ç²—ä½“ä¸æ–œä½“\"></a>ç²—ä½“ä¸æ–œä½“</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">Markdown çš„ç²—ä½“å’Œæ–œä½“ä¹Ÿéå¸¸ç®€å•ï¼Œç”¨ä¸¤ä¸ª * åŒ…å«ä¸€æ®µæ–‡æœ¬å°±æ˜¯ç²—ä½“çš„è¯­æ³•ï¼Œ</div><div class=\"line\">ç”¨ä¸€ä¸ª * åŒ…å«ä¸€æ®µæ–‡æœ¬å°±æ˜¯æ–œä½“çš„è¯­æ³•ã€‚</div></pre></td></tr></table></figure>\n<p><strong>æˆ‘åªç²—ä½“</strong>ï¼Œ<em>æˆ‘æ˜¯æ–œä½“</em>ã€‚</p>\n<h1 id=\"è¡¨æ ¼\"><a href=\"#è¡¨æ ¼\" class=\"headerlink\" title=\"è¡¨æ ¼\"></a>è¡¨æ ¼</h1><p>è¡¨æ ¼æ˜¯æˆ‘è§‰å¾— Markdown æ¯”è¾ƒç´¯äººçš„åœ°æ–¹ï¼Œä¾‹å­å¦‚ä¸‹ï¼š<br><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">| Tables        | Are           | Cool  <span class=\"string\">|</span></div><div class=\"line\">| ------------- |:-------------:| -----:|</div><div class=\"line\">| col 3 is      | right-aligned | $1600 |</div><div class=\"line\">| col 2 is      | centered      |   $12 |</div><div class=\"line\">| zebra stripes | are neat      |    $1 |</div></pre></td></tr></table></figure></p>\n<table>\n<thead>\n<tr>\n<th>Tables</th>\n<th style=\"text-align:center\">Are</th>\n<th style=\"text-align:right\">Cool</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>col 3 is</td>\n<td style=\"text-align:center\">right-aligned</td>\n<td style=\"text-align:right\">$1600</td>\n</tr>\n<tr>\n<td>col 2 is</td>\n<td style=\"text-align:center\">centered</td>\n<td style=\"text-align:right\">$12</td>\n</tr>\n<tr>\n<td>zebra stripes</td>\n<td style=\"text-align:center\">are neat</td>\n<td style=\"text-align:right\">$1</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"åˆ†å‰²çº¿\"><a href=\"#åˆ†å‰²çº¿\" class=\"headerlink\" title=\"åˆ†å‰²çº¿\"></a>åˆ†å‰²çº¿</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">åˆ†å‰²çº¿çš„è¯­æ³•åªéœ€è¦å¦èµ·ä¸€è¡Œï¼Œè¿ç»­è¾“å…¥ä¸‰ä¸ªæ˜Ÿå· *** å³å¯ã€‚</div></pre></td></tr></table></figure>\n<hr>\n<h1 id=\"ä»£ç æ¡†\"><a href=\"#ä»£ç æ¡†\" class=\"headerlink\" title=\"ä»£ç æ¡†\"></a>ä»£ç æ¡†</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">å¦‚æœä½ æ˜¯ä¸ªç¨‹åºçŒ¿ï¼Œéœ€è¦åœ¨æ–‡ç« é‡Œä¼˜é›…çš„å¼•ç”¨ä»£ç æ¡†ï¼Œåœ¨ Markdown ä¸‹å®ç°ä¹Ÿéå¸¸ç®€å•ï¼Œ</div><div class=\"line\">åªéœ€è¦ç”¨ä¸¤ä¸ª ` æŠŠä¸­é—´çš„ä»£ç åŒ…è£¹èµ·æ¥.</div><div class=\"line\"></div><div class=\"line\">å¦‚ `System.out.println()`</div></pre></td></tr></table></figure>\n<p><code>System.out.println()</code></p>\n"},{"title":"redisé›†ç¾¤æ­å»º","url":"https://yangzhiw.github.io/2016/07/22/redis-cluster/","content":"<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">æ­å»ºçš„æ˜¯ä¸€ä¸ª<span class=\"number\">1</span>ä¸»<span class=\"number\">3</span>ä»çš„redis+<span class=\"number\">3</span>ä¸ªå“¨å…µé›†ç¾¤çš„ç¯å¢ƒï¼Œç”±äºæ˜¯åœ¨ä¸€å°ç‰©ç†æœºä¸Šï¼Œæ‰€æœ‰æˆ‘ä»¬ç”¨ç«¯å£åŒºåˆ†ã€‚</div><div class=\"line\">ç‰©ç†æœºIPï¼š<span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.12</span></div><div class=\"line\">ä¸»èŠ‚ç‚¹masterç«¯å£ï¼š<span class=\"number\">6301</span></div><div class=\"line\">ä»èŠ‚ç‚¹slave1ç«¯å£ï¼š<span class=\"number\">6315</span></div><div class=\"line\">ä»èŠ‚ç‚¹slave2ç«¯å£ï¼š<span class=\"number\">6316</span></div><div class=\"line\">ä»èŠ‚ç‚¹slave3ç«¯å£ï¼š<span class=\"number\">6317</span></div><div class=\"line\">å“¨å…µsentinel1ç«¯å£ï¼š<span class=\"number\">26301</span></div><div class=\"line\">å“¨å…µsentinel2ç«¯å£ï¼š<span class=\"number\">26302</span></div><div class=\"line\">å“¨å…µsentinel3ç«¯å£ï¼š<span class=\"number\">26303</span></div></pre></td></tr></table></figure>\n<h1 id=\"ä¸‹è½½redis-amp-amp-å¤åˆ¶\"><a href=\"#ä¸‹è½½redis-amp-amp-å¤åˆ¶\" class=\"headerlink\" title=\"ä¸‹è½½redis &amp;&amp; å¤åˆ¶\"></a>ä¸‹è½½redis &amp;&amp; å¤åˆ¶</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ä¸‹è½½redisåç„¶åè§£å‹ï¼Œ</div><div class=\"line\">å¤åˆ¶ </div><div class=\"line\">cp redis-benchmark redis-cli redis-server redis-sentinel /usr/bin/ <span class=\"comment\">#è¿™ä¸ªå€’æ˜¯å¾ˆæœ‰ç”¨ï¼Œè¿™æ ·å°±ä¸ç”¨å†æ‰§è¡Œæ—¶åŠ ä¸Š./äº†ï¼Œè€Œä¸”å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ‰§è¡Œ</span></div></pre></td></tr></table></figure>\n<h1 id=\"è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå¯é€‰ï¼Œæ ¹æ®æœåŠ¡å™¨çš„å®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ï¼‰\"><a href=\"#è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå¯é€‰ï¼Œæ ¹æ®æœåŠ¡å™¨çš„å®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ï¼‰\" class=\"headerlink\" title=\"è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå¯é€‰ï¼Œæ ¹æ®æœåŠ¡å™¨çš„å®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ï¼‰\"></a>è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå¯é€‰ï¼Œæ ¹æ®æœåŠ¡å™¨çš„å®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ï¼‰</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">/proc/sys/vm/overcommit_memory</div><div class=\"line\">å¯é€‰å€¼ï¼š<span class=\"number\">0</span>ã€<span class=\"number\">1</span>ã€<span class=\"number\">2</span>ã€‚</div><div class=\"line\"><span class=\"number\">0</span>ï¼Œ è¡¨ç¤ºå†…æ ¸å°†æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ä¾›åº”ç”¨è¿›ç¨‹ä½¿ç”¨ï¼›å¦‚æœæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ï¼Œå†…å­˜ç”³è¯·å…è®¸ï¼›</div><div class=\"line\">    å¦åˆ™ï¼Œå†…å­˜ç”³è¯·å¤±è´¥ï¼Œå¹¶æŠŠé”™è¯¯è¿”å›ç»™åº”ç”¨è¿›ç¨‹ã€‚</div><div class=\"line\"><span class=\"number\">1</span>ï¼Œ è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼Œè€Œä¸ç®¡å½“å‰çš„å†…å­˜çŠ¶æ€å¦‚ä½•ã€‚</div><div class=\"line\"><span class=\"number\">2</span>ï¼Œ è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…è¶…è¿‡æ‰€æœ‰ç‰©ç†å†…å­˜å’Œäº¤æ¢ç©ºé—´æ€»å’Œçš„å†…å­˜</div></pre></td></tr></table></figure>\n<h1 id=\"å¼€å¯redisç«¯å£ï¼Œä¿®æ”¹é˜²ç«å¢™é…ç½®æ–‡ä»¶\"><a href=\"#å¼€å¯redisç«¯å£ï¼Œä¿®æ”¹é˜²ç«å¢™é…ç½®æ–‡ä»¶\" class=\"headerlink\" title=\"å¼€å¯redisç«¯å£ï¼Œä¿®æ”¹é˜²ç«å¢™é…ç½®æ–‡ä»¶\"></a>å¼€å¯redisç«¯å£ï¼Œä¿®æ”¹é˜²ç«å¢™é…ç½®æ–‡ä»¶</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">    vi /etc/sysconfig/iptables </div><div class=\"line\">åŠ å…¥ç«¯å£é…ç½®</div><div class=\"line\"><span class=\"bullet\">    -</span>A RH-Firewall<span class=\"bullet\">-1</span>-INPUT -m state --state NEW -m tcp -p tcp --dport <span class=\"number\">6379</span> -j ACCEPT </div><div class=\"line\">é‡æ–°åŠ è½½è§„åˆ™</div><div class=\"line\">    service iptables restart</div></pre></td></tr></table></figure>\n<h1 id=\"é…ç½®redis-configæ–‡ä»¶\"><a href=\"#é…ç½®redis-configæ–‡ä»¶\" class=\"headerlink\" title=\"é…ç½®redis.configæ–‡ä»¶\"></a>é…ç½®redis.configæ–‡ä»¶</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>ã€ä¸»èŠ‚ç‚¹masterçš„é…ç½®æ–‡ä»¶redis_master_6301.configï¼š</div><div class=\"line\"><span class=\"comment\"># Redis configuration file example</span></div><div class=\"line\"><span class=\"comment\">################################## INCLUDES ###################################</span></div><div class=\"line\"><span class=\"comment\"># include /path/to/local.conf</span></div><div class=\"line\"><span class=\"comment\"># include /path/to/other.conf</span></div><div class=\"line\"><span class=\"comment\">################################ GENERAL  #####################################</span></div><div class=\"line\">daemonize <span class=\"literal\">yes</span></div><div class=\"line\">pidfile ./run/redis_slaver1_6315.pid</div><div class=\"line\">port <span class=\"number\">6301</span></div><div class=\"line\">tcp-backlog <span class=\"number\">511</span></div><div class=\"line\"><span class=\"comment\"># bind 192.168.1.100 10.0.0.1</span></div><div class=\"line\"><span class=\"comment\"># bind 127.0.0.1</span></div><div class=\"line\"><span class=\"comment\"># unixsocket /tmp/redis.sock</span></div><div class=\"line\"><span class=\"comment\"># unixsocketperm 700</span></div><div class=\"line\">timeout <span class=\"number\">0</span></div><div class=\"line\">tcp-keepalive <span class=\"number\">0</span></div><div class=\"line\">loglevel notice</div><div class=\"line\">logfile <span class=\"string\">\"./run/logs/log_master_6301.log\"</span></div><div class=\"line\">databases <span class=\"number\">16</span></div><div class=\"line\"><span class=\"comment\">################################ SNAPSHOTTING  ################################</span></div><div class=\"line\">save <span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\"># save 900 1</span></div><div class=\"line\"><span class=\"comment\"># save 300 10</span></div><div class=\"line\"><span class=\"comment\"># save 60 10000</span></div><div class=\"line\">stop-writes-on-bgsave-error <span class=\"literal\">yes</span></div><div class=\"line\">rdbcompression <span class=\"literal\">yes</span></div><div class=\"line\">rdbchecksum <span class=\"literal\">no</span></div><div class=\"line\">dbfilename dump_6301.rdb</div><div class=\"line\">dir ./run/data</div><div class=\"line\"><span class=\"comment\">################################# REPLICATION #################################</span></div><div class=\"line\">slave-serve-stale-data <span class=\"literal\">yes</span></div><div class=\"line\">slave-read-only <span class=\"literal\">yes</span></div><div class=\"line\">repl-diskless-sync <span class=\"literal\">no</span></div><div class=\"line\">repl-diskless-sync-delay <span class=\"number\">5</span></div><div class=\"line\"><span class=\"comment\"># repl-ping-slave-period 10</span></div><div class=\"line\"><span class=\"comment\"># repl-timeout 60</span></div><div class=\"line\">repl-disable-tcp-nodelay <span class=\"literal\">no</span></div><div class=\"line\"><span class=\"comment\"># repl-backlog-size 1mb</span></div><div class=\"line\"><span class=\"comment\"># repl-backlog-ttl 3600</span></div><div class=\"line\">slave-priority <span class=\"number\">100</span></div><div class=\"line\"><span class=\"comment\"># min-slaves-to-write 3</span></div><div class=\"line\"><span class=\"comment\"># min-slaves-max-lag 10</span></div><div class=\"line\"><span class=\"comment\">################################## SECURITY ###################################</span></div><div class=\"line\"><span class=\"comment\"># rename-command CONFIG \"\"</span></div><div class=\"line\"><span class=\"comment\">################################### LIMITS ####################################</span></div><div class=\"line\"><span class=\"comment\"># maxclients 10000</span></div><div class=\"line\"><span class=\"comment\"># maxmemory &lt;bytes&gt;</span></div><div class=\"line\"><span class=\"comment\"># maxmemory-policy noeviction</span></div><div class=\"line\"><span class=\"comment\"># maxmemory-samples 5</span></div><div class=\"line\"><span class=\"comment\">############################## APPEND ONLY MODE ###############################</span></div><div class=\"line\">appendonly <span class=\"literal\">no</span></div><div class=\"line\">appendfilename <span class=\"string\">\"appendonly_6301.aof\"</span></div><div class=\"line\">appendfsync <span class=\"literal\">no</span></div><div class=\"line\"><span class=\"literal\">no</span>-appendfsync-on-rewrite <span class=\"literal\">no</span></div><div class=\"line\">auto-aof-rewrite-percentage <span class=\"number\">100</span></div><div class=\"line\">auto-aof-rewrite-min-size <span class=\"number\">64</span>mb</div><div class=\"line\">aof-load-truncated <span class=\"literal\">yes</span></div><div class=\"line\"><span class=\"comment\">################################ LUA SCRIPTING  ###############################</span></div><div class=\"line\">lua-time-limit <span class=\"number\">5000</span></div><div class=\"line\"><span class=\"comment\">################################ REDIS CLUSTER  ###############################</span></div><div class=\"line\"><span class=\"comment\"># cluster-enabled yes</span></div><div class=\"line\"><span class=\"comment\"># cluster-config-file nodes-6379.conf</span></div><div class=\"line\"><span class=\"comment\"># cluster-node-timeout 15000</span></div><div class=\"line\"><span class=\"comment\"># cluster-slave-validity-factor 10</span></div><div class=\"line\"><span class=\"comment\"># cluster-migration-barrier 1</span></div><div class=\"line\"><span class=\"comment\"># cluster-require-full-coverage yes</span></div><div class=\"line\"><span class=\"comment\">################################## SLOW LOG ###################################</span></div><div class=\"line\">slowlog-log-slower-than <span class=\"number\">10000</span></div><div class=\"line\">slowlog-max-len <span class=\"number\">128</span></div><div class=\"line\"><span class=\"comment\">################################ LATENCY MONITOR ##############################</span></div><div class=\"line\">latency-monitor-threshold <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\">############################# EVENT NOTIFICATION ##############################</span></div><div class=\"line\">notify-keyspace-events <span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">############################### ADVANCED CONFIG ###############################</span></div><div class=\"line\">hash-max-ziplist-entries <span class=\"number\">512</span></div><div class=\"line\">hash-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">list-max-ziplist-entries <span class=\"number\">512</span></div><div class=\"line\">list-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">set-max-intset-entries <span class=\"number\">512</span></div><div class=\"line\">zset-max-ziplist-entries <span class=\"number\">128</span></div><div class=\"line\">zset-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">hll-sparse-max-bytes <span class=\"number\">3000</span></div><div class=\"line\">activerehashing <span class=\"literal\">yes</span></div><div class=\"line\">client-output-buffer-limit normal <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span></div><div class=\"line\">client-output-buffer-limit slave <span class=\"number\">256</span>mb <span class=\"number\">64</span>mb <span class=\"number\">60</span></div><div class=\"line\">client-output-buffer-limit pubsub <span class=\"number\">32</span>mb <span class=\"number\">8</span>mb <span class=\"number\">60</span></div><div class=\"line\">hz <span class=\"number\">10</span></div><div class=\"line\">aof-rewrite-incremental-fsync <span class=\"literal\">yes</span></div><div class=\"line\"><span class=\"number\">2</span>ã€ä»èŠ‚ç‚¹slave1çš„é…ç½®æ–‡ä»¶redis_slave_6315.configï¼š</div><div class=\"line\"><span class=\"comment\"># Redis configuration file example</span></div><div class=\"line\"><span class=\"comment\">################################## INCLUDES ###################################</span></div><div class=\"line\"><span class=\"comment\"># include /path/to/local.conf</span></div><div class=\"line\"><span class=\"comment\"># include /path/to/other.conf</span></div><div class=\"line\"><span class=\"comment\">################################ GENERAL  #####################################</span></div><div class=\"line\">daemonize <span class=\"literal\">yes</span></div><div class=\"line\">pidfile ./run/redis_slaver1_6315.pid</div><div class=\"line\">port <span class=\"number\">6315</span></div><div class=\"line\">tcp-backlog <span class=\"number\">511</span></div><div class=\"line\"><span class=\"comment\"># bind 192.168.1.100 10.0.0.1</span></div><div class=\"line\"><span class=\"comment\"># bind 127.0.0.1</span></div><div class=\"line\"><span class=\"comment\"># unixsocket /tmp/redis.sock</span></div><div class=\"line\"><span class=\"comment\"># unixsocketperm 700</span></div><div class=\"line\">timeout <span class=\"number\">0</span></div><div class=\"line\">tcp-keepalive <span class=\"number\">0</span></div><div class=\"line\">loglevel notice</div><div class=\"line\">logfile <span class=\"string\">\"./run/logs/log_slaver1_6315.log\"</span></div><div class=\"line\">databases <span class=\"number\">16</span></div><div class=\"line\"><span class=\"comment\">################################ SNAPSHOTTING  ################################</span></div><div class=\"line\">save <span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\"># save 900 1</span></div><div class=\"line\"><span class=\"comment\"># save 300 10</span></div><div class=\"line\"><span class=\"comment\"># save 60 10000</span></div><div class=\"line\">stop-writes-on-bgsave-error <span class=\"literal\">yes</span></div><div class=\"line\">rdbcompression <span class=\"literal\">yes</span></div><div class=\"line\">rdbchecksum <span class=\"literal\">no</span></div><div class=\"line\">dbfilename dump_6315.rdb</div><div class=\"line\">dir ./run/data</div><div class=\"line\"><span class=\"comment\">################################# REPLICATION #################################</span></div><div class=\"line\">slaveof <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.12</span> <span class=\"number\">6301</span></div><div class=\"line\">slave-serve-stale-data <span class=\"literal\">yes</span></div><div class=\"line\">slave-read-only <span class=\"literal\">yes</span></div><div class=\"line\">repl-diskless-sync <span class=\"literal\">no</span></div><div class=\"line\">repl-diskless-sync-delay <span class=\"number\">5</span></div><div class=\"line\"><span class=\"comment\"># repl-ping-slave-period 10</span></div><div class=\"line\"><span class=\"comment\"># repl-timeout 60</span></div><div class=\"line\">repl-disable-tcp-nodelay <span class=\"literal\">no</span></div><div class=\"line\"><span class=\"comment\"># repl-backlog-size 1mb</span></div><div class=\"line\"><span class=\"comment\"># repl-backlog-ttl 3600</span></div><div class=\"line\">slave-priority <span class=\"number\">80</span></div><div class=\"line\"><span class=\"comment\"># min-slaves-to-write 3</span></div><div class=\"line\"><span class=\"comment\"># min-slaves-max-lag 10</span></div><div class=\"line\"><span class=\"comment\">################################## SECURITY ###################################</span></div><div class=\"line\"><span class=\"comment\"># rename-command CONFIG \"\"</span></div><div class=\"line\"><span class=\"comment\">################################### LIMITS ####################################</span></div><div class=\"line\"><span class=\"comment\"># maxclients 10000</span></div><div class=\"line\"><span class=\"comment\"># maxmemory &lt;bytes&gt;</span></div><div class=\"line\"><span class=\"comment\"># maxmemory-policy noeviction</span></div><div class=\"line\"><span class=\"comment\"># maxmemory-samples 5</span></div><div class=\"line\"><span class=\"comment\">############################## APPEND ONLY MODE ###############################</span></div><div class=\"line\">appendonly <span class=\"literal\">no</span></div><div class=\"line\">appendfilename <span class=\"string\">\"appendonly_6315.aof\"</span></div><div class=\"line\">appendfsync <span class=\"literal\">no</span></div><div class=\"line\"><span class=\"literal\">no</span>-appendfsync-on-rewrite <span class=\"literal\">no</span></div><div class=\"line\">auto-aof-rewrite-percentage <span class=\"number\">100</span></div><div class=\"line\">auto-aof-rewrite-min-size <span class=\"number\">64</span>mb</div><div class=\"line\">aof-load-truncated <span class=\"literal\">yes</span></div><div class=\"line\"><span class=\"comment\">################################ LUA SCRIPTING  ###############################</span></div><div class=\"line\">lua-time-limit <span class=\"number\">5000</span></div><div class=\"line\"><span class=\"comment\">################################ REDIS CLUSTER  ###############################</span></div><div class=\"line\"><span class=\"comment\"># cluster-enabled yes</span></div><div class=\"line\"><span class=\"comment\"># cluster-config-file nodes-6379.conf</span></div><div class=\"line\"><span class=\"comment\"># cluster-node-timeout 15000</span></div><div class=\"line\"><span class=\"comment\"># cluster-slave-validity-factor 10</span></div><div class=\"line\"><span class=\"comment\"># cluster-migration-barrier 1</span></div><div class=\"line\"><span class=\"comment\"># cluster-require-full-coverage yes</span></div><div class=\"line\"><span class=\"comment\">################################## SLOW LOG ###################################</span></div><div class=\"line\">slowlog-log-slower-than <span class=\"number\">10000</span></div><div class=\"line\">slowlog-max-len <span class=\"number\">128</span></div><div class=\"line\"><span class=\"comment\">################################ LATENCY MONITOR ##############################</span></div><div class=\"line\">latency-monitor-threshold <span class=\"number\">0</span></div><div class=\"line\"><span class=\"comment\">############################# EVENT NOTIFICATION ##############################</span></div><div class=\"line\">notify-keyspace-events <span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">############################### ADVANCED CONFIG ###############################</span></div><div class=\"line\">hash-max-ziplist-entries <span class=\"number\">512</span></div><div class=\"line\">hash-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">list-max-ziplist-entries <span class=\"number\">512</span></div><div class=\"line\">list-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">set-max-intset-entries <span class=\"number\">512</span></div><div class=\"line\">zset-max-ziplist-entries <span class=\"number\">128</span></div><div class=\"line\">zset-max-ziplist-value <span class=\"number\">64</span></div><div class=\"line\">hll-sparse-max-bytes <span class=\"number\">3000</span></div><div class=\"line\">activerehashing <span class=\"literal\">yes</span></div><div class=\"line\">client-output-buffer-limit normal <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span></div><div class=\"line\">client-output-buffer-limit slave <span class=\"number\">256</span>mb <span class=\"number\">64</span>mb <span class=\"number\">60</span></div><div class=\"line\">client-output-buffer-limit pubsub <span class=\"number\">32</span>mb <span class=\"number\">8</span>mb <span class=\"number\">60</span></div><div class=\"line\">hz <span class=\"number\">10</span></div><div class=\"line\">aof-rewrite-incremental-fsync <span class=\"literal\">yes</span></div><div class=\"line\"><span class=\"number\">3</span>ã€ä»èŠ‚ç‚¹slave2çš„é…ç½®æ–‡ä»¶redis_slave_6316.configï¼š</div><div class=\"line\">ä¸ä¸Šé¢slave1é…ç½®æ–‡ä»¶éœ€è¦ä¿®æ”¹çš„åœ°æ–¹</div><div class=\"line\">pidfile ./run/redis_slaver1_6316.pid</div><div class=\"line\">port <span class=\"number\">6316</span></div><div class=\"line\">logfile <span class=\"string\">\"./run/logs/log_slaver1_6316.log\"</span></div><div class=\"line\">dbfilename dump_6316.rdb</div><div class=\"line\">appendfilename <span class=\"string\">\"appendonly_6316.aof\"</span></div><div class=\"line\"><span class=\"number\">4</span>ã€ä»èŠ‚ç‚¹slave3çš„é…ç½®æ–‡ä»¶redis_slave_6317.configï¼š</div><div class=\"line\">ä¸ä¸Šé¢slave1é…ç½®æ–‡ä»¶éœ€è¦ä¿®æ”¹çš„åœ°æ–¹</div><div class=\"line\">pidfile ./run/redis_slaver1_6317.pid</div><div class=\"line\">port <span class=\"number\">6317</span></div><div class=\"line\">logfile <span class=\"string\">\"./run/logs/log_slaver1_6317.log\"</span></div><div class=\"line\">dbfilename dump_6317.rdb</div><div class=\"line\">appendfilename <span class=\"string\">\"appendonly_6317.aof\"</span></div><div class=\"line\"><span class=\"number\">5</span>ã€å“¨å…µsentinel1çš„é…ç½®æ–‡ä»¶sentinel_26301.config:</div><div class=\"line\"><span class=\"comment\"># Example sentinel.conf</span></div><div class=\"line\">port <span class=\"number\">26301</span></div><div class=\"line\"><span class=\"comment\"># sentinel announce-ip 1.2.3.4</span></div><div class=\"line\">dir ./run/tmp</div><div class=\"line\">sentinel monitor master1 <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.12</span> <span class=\"number\">6301</span> <span class=\"number\">2</span></div><div class=\"line\"><span class=\"comment\"># sentinel auth-pass mymaster MySUPER--secret-0123passw0rd</span></div><div class=\"line\"><span class=\"comment\"># sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span></div><div class=\"line\">sentinel down-after-milliseconds master1 <span class=\"number\">30000</span></div><div class=\"line\">sentinel parallel-syncs master1 <span class=\"number\">1</span></div><div class=\"line\">sentinel failover-timeout master1 <span class=\"number\">180000</span></div><div class=\"line\"><span class=\"comment\"># sentinel notification-script mymaster /var/redis/notify.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel can-failover master1 yes</span></div><div class=\"line\">logfile <span class=\"string\">\"/redis-3.0.0/run/logs/sentinellog_m1_26301.log\"</span></div><div class=\"line\"><span class=\"number\">6</span>ã€å“¨å…µsentinel2çš„é…ç½®æ–‡ä»¶sentinel_26302.config:</div><div class=\"line\"><span class=\"comment\"># Example sentinel.conf</span></div><div class=\"line\">port <span class=\"number\">26302</span></div><div class=\"line\"><span class=\"comment\"># sentinel announce-ip 1.2.3.4</span></div><div class=\"line\">dir ./run/tmp</div><div class=\"line\">sentinel monitor master1 <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.12</span> <span class=\"number\">6301</span> <span class=\"number\">2</span></div><div class=\"line\"><span class=\"comment\"># sentinel auth-pass mymaster MySUPER--secret-0123passw0rd</span></div><div class=\"line\"><span class=\"comment\"># sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span></div><div class=\"line\">sentinel down-after-milliseconds master1 <span class=\"number\">30000</span></div><div class=\"line\">sentinel parallel-syncs master1 <span class=\"number\">1</span></div><div class=\"line\">sentinel failover-timeout master1 <span class=\"number\">180000</span></div><div class=\"line\"><span class=\"comment\"># sentinel notification-script mymaster /var/redis/notify.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel can-failover master1 yes</span></div><div class=\"line\">logfile <span class=\"string\">\"/redis-3.0.0/run/logs/sentinellog_m1_26302.log\"</span></div><div class=\"line\"><span class=\"number\">7</span>ã€å“¨å…µsentinel3çš„é…ç½®æ–‡ä»¶sentinel_26303.config:</div><div class=\"line\"><span class=\"comment\"># Example sentinel.conf</span></div><div class=\"line\">port <span class=\"number\">26303</span></div><div class=\"line\"><span class=\"comment\"># sentinel announce-ip 1.2.3.4</span></div><div class=\"line\">dir ./run/tmp</div><div class=\"line\">sentinel monitor master1 <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.12</span> <span class=\"number\">6301</span> <span class=\"number\">2</span></div><div class=\"line\"><span class=\"comment\"># sentinel auth-pass mymaster MySUPER--secret-0123passw0rd</span></div><div class=\"line\"><span class=\"comment\"># sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span></div><div class=\"line\">sentinel down-after-milliseconds master1 <span class=\"number\">30000</span></div><div class=\"line\">sentinel parallel-syncs master1 <span class=\"number\">1</span></div><div class=\"line\">sentinel failover-timeout master1 <span class=\"number\">180000</span></div><div class=\"line\"><span class=\"comment\"># sentinel notification-script mymaster /var/redis/notify.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</span></div><div class=\"line\"><span class=\"comment\"># sentinel can-failover master1 yes</span></div><div class=\"line\">logfile <span class=\"string\">\"/redis-3.0.0/run/logs/sentinellog_m1_26303.log\"</span></div><div class=\"line\">````    </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># å¯åŠ¨rediså’Œå“¨å…µæœåŠ¡</span></div><div class=\"line\">```yaml</div><div class=\"line\">æ³¨æ„ï¼šç¬¬ä¸€æ¬¡è¦å…ˆå¯åŠ¨redisä¸»æœåŠ¡ã€ä»æœåŠ¡ï¼Œç„¶åæ‰èƒ½å¯åŠ¨å“¨å…µæœåŠ¡</div><div class=\"line\"><span class=\"number\">1</span>ã€è¿›å…¥rediså®‰è£…ç›®å½•çš„æ ¹ç›®å½•</div><div class=\"line\"><span class=\"number\">2</span>ã€å¯åŠ¨redisä¸»èŠ‚ç‚¹</div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-server redis_master_6301.config &amp;</span></div><div class=\"line\"><span class=\"number\">3</span>ã€å¯åŠ¨redisä»èŠ‚ç‚¹</div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-server redis_slave_6315.config &amp;</span></div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-server redis_slave_6316.config &amp;</span></div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-server redis_slave_6317.config &amp;</span></div><div class=\"line\"><span class=\"number\">4</span>ã€å¯åŠ¨å“¨å…µ</div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-sentinel sentinel_26301.config &amp;</span></div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-sentinel sentinel_26302.config &amp;</span></div><div class=\"line\">[root@localhost redis<span class=\"bullet\">-3.0</span><span class=\"number\">.0</span>]<span class=\"comment\"># redis-sentinel sentinel_26303.config &amp;</span></div><div class=\"line\"></div><div class=\"line\">åˆ°ç›®å‰ä¸ºæ­¢æ•´ä¸ªredis+sentinelçš„å®‰è£…æ­å»ºç¯å¢ƒå°±ç®—å®Œæˆ</div><div class=\"line\">`</div></pre></td></tr></table></figure>\n<h1 id=\"å¸¸ç”¨å‘½å\"><a href=\"#å¸¸ç”¨å‘½å\" class=\"headerlink\" title=\"å¸¸ç”¨å‘½å\"></a>å¸¸ç”¨å‘½å</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">è¿›å…¥redisçš„å®‰è£…ç›®å½•</div><div class=\"line\">å¯åŠ¨redis-serverï¼š</div><div class=\"line\">./redis-server redis_6305.conf &amp;</div><div class=\"line\">å¯åŠ¨redis-sentinel </div><div class=\"line\">./redis-sentinel sentinel_6301.config</div><div class=\"line\">./redis-server sentinel_6316.conf --sentinel &amp;</div><div class=\"line\">æŸ¥çœ‹æŸä¸ªç«¯å£ä¿¡æ¯ï¼š</div><div class=\"line\">./redis-cli -p <span class=\"number\">6301</span> info</div><div class=\"line\">./redis-cli -p <span class=\"number\">6301</span> info Replication</div><div class=\"line\">./redis-cli -p <span class=\"number\">6301</span> info Sentinel</div><div class=\"line\">æŸ¥çœ‹æŸä¸ªä¸»æœºä¸Šçš„ä¿¡æ¯redisä¿¡æ¯</div><div class=\"line\">./redis-cli -h <span class=\"number\">10.16</span><span class=\"number\">.41</span><span class=\"number\">.52</span> -p <span class=\"number\">6316</span> info</div><div class=\"line\">./redis-cli -h <span class=\"number\">10.16</span><span class=\"number\">.41</span><span class=\"number\">.52</span> -p <span class=\"number\">6316</span> info Replication</div><div class=\"line\">./redis-cli -h <span class=\"number\">10.16</span><span class=\"number\">.41</span><span class=\"number\">.52</span> -p <span class=\"number\">6316</span> info Sentinel</div><div class=\"line\">å…³é—­æœ¬æœºredisæœåŠ¡</div><div class=\"line\">./redis-cli -p <span class=\"number\">6379</span> shutdown</div><div class=\"line\">å…³é—­è¿œç¨‹ä¸»æœºredisæœåŠ¡</div><div class=\"line\">./redis-cli -h <span class=\"number\">192.168</span><span class=\"number\">.9</span><span class=\"number\">.18</span> -p <span class=\"number\">6379</span> shutdown</div><div class=\"line\">å®¢æˆ·ç«¯è¿æ¥æœ¬æœº</div><div class=\"line\">./redis-cli -p <span class=\"number\">6301</span></div><div class=\"line\">å®¢æˆ·ç«¯è¿æ¥è¿œç¨‹æœº</div><div class=\"line\">./redis-cli -h <span class=\"number\">10.16</span><span class=\"number\">.41</span><span class=\"number\">.53</span> -p <span class=\"number\">6301</span></div><div class=\"line\">åˆ‡æ¢è¿æ¥</div><div class=\"line\">ssh app@<span class=\"number\">10.16</span><span class=\"number\">.41</span><span class=\"number\">.52</span></div><div class=\"line\"></div><div class=\"line\">ä½¿ç”¨å‘½ä»¤å…³é—­RDBæŒä¹…åŒ–</div><div class=\"line\">`</div></pre></td></tr></table></figure>\n"},{"title":"logback æ—¥å¿—é…ç½®","url":"https://yangzhiw.github.io/2016/07/21/logback/","content":"<h1 id=\"å†™å…¥æ–‡ä»¶é…ç½®\"><a href=\"#å†™å…¥æ–‡ä»¶é…ç½®\" class=\"headerlink\" title=\"å†™å…¥æ–‡ä»¶é…ç½®\"></a>å†™å…¥æ–‡ä»¶é…ç½®</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;appender name=<span class=\"string\">\"FILE\"</span> class=<span class=\"string\">\"ch.qos.logback.core.rolling.RollingFileAppender\"</span><span class=\"string\">&gt;</span></div><div class=\"line\">    &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;</div><div class=\"line\">        &lt;fileNamePattern&gt;logFile.%d&#123;yyyy-MM-dd&#125;.log&lt;/fileNamePattern&gt;</div><div class=\"line\">        &lt;maxHistory&gt;90&lt;/maxHistory&gt;</div><div class=\"line\">    &lt;/rollingPolicy&gt;</div><div class=\"line\">    &lt;encoder&gt;</div><div class=\"line\">        &lt;charset&gt;utf-8&lt;/charset&gt;</div><div class=\"line\">        &lt;Pattern&gt;%d %-5level [%thread] %logger&#123;0&#125;: %msg%n&lt;/Pattern&gt;</div><div class=\"line\">    &lt;/encoder&gt;</div><div class=\"line\">&lt;/appender&gt;</div></pre></td></tr></table></figure>\n<h1 id=\"å†™å…¥mysqlæ•°æ®åº“é…ç½®\"><a href=\"#å†™å…¥mysqlæ•°æ®åº“é…ç½®\" class=\"headerlink\" title=\"å†™å…¥mysqlæ•°æ®åº“é…ç½®\"></a>å†™å…¥mysqlæ•°æ®åº“é…ç½®</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;appender name=<span class=\"string\">\"DB\"</span> class=<span class=\"string\">\"ch.qos.logback.classic.db.DBAppender\"</span><span class=\"string\">&gt;</span></div><div class=\"line\">     &lt;!--æ—¥å¿—å¼‚æ­¥åˆ°æ•°æ®åº“ --&gt;</div><div class=\"line\">     &lt;connectionSource class=\"ch.qos.logback.core.db.DataSourceConnectionSource\"&gt;</div><div class=\"line\">         &lt;!--è¿æ¥æ±  --&gt;</div><div class=\"line\">         &lt;dataSource class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;</div><div class=\"line\">             &lt;driverClassName&gt;com.mysql.jdbc.Driver&lt;/driverClassName&gt;</div><div class=\"line\">             &lt;url&gt;jdbc:mysql://localhost:3306/DB&lt;/url&gt;</div><div class=\"line\">             &lt;username &gt;root&lt;/username&gt;</div><div class=\"line\">             &lt;password&gt;root&lt;/password&gt;</div><div class=\"line\">         &lt;/dataSource&gt;</div><div class=\"line\">     &lt;/connectionSource&gt;</div><div class=\"line\"> &lt;/appender&gt;</div></pre></td></tr></table></figure>\n<h1 id=\"å†™å…¥æ§åˆ¶å°é…ç½®\"><a href=\"#å†™å…¥æ§åˆ¶å°é…ç½®\" class=\"headerlink\" title=\"å†™å…¥æ§åˆ¶å°é…ç½®\"></a>å†™å…¥æ§åˆ¶å°é…ç½®</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;appender name=<span class=\"string\">\"STDOUT\"</span> class=<span class=\"string\">\"ch.qos.logback.core.ConsoleAppender\"</span><span class=\"string\">&gt;</span></div><div class=\"line\">     &lt;!-- æ—¥å¿—è¾“å‡ºç¼–ç  --&gt;  </div><div class=\"line\">     &lt;Encoding&gt;UTF-8&lt;/Encoding&gt;   </div><div class=\"line\">      &lt;layout class=\"ch.qos.logback.classic.PatternLayout\"&gt;   </div><div class=\"line\">           &lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦--&gt; </div><div class=\"line\">          &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n   </div><div class=\"line\">          &lt;/pattern&gt;   </div><div class=\"line\">      &lt;/layout&gt;   </div><div class=\"line\"> &lt;/appender&gt;</div></pre></td></tr></table></figure>\n<h1 id=\"å¼‚æ­¥å†™å…¥\"><a href=\"#å¼‚æ­¥å†™å…¥\" class=\"headerlink\" title=\"å¼‚æ­¥å†™å…¥\"></a>å¼‚æ­¥å†™å…¥</h1><pre><code class=\"yaml\">&lt;appender name=<span class=\"string\">\"ASYNC\"</span> class=<span class=\"string\">\"ch.qos.logback.classic.AsyncAppender\"</span><span class=\"string\">&gt;\n      &lt;queueSize&gt;512&lt;/queueSize&gt;\n      &lt;appender-ref ref=\"FILE\"/&gt;\n&lt;/appender&gt;</span>\n</code></pre>\n"},{"title":"Hello World","url":"https://yangzhiw.github.io/2016/07/21/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n"},{"title":"","url":"https://yangzhiw.github.io/about/index.html","content":"<h1 id=\"åšå®¢ä»‹ç»\"><a href=\"#åšå®¢ä»‹ç»\" class=\"headerlink\" title=\"åšå®¢ä»‹ç»\"></a>åšå®¢ä»‹ç»</h1><blockquote>\n<p>åšå®¢å¤§éƒ¨åˆ†éƒ½æ˜¯æ¥è‡ªå¯¹å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å’Œå­¦ä¹ æ–°æŠ€æœ¯çš„ä¸€äº›ç¬”è®°</p>\n</blockquote>\n<h1 id=\"æœ¬äººä»‹ç»\"><a href=\"#æœ¬äººä»‹ç»\" class=\"headerlink\" title=\"æœ¬äººä»‹ç»\"></a>æœ¬äººä»‹ç»</h1><blockquote>\n<p>æœ¬äººç°å·¥ä½œäºæµ™æ±Ÿæ­å·</p>\n</blockquote>\n"},{"title":"search","url":"https://yangzhiw.github.io/search/index.html","content":""}]